<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MULTAs v2.1 - ÂåªÂ≠¶ÂÆüÁøí„É¨„Éù„Éº„ÉàËá™ÂãïÁîüÊàê„Ç∑„Çπ„ÉÜ„É†ÔºàAIÂàÜÈ°ûÂØæÂøúÔºâ</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <!-- PDFÁîüÊàêÁî®„É©„Ç§„Éñ„É©„É™ -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        /* === „Éô„Éº„Çπ„Çπ„Çø„Ç§„É´ === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Hiragino Sans', 'Yu Gothic UI', sans-serif;
            background: linear-gradient(135deg, #81c784 0%, #b39ddb 100%);
            height: 100vh;
            color: #333;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            position: fixed;
            width: 100%;
            top: 0;
            left: 0;
        }

        /* === „Éò„ÉÉ„ÉÄ„Éº === */
        .header {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            padding: 15px 20px;
            text-align: center;
            color: white;
            flex-shrink: 0;
            position: relative;
        }

        .header h1 {
            font-size: 1.8rem;
            margin-bottom: 5px;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 0.85rem;
            opacity: 0.9;
        }

        /* === Êó•‰ªòÈÅ∏Êäû === */
        .day-selector {
            position: absolute;
            top: 15px;
            right: 20px;
        }

        .day-display {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 8px 16px;
            background: #7e57c2;
            color: white;
            font-size: 0.9rem;
            font-weight: 600;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(126, 87, 194, 0.3);
        }

        .day-display:hover {
            background: #673ab7;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(126, 87, 194, 0.4);
        }

        .day-dropdown {
            position: absolute;
            top: 100%;
            right: 0;
            margin-top: 5px;
            background: rgba(0, 0, 0, 0.85);
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            z-index: 1000;
            overflow: hidden;
            display: none;
            white-space: nowrap;
        }

        .day-dropdown.active {
            display: flex;
            flex-direction: row;
            gap: 2px;
            padding: 8px;
        }

        .day-option {
            padding: 6px 12px;
            cursor: pointer;
            transition: all 0.2s ease;
            font-weight: 500;
            font-size: 0.85rem;
            color: white;
            border-radius: 4px;
        }

        .day-option:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        .day-option.selected {
            background: #7e57c2;
            color: white;
        }

        /* === „É¢„Éã„Çø„ÉºÂàá„ÇäÊõø„Åà„Çø„Éñ === */
        .monitor-tabs {
            display: flex;
            gap: 10px;
            padding: 10px 20px;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            flex-shrink: 0;
            justify-content: center;
        }

        .monitor-tab {
            padding: 10px 24px;
            border: 2px solid #4a9eff;
            background: white;
            color: #4a9eff;
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 25px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            min-width: 140px;
            text-align: center;
        }

        .monitor-tab:hover {
            background: #e8f2ff;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(74, 158, 255, 0.2);
        }

        .monitor-tab.active {
            background: #66bb6a;
            color: white;
            border-color: #66bb6a;
            box-shadow: 0 4px 12px rgba(102, 187, 106, 0.3);
        }

        /* === „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ„Ç®„É™„Ç¢ === */
        .main-content {
            flex: 1;
            padding: 0;
            background: white;
            display: flex;
            flex-direction: column;
            min-height: 0;
            overflow: hidden;
        }

        /* === Áµ±Ë®àÂõ∫ÂÆö„Ç®„É™„Ç¢ === */
        .monitor-stats {
            background: white;
            padding: 12px 20px 8px;
            border-bottom: 1px solid #f0f0f0;
            flex-shrink: 0;
            overflow: visible;
            position: relative;
            z-index: 100;
        }

        /* === „Çπ„ÇØ„É≠„Éº„É´ÂèØËÉΩ„Ç≥„É≥„ÉÜ„É≥„ÉÑ === */
        .monitor-content {
            flex: 1;
            overflow-y: auto;
            padding: 15px 20px;
            min-height: 0;
        }

        /* === „É¢„Éã„Çø„ÉºË°®Á§∫ === */
        .monitor {
            display: none;
            height: 100%;
            flex-direction: column;
        }

        .monitor.active {
            display: flex;
        }

        .monitor h3 {
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 6px;
            margin: 0 0 15px 0;
        }

        /* === Áµ±Ë®à„Ç´„Éº„Éâ === */
        .stats-grid {
            display: flex;
            gap: 6px;
            margin-bottom: 0;
            align-items: center;
        }

        .exp-bar-container {
            flex: 1;
            height: 30px;
            background: rgba(0,0,0,0.1);
            border-radius: 15px;
            position: relative;
            overflow: hidden;
            margin-left: 10px;
        }

        .exp-bar {
            height: 100%;
            background: linear-gradient(90deg, #b39ddb 0%, #9575cd 100%);
            border-radius: 15px;
            transition: width 0.5s ease;
            box-shadow: 0 2px 4px rgba(179, 157, 219, 0.3);
        }

        .exp-text {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #333;
            font-weight: 600;
            font-size: 0.8rem;
            text-shadow: 0 0 2px rgba(255,255,255,0.8);
        }

        .stat-card {
            background: rgba(179, 157, 219, 0.08);
            border-radius: 5px;
            padding: 4px 8px;
            text-align: center;
            border: 1px solid rgba(179, 157, 219, 0.12);
            flex: 1;
            min-width: 60px;
            max-width: 80px;
        }

        .stat-number {
            font-size: 0.85rem;
            font-weight: bold;
            color: #7e57c2;
            margin-bottom: 1px;
        }

        .stat-label {
            color: #999;
            font-size: 0.65rem;
            line-height: 1.1;
        }

        /* === Ë®òÈå≤„Ç¢„Ç§„ÉÜ„É† === */
        .record-item {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 18px;
            margin-bottom: 15px;
            border-left: 5px solid #667eea;
            position: relative;
            transition: all 0.3s ease;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .record-item:hover {
            transform: translateX(3px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            border-left-color: #5a67d8;
        }

        .record-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .record-header-left {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .record-timestamp {
            color: #666;
            font-size: 0.8rem;
        }

        .record-actions {
            display: flex;
            gap: 6px;
        }

        .record-btn {
            padding: 6px 10px;
            border: 1px solid #ddd;
            background: white;
            border-radius: 6px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .record-btn:hover {
            background: #f5f5f5;
            border-color: #999;
            transform: translateY(-1px);
        }

        .edit-btn {
            color: #555;
        }

        .delete-btn {
            color: #666;
        }

        .save-btn {
            background: #4a9eff;
            color: white;
            border-color: #4a9eff;
        }

        .save-btn:hover {
            background: #357abd;
            border-color: #357abd;
        }

        .cancel-btn {
            color: #888;
        }

        .record-text {
            line-height: 1.8;
            font-size: 1.2rem;
            color: #333;
            font-weight: 500;
            word-wrap: break-word;
            letter-spacing: 0.02em;
        }

        .record-category {
            display: inline-block;
            padding: 4px 8px;
            background: #e3f2fd;
            color: #1976d2;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
            white-space: nowrap;
        }

        .record-ai-indicator {
            display: inline-block;
            margin-left: 8px;
            padding: 3px 7px;
            background: #4caf50;
            color: white;
            border-radius: 10px;
            font-size: 0.75rem;
        }

        /* === „Ç´„ÉÜ„Ç¥„É™Âà•Ë°®Á§∫ === */
        .category-section {
            margin-bottom: 20px;
            border-radius: 10px;
            overflow: hidden;
            background: #f8f9fa;
        }

        .category-header {
            padding: 12px 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-weight: 600;
            font-size: 0.95rem;
        }

        .category-content {
            padding: 15px;
        }

        .category-item {
            position: relative;
            background: white;
            border-radius: 8px;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-left: 3px solid #667eea;
        }

        .category-item .category-text {
            font-size: 1.15rem;
            line-height: 1.8;
            color: #333;
            font-weight: 500;
            word-wrap: break-word;
            letter-spacing: 0.02em;
        }

        /* Ë¶ÅÁ¥†ÂàÜÈÖçË°®Á§∫Áî®„ÅÆ„Çπ„Çø„Ç§„É´ */
        .element-display {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 12px;
        }

        .element-weight-badge {
            position: absolute;
            left: 0;
            top: 0;
            background: #667eea;
            color: white;
            padding: 4px 10px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .element-text {
            flex: 1;
            font-size: 1.15rem;
            line-height: 1.5;
            color: #333;
            font-weight: 500;
            word-wrap: break-word;
            letter-spacing: 0.02em;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        /* ÁêÜÁî±„Ç¢„Ç§„Ç≥„É≥„Å®Âêπ„ÅçÂá∫„Åó */
        .reason-icon {
            flex-shrink: 0;
            cursor: pointer;
            font-size: 1.2rem;
            opacity: 0.6;
            transition: all 0.3s ease;
            padding: 4px;
        }

        .reason-icon:hover {
            opacity: 1;
            transform: scale(1.1);
        }

        .element-reason {
            position: absolute;
            top: calc(100% + 5px);
            right: 0;
            left: auto;
            width: 90%;
            max-width: 400px;
            margin-top: 0;
            padding: 12px 30px 12px 15px;
            background: #667eea;
            color: white;
            border-radius: 8px;
            font-size: 0.95rem;
            line-height: 1.6;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            z-index: 10;
            animation: fadeIn 0.3s ease;
        }

        .element-reason::before {
            content: '';
            position: absolute;
            top: -8px;
            right: 20px;
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid #667eea;
        }

        .reason-close {
            position: absolute;
            top: 8px;
            right: 10px;
            cursor: pointer;
            font-size: 1.2rem;
            line-height: 1;
            opacity: 0.8;
            transition: opacity 0.2s;
        }

        .reason-close:hover {
            opacity: 1;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(-5px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        /* === Ë¶ÅÁ¥†ÂàÜËß£Ë°®Á§∫ === */
        .elements-breakdown {
            margin-top: 10px;
            padding: 10px;
            background: #f5f7fa;
            border-radius: 8px;
            font-size: 0.85rem;
        }
        
        .elements-title {
            font-weight: 600;
            color: #667eea;
            margin-bottom: 8px;
        }
        
        .element-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 4px 0;
            border-bottom: 1px solid #e2e8f0;
        }
        
        .element-item:last-child {
            border-bottom: none;
        }
        
        .element-category {
            background: #667eea;
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.75rem;
            white-space: nowrap;
            min-width: 120px;
        }
        
        .element-content {
            flex: 1;
            color: #4a5568;
        }
        
        .element-weight {
            color: #667eea;
            font-weight: 600;
            min-width: 40px;
            text-align: right;
        }

        /* === „É¨„Éù„Éº„ÉàË°®Á§∫ === */
        .report-content {
            background: white;
            border-radius: 10px;
            padding: 20px;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .report-section {
            margin-bottom: 20px;
        }

        .report-section h4 {
            color: #333;
            margin-bottom: 10px;
            font-size: 1.1rem;
            border-bottom: 2px solid #667eea;
            padding-bottom: 4px;
        }
        
        /* AI„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„ÅÆ„Çπ„Çø„Ç§„É´ */
        .ai-feedback {
            background: linear-gradient(135deg, #f5f7ff 0%, #fef5ff 100%);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
            font-size: 1.05rem;
            line-height: 1.8;
            color: #333;
            white-space: pre-wrap;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.1);
        }
        
        .ai-feedback p {
            margin-bottom: 1em;
        }
        
        .ai-feedback:last-child {
            margin-bottom: 0;
        }
        
        /* === „É¨„Éù„Éº„ÉàÂÜÖ„ÅÆLISTÂΩ¢Âºè„Çπ„Çø„Ç§„É´ === */
        .report-list-content {
            margin-top: 15px;
        }
        
        .report-category-section {
            margin-bottom: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .report-category-header {
            background: #667eea;
            color: white;
            padding: 10px 15px;
            font-weight: 600;
            font-size: 0.95rem;
        }
        
        .report-category-content {
            padding: 15px;
        }
        
        .report-category-item {
            background: white;
            border-radius: 6px;
            padding: 10px 15px;
            margin-bottom: 8px;
            border-left: 3px solid #667eea;
        }
        
        .report-category-item:last-child {
            margin-bottom: 0;
        }
        
        .report-element-text {
            font-size: 1rem;
            line-height: 1.6;
            color: #333;
        }
        
        /* === „É¨„Éù„Éº„Éà„Éú„ÉÉ„ÇØ„Çπ„Çπ„Çø„Ç§„É´ === */
        .report-box {
            margin-bottom: 15px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .report-box-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 20px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }
        
        .report-box-header:hover {
            background: linear-gradient(135deg, #5a67d8 0%, #6b4199 100%);
        }
        
        .report-box-title {
            font-weight: 600;
            font-size: 1.1rem;
        }
        
        .report-toggle-icon {
            font-size: 1.2rem;
            transition: transform 0.3s ease;
        }
        
        .report-box-content {
            background: white;
            max-height: 600px;
            overflow-y: auto;
            animation: slideDown 0.3s ease;
        }
        
        @keyframes slideDown {
            from {
                opacity: 0;
                max-height: 0;
            }
            to {
                opacity: 1;
                max-height: 600px;
            }
        }

        /* === Áµ±Ë®àË°®Á§∫ === */
        .stats-display {
            display: block;
        }

        .stats-display.hidden {
            display: none;
        }

        .report-actions {
            display: flex;
            gap: 8px;
            margin: 0;
        }

        .btn-secondary {
            flex: 1;
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .btn-secondary:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 8px rgba(0,0,0,0.2);
        }
        
        .report-action-area {
            padding: 10px 20px;
            text-align: center;
            border-bottom: 1px solid rgba(0, 0, 0, 0.1);
        }
        
        .report-generate-btn {
            width: 100%;
            max-width: 300px;
            margin: 0 auto;
            padding: 12px 24px;
            font-size: 16px;
            justify-content: center;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .btn-advance,
        .btn-previous {
            background: #90EE90;
            color: #2d5a2d;
        }

        .btn-advance:hover,
        .btn-previous:hover {
            background: #7dd87d;
        }


        /* === „Éú„Éà„É†ÂÖ•Âäõ„Éï„Ç©„Éº„É† === */
        .bottom-input {
            background: white;
            border-top: 1px solid #e0e0e0;
            padding: 15px 20px 20px;
            flex-shrink: 0;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.1);
            position: relative;
            z-index: 10;
        }

        .input-row {
            display: flex;
            gap: 10px;
            align-items: flex-end;
            margin-bottom: 10px;
        }

        .experience-input {
            flex: 1;
        }

        .input-row label {
            display: block;
            margin-bottom: 5px;
            font-size: 0.85rem;
            font-weight: 600;
            color: #555;
        }

        .input-row input,
        .input-row textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 0.9rem;
            font-family: inherit;
            transition: border-color 0.3s ease;
        }

        .input-row input:focus,
        .input-row textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .input-row textarea {
            resize: none;
            height: 60px;
            min-height: 60px;
            max-height: 120px;
            padding-right: 60px;
        }

        .submit-btn {
            position: absolute;
            bottom: 10px;
            right: 10px;
            width: 45px;
            height: 45px;
            background: #b39ddb;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px rgba(179, 157, 219, 0.4);
            z-index: 10;
        }

        .submit-btn svg {
            width: 24px;
            height: 24px;
            transform: rotate(-10deg);
        }

        .submit-btn:hover {
            background: #9575cd;
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(179, 157, 219, 0.6);
        }

        .submit-btn:active {
            transform: scale(0.95);
        }

        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        /* === „Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫ === */
        .status-message {
            padding: 10px;
            border-radius: 6px;
            margin-top: 10px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .status-warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
        }

        .status-info {
            background: #cce7ff;
            color: #004085;
            border: 1px solid #b8daff;
        }

        /* === „É≠„Éº„Éá„Ç£„É≥„Ç∞ === */
        .loading {
            display: inline-block;
            width: 16px;
            height: 16px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid #667eea;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* „É¨„Éô„É´„Ç´„Éº„ÉâÁâπÂà•„Çπ„Çø„Ç§„É´ */
        .stat-card.level-card {
            margin-left: 10px;
            position: relative;
        }
        
        /* „É¨„Éô„É´„Ç¢„ÉÉ„ÉóÂêπ„ÅçÂá∫„Åó */
        .level-up-bubble {
            position: fixed;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            white-space: nowrap;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            opacity: 0;
            animation: bubbleAnimation 2s ease-out forwards;
            z-index: 10000;
            pointer-events: none;
        }
        
        .level-up-bubble::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-top: 8px solid #764ba2;
        }
        
        @keyframes bubbleAnimation {
            0% {
                opacity: 0;
                transform: translateX(-50%) translateY(10px);
            }
            20% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            80% {
                opacity: 1;
                transform: translateX(-50%) translateY(0);
            }
            100% {
                opacity: 0;
                transform: translateX(-50%) translateY(-5px);
            }
        }
        
        /* „É¨„Éô„É´„Ç¢„ÉÉ„ÉóÊôÇ„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ */
        .stat-card.level-up-animation .stat-number {
            animation: levelUpNumber 2s ease-out;
        }
        
        .stat-card.level-up-animation {
            animation: levelUpCard 2s ease-out;
        }
        
        @keyframes levelUpNumber {
            0% {
                transform: scale(1);
                color: #7e57c2;
            }
            20% {
                transform: scale(1.8);
                color: #ffd700;
                text-shadow: 0 0 20px rgba(255, 215, 0, 0.8);
            }
            40% {
                transform: scale(1.6);
            }
            60% {
                transform: scale(1.7);
            }
            80% {
                transform: scale(1.5);
                color: #ffd700;
            }
            100% {
                transform: scale(1);
                color: #7e57c2;
                text-shadow: none;
            }
        }
        
        @keyframes levelUpCard {
            0% {
                background: rgba(179, 157, 219, 0.05);
            }
            20% {
                background: rgba(255, 215, 0, 0.3);
                box-shadow: 0 0 30px rgba(255, 215, 0, 0.5);
            }
            80% {
                background: rgba(255, 215, 0, 0.2);
            }
            100% {
                background: rgba(179, 157, 219, 0.05);
                box-shadow: none;
            }
        }
        
        /* EXP„Éê„ÉºËºù„Åç„Ç®„Éï„Çß„ÇØ„Éà */
        .exp-bar.glowing {
            animation: barGlow 1s ease-in-out;
        }
        
        @keyframes barGlow {
            0% {
                box-shadow: 0 0 5px rgba(179, 157, 219, 0.5);
            }
            50% {
                box-shadow: 0 0 20px rgba(179, 157, 219, 1), 
                            0 0 40px rgba(179, 157, 219, 0.8),
                            0 0 60px rgba(179, 157, 219, 0.6);
                transform: scaleY(1.1);
            }
            100% {
                box-shadow: 0 0 5px rgba(179, 157, 219, 0.5);
                transform: scaleY(1);
            }
        }
        
        /* EXP„Éê„Éº„Éá„Ç£„Çæ„É´„Éñ„Ç®„Éï„Çß„ÇØ„Éà */
        .exp-bar.dissolving {
            animation: barDissolve 0.8s ease-out forwards;
        }
        
        @keyframes barDissolve {
            0% {
                opacity: 1;
                filter: blur(0px);
                transform: scale(1);
            }
            50% {
                opacity: 0.8;
                filter: blur(2px);
                transform: scale(1.05);
            }
            100% {
                opacity: 0;
                filter: blur(10px);
                transform: scale(1.1);
            }
        }

        /* === Á∑®ÈõÜ„É¢„Éº„Éâ === */
        .edit-mode {
            background: #fff3cd;
            border: 2px solid #ffc107;
        }
        
        /* === „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà === */
        .radar-chart-container {
            width: 100%;
            max-width: 350px;
            margin: 20px auto;
            padding: 15px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: block !important;
        }
        
        #radarChart {
            max-height: 280px;
            display: block !important;
        }
        
        .radar-chart-title {
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            color: #7e57c2;
            margin-bottom: 15px;
        }
        
        .radar-legend {
            margin-top: 15px;
            padding: 10px;
            background: rgba(179, 157, 219, 0.05);
            border-radius: 10px;
            font-size: 14px;
        }
        
        .radar-legend-item {
            display: flex;
            align-items: center;
            margin: 5px 0;
        }
        
        .radar-legend-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        /* === „É≠„Ç∞„Ç§„É≥„É¢„Éº„ÉÄ„É´ === */
        .login-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
        }
        
        .login-container {
            background: white;
            padding: 40px;
            border-radius: 20px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            max-width: 400px;
            width: 90%;
        }
        
        .login-title {
            text-align: center;
            font-size: 24px;
            color: #7e57c2;
            margin-bottom: 30px;
            font-weight: bold;
        }
        
        .login-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .login-input {
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s;
        }
        
        .login-input:focus {
            outline: none;
            border-color: #b39ddb;
        }
        
        .login-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 14px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.2s;
        }
        
        .login-button:hover {
            transform: translateY(-2px);
        }
        
        .login-error {
            color: #e74c3c;
            text-align: center;
            margin-top: 10px;
            font-size: 14px;
        }
        
        .user-info {
            position: fixed;
            top: 120px;
            right: 20px;
            background: rgba(255, 255, 255, 0.95);
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 13px;
            color: #7e57c2;
            font-weight: bold;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            display: none;
            z-index: 1000;
        }

        .edit-textarea {
            width: 100%;
            min-height: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-family: inherit;
            font-size: 0.9rem;
            resize: vertical;
        }

        .edit-actions {
            margin-top: 8px;
            display: flex;
            gap: 8px;
        }

        .save-btn {
            background: #28a745;
            color: white;
        }

        .cancel-btn {
            background: #6c757d;
            color: white;
        }

        /* === Á©∫Áä∂ÊÖãË°®Á§∫ === */
        .empty-state {
            text-align: center;
            color: #666;
            padding: 40px 20px;
            line-height: 1.6;
        }

        .empty-state .icon {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
        }

        /* === „É¨„Çπ„Éù„É≥„Ç∑„ÉñË™øÊï¥ === */
        @media (max-width: 480px) {
            .header h1 {
                font-size: 1.5rem;
            }

            .header p {
                font-size: 0.8rem;
            }

            .monitor-tab {
                font-size: 0.8rem;
                padding: 10px 6px;
            }

            .monitor h3 {
                font-size: 1rem;
                margin-bottom: 12px;
            }

            .bottom-input {
                padding: 12px 15px 15px;
            }

            .input-row {
                flex-direction: column;
                gap: 5px;
            }


            .stats-grid {
                gap: 4px;
                margin-bottom: 0;
            }

            .stat-card {
                padding: 3px 6px;
                min-width: 55px;
                max-width: 70px;
            }

            .stat-number {
                font-size: 0.75rem;
                color: #7e57c2;
            }

            .stat-label {
                font-size: 0.6rem;
                color: #aaa;
            }

            .report-actions {
                gap: 6px;
            }

            .record-text {
                font-size: 1.1rem;
                line-height: 1.7;
                letter-spacing: 0.01em;
            }

            .category-item .category-text {
                font-size: 1.05rem;
                line-height: 1.7;
                letter-spacing: 0.01em;
            }

            .monitor-stats {
                padding: 8px 15px 6px;
            }

            .monitor-content {
                padding: 12px 15px;
            }

            .monitor h3 {
                font-size: 1rem;
                margin-bottom: 12px;
            }

            .btn-secondary {
                padding: 6px 10px;
                font-size: 0.8rem;
            }
        }

        /* === „Ç≠„Éº„Éú„Éº„ÉâÊìç‰ΩúÂØæÂøú === */
        .input-row textarea {
            transition: height 0.3s ease;
        }

        .input-row textarea:focus {
            height: 80px;
        }
        
        /* === „É¢„Éê„Ç§„É´Á∏¶ÁîªÈù¢ÊúÄÈÅ©Âåñ === */
        @media screen and (max-width: 480px) and (orientation: portrait) {
            body {
                padding: 0;
                margin: 0;
            }
            
            .header {
                padding: 15px;
                position: fixed;
                width: 100%;
                top: 0;
                z-index: 1000;
                box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            }
            
            .container {
                margin-top: 100px;
                padding: 10px;
                width: 100%;
                max-width: 100%;
            }
            
            .monitor {
                width: 100%;
                max-height: calc(100vh - 300px);
                overflow-y: auto;
                -webkit-overflow-scrolling: touch;
            }
            
            .input-area {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                padding: 10px;
                box-shadow: 0 -2px 10px rgba(0, 0, 0, 0.1);
                z-index: 1000;
            }
            
            .input-row textarea {
                font-size: 16px; /* iOS„ÅÆ„Ç∫„Éº„É†Èò≤Ê≠¢ */
            }
            
            .btn-primary {
                width: 100%;
                padding: 15px;
                font-size: 16px;
            }
            
            .category-element {
                padding: 8px;
                margin: 4px 0;
            }
            
            .element-content {
                font-size: 14px;
                line-height: 1.4;
            }
            
            .element-reason {
                font-size: 12px;
                max-width: 250px;
            }
            
            #radarChart {
                max-width: 100%;
                height: auto !important;
                margin: 0 auto;
            }
            
            .user-info {
                top: 10px;
                right: 10px;
                font-size: 11px;
            }
            
            .user-info button {
                display: none; /* „É¢„Éê„Ç§„É´„Åß„ÅØAPI„Ç≠„ÉºË®≠ÂÆö„Éú„Çø„É≥„ÇíÈö†„Åô */
            }
            
            /* „Çπ„ÉÜ„Éº„Çø„Çπ„É°„ÉÉ„Çª„Éº„Ç∏„Çí„É¢„Éê„Ç§„É´ÂØæÂøú */
            .status-bar {
                bottom: 160px; /* ÂÖ•Âäõ„Ç®„É™„Ç¢„ÅÆ‰∏ä„Å´ÈÖçÁΩÆ */
            }
            
            /* Êó•‰ªòÂàá„ÇäÊõø„Åà„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÅÆÊúÄÈÅ©Âåñ */
            .day-dropdown {
                width: calc(100% - 20px);
                max-width: 300px;
                right: 10px;
            }
        }
        
        /* === „Çø„ÉÉ„ÉÅ„Éá„Éê„Ç§„ÇπÊúÄÈÅ©Âåñ === */
        @supports (-webkit-touch-callout: none) {
            /* iOS SafariÂØæÂøú */
            .btn-primary, .btn-secondary, .speech-bubble {
                -webkit-tap-highlight-color: transparent;
                cursor: pointer;
            }
            
            .category-element {
                -webkit-user-select: none;
                user-select: none;
            }
        }
        
        /* === „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥„Éï„É≠„Éº„ÉÜ„Ç£„É≥„Ç∞„Éú„Çø„É≥ === */
        .shared-learning-floating-btn {
            position: fixed;
            bottom: 80px;
            right: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff6b6b 0%, #feca57 100%);
            border: none;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            cursor: pointer;
            font-size: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s, box-shadow 0.3s;
            z-index: 1000;
        }
        
        .shared-learning-floating-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.3);
        }
        
        .shared-learning-floating-btn:active {
            transform: scale(0.95);
        }
        
        .notification-badge {
            position: absolute;
            top: 5px;
            right: 5px;
            color: #ff4757;
            font-size: 12px;
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.8; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        /* „É¢„Éê„Ç§„É´ÂØæÂøú */
        @media screen and (max-width: 480px) {
            .shared-learning-floating-btn {
                bottom: 180px;
                right: 15px;
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
        }
        
        /* ÈñãÁô∫ËÄÖ„É¢„Éº„ÉâÁî®„Ç¥„Éº„Çπ„Éà„Éú„Çø„É≥„Çπ„Çø„Ç§„É´ */
        .ghost-reaction {
            position: relative;
            background-image: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 5px,
                rgba(255, 255, 255, 0.1) 5px,
                rgba(255, 255, 255, 0.1) 10px
            );
        }

        /* === ÂÄã‰∫∫ÊÉÖÂ†±„Ç¢„É©„Éº„Éà „Çπ„Çø„Ç§„É´ === */
        .personal-info-alert {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .alert-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(5px);
        }

        .alert-modal {
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            z-index: 1;
            animation: alertSlideIn 0.3s ease-out;
        }

        @keyframes alertSlideIn {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 20px;
            border-radius: 15px 15px 0 0;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .alert-icon {
            font-size: 2rem;
        }

        .alert-header h3 {
            margin: 0;
            font-size: 1.5rem;
        }

        .alert-content {
            padding: 25px;
            line-height: 1.6;
        }

        .alert-content ul {
            background: #fff3cd;
            border: 1px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .alert-reason {
            color: #666;
            font-style: italic;
            margin: 15px 0;
        }

        .alert-suggestion {
            background: #d1ecf1;
            border: 1px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 15px 0;
        }

        .alert-actions {
            padding: 0 25px 25px;
            display: flex;
            gap: 15px;
            justify-content: flex-end;
        }

        .alert-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .edit-btn {
            background: #74b9ff;
            color: white;
        }

        .edit-btn:hover {
            background: #0984e3;
            transform: translateY(-2px);
        }

        .continue-btn {
            background: #00b894;
            color: white;
        }

        .continue-btn:hover {
            background: #00a085;
            transform: translateY(-2px);
        }

        .loading-indicator {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(255, 255, 255, 0.95);
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- „É≠„Ç∞„Ç§„É≥„É¢„Éº„ÉÄ„É´ -->
    <div id="loginModal" class="login-modal" style="display: none;">
        <div class="login-container">
            <div class="login-title">MULTAs „É≠„Ç∞„Ç§„É≥</div>
            <form class="login-form" onsubmit="handleLogin(event)">
                <input type="text" id="loginId" class="login-input" placeholder="ID„Éç„Éº„É†" required>
                <input type="password" id="loginPassword" class="login-input" placeholder="„Éë„Çπ„ÉØ„Éº„Éâ" required>
                <button type="submit" class="login-button">„É≠„Ç∞„Ç§„É≥</button>
                <div id="loginError" class="login-error"></div>
            </form>
        </div>
    </div>
    
    <!-- „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±Ë°®Á§∫ -->
    <div id="userInfo" class="user-info"></div>
    
    <!-- „Éò„ÉÉ„ÉÄ„Éº -->
    <div class="header">
        <h1>MULTAs</h1>
        <p>Medical University Learning and Training Assessment system</p>
        <!-- Êó•‰ªòÈÅ∏Êäû -->
        <div class="day-selector">
            <div class="day-display" onclick="toggleDayDropdown()">
                <span id="currentDayLabel">1Êó•ÁõÆ</span>
                <span style="font-size: 0.7em;">‚ñº</span>
            </div>
            <div class="day-dropdown" id="dayDropdown">
                <div class="day-option dev-only" onclick="selectDay('practice')" style="display: none;">Á∑¥Áøí</div>
                <div class="day-option selected" onclick="selectDay(1)">1Êó•</div>
                <div class="day-option" onclick="selectDay(2)">2Êó•</div>
                <div class="day-option" onclick="selectDay(3)">3Êó•</div>
                <div class="day-option" onclick="selectDay(4)">4Êó•</div>
                <div class="day-option" onclick="selectDay(5)">5Êó•</div>
            </div>
        </div>
    </div>

    <!-- „É¢„Éã„Çø„ÉºÂàá„ÇäÊõø„Åà„Çø„Éñ -->
    <div class="monitor-tabs">
        <button class="monitor-tab active" onclick="switchMonitor('monitor1')">
            LOG
        </button>
        <button class="monitor-tab" onclick="switchMonitor('monitor2')">
            LIST
        </button>
        <button class="monitor-tab" onclick="switchMonitor('monitor3')">
            REPORT
        </button>
    </div>

    <!-- „É°„Ç§„É≥„Ç≥„É≥„ÉÜ„É≥„ÉÑ -->
    <div class="main-content">
        
        <!-- Áµ±Ë®àÂõ∫ÂÆö„Ç®„É™„Ç¢ -->
        <div class="monitor-stats">
            <!-- „É¢„Éã„Çø„Éº1Áî®Áµ±Ë®à -->
            <div id="stats-monitor1" class="stats-display">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="recordCount">0</div>
                        <div class="stat-label">Ë®òÈå≤ÂõûÊï∞</div>
                    </div>
                    <div class="exp-bar-container">
                        <div class="exp-bar" id="expBar" style="width: 0%;"></div>
                    </div>
                    <div class="stat-card level-card">
                        <div class="stat-number" id="userLevel">1</div>
                        <div class="stat-label">LV</div>
                    </div>
                </div>
            </div>

            <!-- „É¢„Éã„Çø„Éº2Áî®Áµ±Ë®à -->
            <div id="stats-monitor2" class="stats-display" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="recordCount2">0</div>
                        <div class="stat-label">Ë®òÈå≤ÂõûÊï∞</div>
                    </div>
                    <div class="exp-bar-container">
                        <div class="exp-bar" id="expBar2" style="width: 0%;"></div>
                    </div>
                    <div class="stat-card level-card">
                        <div class="stat-number" id="userLevel2">1</div>
                        <div class="stat-label">LV</div>
                    </div>
                </div>
            </div>

            <!-- „É¢„Éã„Çø„Éº3Áî®Áµ±Ë®à -->
            <div id="stats-monitor3" class="stats-display" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="recordCount3">0</div>
                        <div class="stat-label">Ë®òÈå≤ÂõûÊï∞</div>
                    </div>
                    <div class="exp-bar-container">
                        <div class="exp-bar" id="expBar3" style="width: 0%;"></div>
                    </div>
                    <div class="stat-card level-card">
                        <div class="stat-number" id="userLevel3">1</div>
                        <div class="stat-label">LV</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- „É¢„Éã„Çø„Éº1: „É≠„Ç∞‰øùÂ≠ò -->
        <div id="monitor1" class="monitor active">
            <div class="monitor-content">
                <div id="recordsList">
                    <div class="empty-state">
                        <div class="icon">üìù</div>
                        <p>„Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>‰∏ã„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÊúÄÂàù„ÅÆË®òÈå≤„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- „É¢„Éã„Çø„Éº2: ‰ΩìÈ®ìÊï¥ÁêÜ -->
        <div id="monitor2" class="monitor">
            <div class="monitor-content">
                <div id="organizedView">
                    <div class="empty-state">
                        <div class="icon">ü§ñ</div>
                        <p>Ë®òÈå≤„ÇíËøΩÂä†„Åô„Çã„Å®<br>AIÂàÜÊûê„Å´„Çà„Çã12ÊôÇË®àÂàÜÈ°û„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô</p>
                    </div>
                </div>
                <!-- „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥„Éú„Çø„É≥ÔºàLISTÂÜÖÈÖçÁΩÆÔºâ -->
                <div id="sharedLearningBtnArea" class="dev-only" style="text-align: center; margin-top: 30px; padding: 20px 0; display: none;">
                    <button class="shared-learning-btn" onclick="toggleSharedLearning()" style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.3) 0%, rgba(254, 202, 87, 0.3) 100%); border: 2px dashed rgba(255, 107, 107, 0.5); padding: 15px 30px; border-radius: 30px; color: rgba(255, 255, 255, 0.8); font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: all 0.3s; display: inline-flex; align-items: center; gap: 10px; opacity: 0.7;" title="ÈñãÁô∫„É¢„Éº„Éâ: „É≠„Éº„Ç´„É´„Éá„É¢Ê©üËÉΩ">
                        <span style="font-size: 24px; position: relative; opacity: 0.6;">
                            <span style="position: absolute; left: -8px; top: -5px; opacity: 0.5;">üí¨</span>
                            <span style="position: absolute; left: 5px; top: -8px; opacity: 0.6;">üí¨</span>
                            <span style="position: relative;">üí¨</span>
                        </span>
                        <span style="font-size: 16px;">„Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ <span style="font-size: 0.8em; opacity: 0.7;">(Demo)</span></span>
                    </button>
                </div>
            </div>
        </div>

        <!-- „É¢„Éã„Çø„Éº3: Daily„É¨„Éù„Éº„Éà -->
        <div id="monitor3" class="monitor">
            <div class="monitor-content">
                <!-- „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàË°®Á§∫„Ç®„É™„Ç¢ -->
                <div id="radarChartContainer" class="radar-chart-container">
                    <div class="radar-chart-title">12ÊôÇË®àÂàÜÈ°û ‰ΩìÈ®ì„ÉÅ„É£„Éº„Éà</div>
                    <canvas id="radarChart"></canvas>
                    <div class="radar-legend" id="radarLegend"></div>
                </div>
                <!-- „É¨„Éù„Éº„ÉàË°®Á§∫„Ç®„É™„Ç¢ -->
                <div id="dailyReport">
                    <div class="report-content">
                        <h4>üìã Êú¨Êó•„ÅÆÂÆüÁøí„É¨„Éù„Éº„Éà</h4>
                        <div class="empty-state">
                            <div class="icon">üìä</div>
                            <p>Ë®òÈå≤„ÇíËøΩÂä†„Åó„Å¶„Åã„Çâ<br>„Äå„É¨„Éù„Éº„ÉàÁîüÊàê„Äç„Éú„Çø„É≥„ÇíÊäº„Åô„Å®<br>„Åù„ÅÆÊó•„ÅÆ‰ΩìÈ®ì„Çí„Åæ„Å®„ÇÅ„Åü„É¨„Éù„Éº„Éà„ÅåËá™ÂãïÁîüÊàê„Åï„Çå„Åæ„Åô</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- „É¢„Éã„Çø„Éº4: „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ -->
        <div id="monitor4" class="monitor">
            <div class="monitor-stats" id="stats-monitor4" style="display: none;">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="sharedCount">0</div>
                        <div class="stat-label">ÂÖ±Êúâ„Åï„Çå„ÅüÂ≠¶„Å≥</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="likeCount">0</div>
                        <div class="stat-label">„ÅÑ„ÅÑ„Å≠Áç≤ÂæóÊï∞</div>
                    </div>
                </div>
            </div>
            <div class="monitor-content">
                <div id="sharedLearning">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                        <h3 style="color: #7e57c2; margin: 0;">
                            üåü „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥
                            ${isDeveloperMode ? '<span style="font-size: 0.7em; color: #999; font-weight: normal;">(„É≠„Éº„Ç´„É´„Éá„É¢)</span>' : ''}
                        </h3>
                        <button onclick="backToList()" style="background: #7e57c2; color: white; border: none; padding: 8px 16px; border-radius: 20px; cursor: pointer;">
                            ‚Üê LIST„Å´Êàª„Çã
                        </button>
                    </div>
                    <div class="shared-learning-content" id="sharedLearningContent">
                        <!-- ÂÖ±Êúâ„Åï„Çå„ÅüÂ≠¶„Å≥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Çã -->
                        <div class="empty-state">
                            <div class="icon">ü§ù</div>
                            <p>‰ªñ„ÅÆÂÆüÁøíÁîü„ÅÆÂ≠¶„Å≥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô<br>„ÅÇ„Å™„Åü„ÅÆË®òÈå≤„ÇÇÂåøÂêç„ÅßÂÖ±Êúâ„Åß„Åç„Åæ„Åô</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- „Éú„Éà„É†ÂÖ•Âäõ„Éï„Ç©„Éº„É† -->
    <div class="bottom-input">
        <!-- „É¨„Éù„Éº„ÉàÁîüÊàê„Éú„Çø„É≥ÔºàREPORTÁîªÈù¢„ÅÆÊôÇ„ÅÆ„ÅøË°®Á§∫Ôºâ -->
        <div id="reportActionArea" class="report-action-area" style="display: none;">
            <button class="btn-secondary report-generate-btn" onclick="generateDailyReport()">
                ü§ñ „É¨„Éù„Éº„ÉàÁîüÊàê
            </button>
            <button class="btn-primary summary-report-btn" onclick="generateSummaryReport()" style="margin-top: 10px;">
                üìä Á∑èÂêà„É¨„Éù„Éº„ÉàÁîüÊàê
            </button>
            <!-- ÈñãÁô∫Áî®Ôºö„Çµ„É≥„Éó„É´ÊäïÁ®ø„Éú„Çø„É≥ -->
            <button class="btn-secondary sample-btn dev-only" onclick="addSampleRecords()" style="margin-top: 10px; background: #6c757d; display: none;">
                üîß „Çµ„É≥„Éó„É´10ÊäïÁ®ø„ÇíËøΩÂä†ÔºàÈñãÁô∫Áî®Ôºâ
            </button>
            <button class="btn-secondary sample-btn dev-only" onclick="addLongSampleRecord()" style="margin-top: 10px; background: #495057; display: none;">
                üìù Èï∑Êñá„Çµ„É≥„Éó„É´ÊäïÁ®ø„ÇíËøΩÂä†ÔºàÈñãÁô∫Áî®Ôºâ
            </button>
        </div>
        
        <div class="input-row">
            <div class="experience-input" style="position: relative;">
                <textarea id="experienceText" placeholder="ÂÆüÁøí„Åß‰ΩìÈ®ì„Åó„Åü„Åì„Å®„ÇíË®òÈå≤‚Ä¶ ‚ÄªÊÇ£ËÄÖ„ÅÆÂÄã‰∫∫ÊÉÖÂ†±„ÅØÂÖ•Âäõ„Åó„Å™„ÅÑ"></textarea>
                <button type="button" class="submit-btn" onclick="submitExperience()" title="ÈÄÅ‰ø°">
                    <span id="submitText">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                            <path d="M2 21L23 12L2 3V10L17 12L2 14V21Z" fill="white"/>
                        </svg>
                    </span>
                    <span id="submitLoading" style="display: none;">
                        <span class="loading"></span>
                    </span>
                </button>
            </div>
        </div>

        <div id="statusMessage"></div>
    </div>

    <script>
        // === „Ç∞„É≠„Éº„Éê„É´Â§âÊï∞ ===
        let records = [];
        let recordIdCounter = 0;
        let currentMonitor = 'monitor1';
        let currentDay = 1;  // ÁèæÂú®„ÅÆÊó•‰ªòÔºà1-5„Åæ„Åü„ÅØpracticeÔºâ
        
        // === DOMË¶ÅÁ¥†„Ç≠„É£„ÉÉ„Ç∑„É• ===
        const DOM = {};
        function initDOMCache() {
            // È†ªÁπÅ„Å´‰ΩøÁî®„Åï„Çå„ÇãË¶ÅÁ¥†„Çí„Ç≠„É£„ÉÉ„Ç∑„É•
            DOM.expBar = [
                document.getElementById('expBar'),
                document.getElementById('expBar2'),
                document.getElementById('expBar3')
            ];
            DOM.expText = [
                document.getElementById('expText'),
                document.getElementById('expText2'),
                document.getElementById('expText3')
            ];
            DOM.userLevel = [
                document.getElementById('userLevel'),
                document.getElementById('userLevel2'),
                document.getElementById('userLevel3')
            ];
            DOM.recordCount = [
                document.getElementById('recordCount'),
                document.getElementById('recordCount2'),
                document.getElementById('recordCount3')
            ];
            DOM.recordsList = document.getElementById('recordsList');
            DOM.organizedView = document.getElementById('organizedView');
            DOM.radarChartCanvas = document.getElementById('radarChart');
            DOM.dailyReport = document.getElementById('dailyReport');
            DOM.currentDayLabel = document.getElementById('currentDayLabel');
            DOM.messageInput = document.getElementById('messageInput');
        }
        
        // === OpenAI APIË®≠ÂÆö ===
        let OPENAI_API_KEY = localStorage.getItem('multasApiKey') || '';
        
        // API„Ç≠„Éº„ÅåÊú™Ë®≠ÂÆö„ÅÆÂ†¥Âêà„ÅÆÂá¶ÁêÜ
        function checkApiKey() {
            if (!OPENAI_API_KEY) {
                const key = prompt('OpenAI API„Ç≠„Éº„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:');
                if (key) {
                    OPENAI_API_KEY = key;
                    localStorage.setItem('multasApiKey', key);
                } else {
                    alert('API„Ç≠„Éº„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Å™„ÅÑ„Åü„ÇÅ„ÄÅAIÂàÜÈ°ûÊ©üËÉΩ„ÅØ‰ΩøÁî®„Åß„Åç„Åæ„Åõ„Çì„ÄÇ');
                }
            }
        }
        
        // === ÂåªÂ≠¶ÂÆüÁøí12ÊôÇË®àÂàÜÈ°û„Ç∑„Çπ„ÉÜ„É† ===
        const CLOCK_CATEGORIES = {
            0: { name: 'ÂàÜÈ°û‰∏çËÉΩ', icon: '‚ùì', vector: {x: 0, y: 0} },
            1: { name: 'ÂåªÁôÇÂÄ´ÁêÜ', icon: '‚öñÔ∏è', vector: {x: -0.3, y: -0.5} },
            2: { name: 'Âú∞ÂüüÂåªÁôÇ', icon: 'üèòÔ∏è', vector: {x: -0.5, y: 0.8} },
            3: { name: 'ÂåªÂ≠¶Áü•Ë≠ò', icon: 'üìö', vector: {x: 0.8, y: -0.5} },
            4: { name: 'Ë®∫ÂØü„ÉªÊâãÊäÄ', icon: 'ü©∫', vector: {x: 0.9, y: -0.7} },
            5: { name: 'ÊÇ£ËÄÖ„Å´ÂØæ„Åô„ÇãÂïèÈ°åËß£Ê±∫ËÉΩÂäõ', icon: 'ü§ù', vector: {x: 0.5, y: -0.9} },
            6: { name: 'Áµ±ÂêàÁöÑËá®Â∫ä', icon: 'üè•', vector: {x: 0, y: -0.8} },
            7: { name: 'Â§öËÅ∑Á®ÆÈÄ£Êê∫', icon: 'üë•', vector: {x: -0.5, y: -0.7} },
            8: { name: '„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥', icon: 'üí¨', vector: {x: -0.8, y: -0.3} },
            9: { name: '‰∏ÄËà¨ÊïôÈ§ä', icon: 'üìñ', vector: {x: -0.9, y: 0.3} },
            10: { name: '‰øùÂÅ•„ÉªÁ¶èÁ•â', icon: 'üèõÔ∏è', vector: {x: -0.3, y: 0.9} },
            11: { name: 'Ë°åÊîø', icon: 'üè•', vector: {x: -0.7, y: 0.7} },
            12: { name: 'Á§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîü', icon: 'üåç', vector: {x: 0, y: 0.9} }
        };
        let userLevel = 1;
        let userExp = 0;
        let totalPosts = 0; // Á∑èÊäïÁ®øÊï∞„ÇíËøΩË∑°
        let generatedReports = {}; // ÁîüÊàêÊ∏à„Åø„É¨„Éù„Éº„Éà„ÇíËøΩË∑°
        let savedReports = {}; // Êó•‰ªòÂà•„ÅÆÁîüÊàêÊ∏à„Åø„É¨„Éù„Éº„ÉàHTML
        let categoryPointsByDay = {}; // Êó•‰ªòÂà•„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà
        let summaryReportHtml = null; // Á∑èÂêà„É¨„Éù„Éº„Éà„ÅÆHTML„Çí‰øùÂ≠ò
        let currentUser = null; // „É≠„Ç∞„Ç§„É≥„É¶„Éº„Ç∂„ÉºÊÉÖÂ†±
        let isDeveloperMode = false; // ÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„Éï„É©„Ç∞
        
        // ÂêÑÊó•‰ªò„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà„ÇíÂàùÊúüÂåñ
        const dayKeys = ['practice', '1', '2', '3', '4', '5'];
        dayKeys.forEach(day => {
            categoryPointsByDay[day] = {};
            for (let i = 0; i <= 12; i++) {
                categoryPointsByDay[day][i] = 0;
            }
        });
        
        // „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„Åã„ÇâË™≠„ÅøËæº„Åø
        const savedGameData = localStorage.getItem('multasGameData');
        if (savedGameData) {
            const gameData = JSON.parse(savedGameData);
            userLevel = gameData.userLevel || 1;
            userExp = gameData.userExp || 0;
            totalPosts = gameData.totalPosts || 0;
            generatedReports = gameData.generatedReports || {};
            categoryPointsByDay = gameData.categoryPointsByDay || categoryPointsByDay;
        }

        // === 12ÊôÇË®à„Ç´„ÉÜ„Ç¥„É™„ÅÆËâ≤ÂÆöÁæ© ===
        const AI_CATEGORIES = {
            0: { name: '‚ùì ÂàÜÈ°û‰∏çËÉΩ', color: '#b2bec3' },
            1: { name: '‚öñÔ∏è ÂåªÁôÇÂÄ´ÁêÜ', color: '#ff9ff3' },
            2: { name: 'üèòÔ∏è Âú∞ÂüüÂåªÁôÇ', color: '#ff6b6b' },
            3: { name: 'üìö ÂåªÂ≠¶Áü•Ë≠ò', color: '#54a0ff' },
            4: { name: 'ü©∫ Ë®∫ÂØü„ÉªÊâãÊäÄ', color: '#48dbfb' },
            5: { name: 'ü§ù ÊÇ£ËÄÖ„Å´ÂØæ„Åô„ÇãÂïèÈ°åËß£Ê±∫ËÉΩÂäõ', color: '#1dd1a1' },
            6: { name: 'üè• Áµ±ÂêàÁöÑËá®Â∫ä', color: '#10ac84' },
            7: { name: 'üë• Â§öËÅ∑Á®ÆÈÄ£Êê∫', color: '#feca57' },
            8: { name: 'üí¨ „Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥', color: '#ff9ff3' },
            9: { name: 'üìñ ‰∏ÄËà¨ÊïôÈ§ä', color: '#dfe6e9' },
            10: { name: 'üèõÔ∏è ‰øùÂÅ•„ÉªÁ¶èÁ•â', color: '#6c5ce7' },
            11: { name: 'üè• Ë°åÊîø', color: '#a29bfe' },
            12: { name: 'üåç Á§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîü', color: '#fd79a8' }
        };

        // === ‰ΩìÈ®ìË®òÈå≤ÈÄÅ‰ø° ===
        async function submitExperience() {
            const experienceText = document.getElementById('experienceText').value.trim();
            
            if (!experienceText) {
                showStatus('‰ΩìÈ®ìÂÜÖÂÆπ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error');
                return;
            }

            // ÂÄã‰∫∫ÊÉÖÂ†±„ÉÅ„Çß„ÉÉ„ÇØÂÆüË°å
            showLoadingIndicator('ÂÄã‰∫∫ÊÉÖÂ†±„Çí„ÉÅ„Çß„ÉÉ„ÇØ‰∏≠...');
            
            try {
                const checkResult = await checkPersonalInformation(experienceText);
                hideLoadingIndicator();
                
                if (checkResult.hasPersonalInfo) {
                    // „Ç¢„É©„Éº„ÉàË°®Á§∫„Åó„Å¶„É¶„Éº„Ç∂„Éº„ÅÆÈÅ∏Êäû„ÇíÂæÖ„Å§
                    const shouldContinue = await showPersonalInfoAlert(checkResult);
                    
                    if (!shouldContinue) {
                        // ‰øÆÊ≠£„ÇíÈÅ∏Êäû„Åó„ÅüÂ†¥Âêà„ÄÅÂÖ•ÂäõÊ¨Ñ„Å´„Éï„Ç©„Éº„Ç´„Çπ
                        document.getElementById('experienceText').focus();
                        return;
                    }
                }
            } catch (error) {
                hideLoadingIndicator();
                console.error('ÂÄã‰∫∫ÊÉÖÂ†±„ÉÅ„Çß„ÉÉ„ÇØ„Åß„Ç®„É©„Éº:', error);
                // „Ç®„É©„ÉºÊôÇ„ÅØÈÄöÂ∏∏Âá¶ÁêÜ„ÇíÁ∂öË°å
            }

            // UIÁä∂ÊÖã„ÇíÂá¶ÁêÜ‰∏≠„Å´Â§âÊõ¥
            const submitBtn = document.querySelector('.submit-btn');
            const submitText = document.getElementById('submitText');
            const submitLoading = document.getElementById('submitLoading');
            
            submitBtn.disabled = true;
            submitText.style.display = 'none';
            submitLoading.style.display = 'inline-block';

            try {
                // AIÂàÜÈ°û„ÇíÂÆüË°å
                showStatus('ü§ñ AIÂàÜÊûê‰∏≠...', 'info');
                const aiResult = await classifyWithAI(experienceText);
                
                // „É≠„Éº„Ç´„É´Âá¶ÁêÜ„ÅßÂç≥Â∫ß„Å´Ë°®Á§∫
                const localRecord = {
                    id: ++recordIdCounter,
                    originalText: experienceText,
                    timestamp: new Date(),
                    day: currentDay, // ÁèæÂú®„ÅÆÊó•‰ªò„ÇíË®òÈå≤
                    category: aiResult.category,
                    confidence: aiResult.confidence,
                    aiProcessed: true,
                    aiReason: aiResult.reason,
                    depth: aiResult.depth,
                    vector: aiResult.vector,
                    consistency: aiResult.consistency
                };

                records.unshift(localRecord);
                
                // Èï∑ÊñáÂà§ÂÆöÔºà150ÊñáÂ≠ó‰ª•‰∏äÔºâ
                if (experienceText.length >= 150) {
                    // Ë¶ÅÁ¥†ÂàÜËß£„ÇíÂÆüË°å
                    const multiResult = await classifyWithMultipleElements(experienceText);
                    if (multiResult && multiResult.elements) {
                        const dayKey = String(currentDay);
                        if (!categoryPointsByDay[dayKey]) {
                            categoryPointsByDay[dayKey] = {};
                            for (let i = 0; i <= 12; i++) {
                                categoryPointsByDay[dayKey][i] = 0;
                            }
                        }
                        
                        // ÂêÑË¶ÅÁ¥†„Å´ÂØæ„Åó„Å¶„Éù„Ç§„É≥„Éà„ÇíÂä†ÁÆóÔºà1ptÊú™Ê∫Ä„ÅØ1pt„Å®„Åø„Å™„ÅôÔºâ
                        let totalWeight = 0;
                        multiResult.elements.forEach(element => {
                            const points = Math.max(1, Math.round(element.weight));
                            categoryPointsByDay[dayKey][element.category] = 
                                (categoryPointsByDay[dayKey][element.category] || 0) + points;
                            totalWeight += points;
                        });
                        
                        // Ë¶ÅÁ¥†ÂàÜËß£ÁµêÊûú„ÇíË®òÈå≤„Å´‰øùÂ≠ò
                        localRecord.multipleElements = multiResult.elements;
                        localRecord.totalWeight = totalWeight;
                        
                        // Ë§áÊï∞Ë¶ÅÁ¥†„ÅÆÂ†¥Âêà„ÄÅExp„Çí„Éú„Éº„Éä„Çπ
                        if (multiResult.elements.length > 1 && currentDay !== 'practice' && aiResult.category !== 0) {
                            const expPerPost = Math.ceil(100 / userLevel);
                            const bonusExp = Math.floor(expPerPost * 0.5 * (multiResult.elements.length - 1));
                            userExp += bonusExp;
                            showStatus(`üåü Ë§áÊï∞Ë¶ÅÁ¥†„Éú„Éº„Éä„Çπ +${bonusExp}Exp`, 'success');
                        }
                    }
                } else {
                    // Áü≠Êñá„ÅÆÂ†¥Âêà„ÅØÂçò‰∏ÄÂàÜÈ°û
                    const dayKey = String(currentDay);
                    if (!categoryPointsByDay[dayKey]) {
                        categoryPointsByDay[dayKey] = {};
                        for (let i = 0; i <= 12; i++) {
                            categoryPointsByDay[dayKey][i] = 0;
                        }
                    }
                    categoryPointsByDay[dayKey][aiResult.category] = (categoryPointsByDay[dayKey][aiResult.category] || 0) + 1;
                }
                
                saveGameData();
                
                // Á∑¥ÁøíÁî®‰ª•Â§ñ„Åã„Å§ÂàÜÈ°û‰∏çËÉΩÔºà„Ç´„ÉÜ„Ç¥„É™0Ôºâ‰ª•Â§ñ„ÅÆÂ†¥Âêà„ÅÆ„ÅøÁµåÈ®ìÂÄ§„ÇíËøΩÂä†
                if (currentDay !== 'practice' && aiResult.category !== 0) {
                    addExperience();
                } else if (currentDay !== 'practice' && aiResult.category === 0) {
                    showStatus('‚ùì ÂàÜÈ°û‰∏çËÉΩ„ÅÆ„Åü„ÇÅÁµåÈ®ìÂÄ§„ÅØÁç≤Âæó„Åß„Åç„Åæ„Åõ„Çì', 'info');
                }
                
                updateAllViews();
                showStatus('‚úÖ ÈÄÅ‰ø°„Åó„Åæ„Åó„ÅüÔºÅ', 'success');

                // „Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„Éâ„ÅßGASÂá¶ÁêÜ
                try {
                    const response = await fetch(window.location.href, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'processExperience',
                            studentName: studentName,
                            experienceText: experienceText
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        if (result.success) {
                            // GASÂá¶ÁêÜÊàêÂäüÊôÇ„Å´„É≠„Éº„Ç´„É´Ë®òÈå≤„ÇíÊõ¥Êñ∞
                            localRecord.category = result.classificationResult.category;
                            localRecord.confidence = result.classificationResult.confidence;
                            localRecord.aiProcessed = result.classificationResult.aiProcessed;
                            updateAllViews();
                            showStatus('ü§ñ AIÂàÜÊûêÂÆå‰∫ÜÔºÅÂàÜÈ°ûÁµêÊûú„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü„ÄÇ', 'success');
                        }
                    }
                } catch (gasError) {
                    console.log('GASÂá¶ÁêÜ„ÅØ„Çπ„Ç≠„ÉÉ„ÉóÔºà„É≠„Éº„Ç´„É´Âãï‰ΩúÔºâ:', gasError);
                }

            } catch (error) {
                // „É≠„Éº„Ç´„É´Áí∞Â¢É„Åß„ÅØÊ≠£Â∏∏Âãï‰Ωú„Å™„ÅÆ„Åß„Ç®„É©„ÉºË°®Á§∫„Åó„Å™„ÅÑ
                console.log('„É≠„Éº„Ç´„É´Áí∞Â¢É„Åß„ÅÆÂãï‰Ωú:', error);
            } finally {
                // UIÁä∂ÊÖã„ÇíÂÖÉ„Å´Êàª„Åô
                submitBtn.disabled = false;
                submitText.style.display = 'inline-block';
                submitLoading.style.display = 'none';
                
                // „Éï„Ç©„Éº„É†„Çí„ÇØ„É™„Ç¢
                document.getElementById('experienceText').value = '';
            }
        }

        // === „É¢„Éã„Çø„ÉºÂàá„ÇäÊõø„Åà ===
        function switchMonitor(monitorId) {
            // ÂÖ®„É¢„Éã„Çø„Éº„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.monitor').forEach(monitor => {
                monitor.classList.remove('active');
            });

            // ÂÖ®„Çø„Éñ„ÅÆ active „ÇØ„É©„Çπ„ÇíÂâäÈô§
            document.querySelectorAll('.monitor-tab').forEach(tab => {
                tab.classList.remove('active');
            });

            // ÂÖ®Áµ±Ë®àË°®Á§∫„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.stats-display').forEach(stats => {
                stats.style.display = 'none';
            });

            // ÈÅ∏Êäû„Åï„Çå„Åü„É¢„Éã„Çø„Éº„ÇíË°®Á§∫
            document.getElementById(monitorId).classList.add('active');
            event.target.classList.add('active');

            // ÂØæÂøú„Åô„ÇãÁµ±Ë®à„ÇíË°®Á§∫
            const statsId = 'stats-' + monitorId;
            const statsElement = document.getElementById(statsId);
            if (statsElement) {
                statsElement.style.display = 'block';
            }
            
            // „É¨„Éù„Éº„ÉàÁîüÊàê„Éú„Çø„É≥„ÅÆË°®Á§∫Âà∂Âæ°
            const reportActionArea = document.getElementById('reportActionArea');
            if (monitorId === 'monitor3') {
                reportActionArea.style.display = 'block';
                // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíÊõ¥Êñ∞
                updateRadarChart();
                // ‰øùÂ≠ò„Åï„Çå„Åü„É¨„Éù„Éº„Éà„ÇíË°®Á§∫
                displayAllReports();
            } else {
                reportActionArea.style.display = 'none';
            }

            currentMonitor = monitorId;
            
            // „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ÁîªÈù¢„ÅÆÂ†¥Âêà
            if (monitorId === 'monitor4') {
                loadSharedLearnings();
            }

            // „É¢„Éã„Çø„ÉºÂàá„ÇäÊõø„ÅàÊôÇ„Å´Ë°®Á§∫„ÇíÊõ¥Êñ∞
            updateAllViews();
        }

        // === ÂÖ®„Éì„É•„ÉºÊõ¥Êñ∞ ===
        // === ÁµåÈ®ìÂÄ§ËøΩÂä† ===
        async function addExperience() {
            totalPosts++;
            
            // ÁèæÂú®„ÅÆ„É¨„Éô„É´„ÅßÁç≤Âæó„Åô„ÇãExp = 100 / „É¨„Éô„É´ÔºàÂàá„Çä‰∏ä„ÅíÔºâ
            const expPerPost = Math.ceil(100 / userLevel);
            const oldExp = userExp;
            userExp += expPerPost;
            
            // „É¨„Éô„É´1„ÅÆÂ†¥Âêà„ÅØÁâπÂà•„Å™ÊºîÂá∫
            if (userLevel === 1) {
                await animateExpGain(oldExp, userExp);
            } else {
                // ÈÄöÂ∏∏„ÅÆÂç≥Â∫ßÊõ¥Êñ∞
                updateExpDisplay();
            }
            
            // „É¨„Éô„É´„Ç¢„ÉÉ„Éó„ÉÅ„Çß„ÉÉ„ÇØÔºà100Exp„Åß„É¨„Éô„É´„Ç¢„ÉÉ„ÉóÔºâ
            if (userExp >= 100) {
                // „Åæ„Åö100%„Åæ„ÅßË°®Á§∫„ÇíÊõ¥Êñ∞
                const expBars = [
                    document.getElementById('expBar'),
                    document.getElementById('expBar2'),
                    document.getElementById('expBar3')
                ];
                const expTexts = [
                    document.getElementById('expText'),
                    document.getElementById('expText2'),
                    document.getElementById('expText3')
                ];
                
                expBars.forEach(bar => {
                    if (bar) bar.style.width = '100%';
                });
                expTexts.forEach(text => {
                    if (text) text.textContent = 'EXP: 100 / 100';
                });
                
                // 100%„Å´„Å™„Å£„Åü„Åì„Å®„ÇíË¶ã„Åõ„Çã
                await new Promise(resolve => setTimeout(resolve, 500));
                
                if (userLevel === 1) {
                    // „É¨„Éô„É´1‚Üí2„ÅÆÁâπÂà•ÊºîÂá∫
                    await showExpBarGlow();
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
                
                // „É¨„Éô„É´„Ç¢„ÉÉ„ÉóÂá¶ÁêÜ
                const overflowExp = userExp - 100;  // 100„ÇíË∂Ö„Åà„ÅüÂàÜ„ÇíË®òÊÜ∂
                userLevel++;
                showLevelUpAnimation();
                
                // „Éá„Ç£„Çæ„É´„ÉñÊºîÂá∫
                await dissolveExpBar();
                
                // ‰ΩôÂâ∞ÂàÜ„ÇíÁπ∞„ÇäË∂ä„Åó
                userExp = overflowExp;
                updateExpDisplay(); // Êñ∞„Åó„ÅÑ„É¨„Éô„É´„Å®EXP„ÇíË°®Á§∫
            }
            
            // „Éá„Éº„Çø„Çí‰øùÂ≠ò
            saveGameData();
            
            // „É¨„Éô„É´1‰ª•Â§ñ„ÅÆÂ†¥Âêà„ÅÆÊúÄÁµÇÊõ¥Êñ∞
            if (userLevel !== 1) {
                updateExpDisplay();
            }
        }
        
        // === EXP„Ç≤„Ç§„É≥„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ôºà„É¨„Éô„É´1Â∞ÇÁî®Ôºâ ===
        async function animateExpGain(startExp, endExp) {
            const duration = 1500; // 1.5Áßí„Åã„Åë„Å¶„ÇÜ„Å£„Åè„Çä
            const steps = 30;
            const stepDuration = duration / steps;
            const expIncrement = (endExp - startExp) / steps;
            
            for (let i = 0; i <= steps; i++) {
                const currentExp = Math.min(startExp + (expIncrement * i), endExp);
                userExp = Math.round(currentExp);
                updateExpDisplay();
                await new Promise(resolve => setTimeout(resolve, stepDuration));
            }
            
            userExp = endExp; // ÊúÄÁµÇÂÄ§„ÇíÁ¢∫ÂÆü„Å´Ë®≠ÂÆö
            updateExpDisplay();
        }
        
        // === EXP„Éê„Éº„ÅÆËºù„Åç„Ç®„Éï„Çß„ÇØ„Éà ===
        async function showExpBarGlow() {
            const expBars = [
                document.getElementById('expBar'),
                document.getElementById('expBar2'),
                document.getElementById('expBar3')
            ];
            
            expBars.forEach(bar => bar.classList.add('glowing'));
            
            // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÁµÇ‰∫ÜÂæå„Å´„ÇØ„É©„Çπ„ÇíÂâäÈô§
            await new Promise(resolve => setTimeout(resolve, 1000));
            expBars.forEach(bar => bar.classList.remove('glowing'));
        }
        
        // === EXP„Éê„Éº„Éá„Ç£„Çæ„É´„Éñ„Ç®„Éï„Çß„ÇØ„Éà ===
        async function dissolveExpBar() {
            const expBars = [
                document.getElementById('expBar'),
                document.getElementById('expBar2'),
                document.getElementById('expBar3')
            ];
            
            // „Éá„Ç£„Çæ„É´„Éñ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÈñãÂßã
            expBars.forEach(bar => {
                bar.classList.add('dissolving');
            });
            
            // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÂÆå‰∫Ü„ÇíÂæÖ„Å§
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // „ÇØ„É©„Çπ„ÇíÂâäÈô§„Åó„Å¶„É™„Çª„ÉÉ„Éà
            expBars.forEach(bar => {
                bar.classList.remove('dissolving');
                bar.style.opacity = '1';
                bar.style.filter = 'none';
                bar.style.transform = 'none';
            });
        }
        
        // === EXP„Éê„Éº„ÇíÂç≥Â∫ß„Å´Ë®≠ÂÆöÔºà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Å™„ÅóÔºâ ===
        function setExpBarInstant(percent) {
            const expBars = [
                document.getElementById('expBar'),
                document.getElementById('expBar2'),
                document.getElementById('expBar3')
            ];
            
            // „Éà„É©„É≥„Ç∏„Ç∑„Éß„É≥„Çí‰∏ÄÊôÇÁöÑ„Å´ÁÑ°ÂäπÂåñ
            expBars.forEach(bar => {
                bar.style.transition = 'none';
                bar.style.width = percent + '%';
            });
            
            // Ê¨°„ÅÆ„Éï„É¨„Éº„É†„Åß„Éà„É©„É≥„Ç∏„Ç∑„Éß„É≥„ÇíÂæ©Ê¥ª
            requestAnimationFrame(() => {
                expBars.forEach(bar => {
                    bar.style.transition = 'width 0.3s ease-out';
                });
            });
        }
        
        // === „É¨„Éô„É´„Ç¢„ÉÉ„Éó„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥Ë°®Á§∫ ===
        function showLevelUpAnimation() {
            // „Åô„Åπ„Å¶„ÅÆ„É¨„Éô„É´„Ç´„Éº„Éâ„ÇíÂèñÂæó
            const levelCards = document.querySelectorAll('.stat-card.level-card');
            
            levelCards.forEach(card => {
                // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„ÇØ„É©„Çπ„ÇíËøΩÂä†
                card.classList.add('level-up-animation');
                
                // Âêπ„ÅçÂá∫„Åó„Çí‰ΩúÊàê
                const bubble = document.createElement('div');
                bubble.className = 'level-up-bubble';
                bubble.textContent = 'LEVEL UP!';
                document.body.appendChild(bubble);
                
                // „Ç´„Éº„Éâ„ÅÆ‰ΩçÁΩÆ„ÇíÂèñÂæó
                const rect = card.getBoundingClientRect();
                const bubbleHeight = 40; // Âêπ„ÅçÂá∫„Åó„ÅÆÊé®ÂÆöÈ´ò„Åï
                
                // Âêπ„ÅçÂá∫„Åó„ÅÆ‰ΩçÁΩÆ„ÇíË®≠ÂÆö
                bubble.style.left = rect.left + (rect.width / 2) + 'px';
                bubble.style.top = (rect.top - bubbleHeight - 20) + 'px';
                bubble.style.transform = 'translateX(-50%)';
                
                // „Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ÁµÇ‰∫ÜÂæå„Å´„ÇØ„É©„Çπ„Å®Âêπ„ÅçÂá∫„Åó„ÇíÂâäÈô§
                setTimeout(() => {
                    card.classList.remove('level-up-animation');
                    bubble.remove();
                }, 2000);
            });
            
            // „Çπ„ÉÜ„Éº„Çø„Çπ„É°„ÉÉ„Çª„Éº„Ç∏„ÇÇË°®Á§∫
            showStatus(`üéâ LEVEL UP! LV.${userLevel}„Å´„Å™„Çä„Åæ„Åó„ÅüÔºÅ`, 'success');
        }
        
        // === „Éú„Éº„Éä„Çπ„É¨„Éô„É´ËøΩÂä†Ôºà„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥‰ªò„ÅçÔºâ ===
        async function addBonusLevels(levels, message) {
            showStatus(`üéÅ ${message}`, 'success');
            
            for (let i = 0; i < levels; i++) {
                // ÁèæÂú®„ÅÆEXP„Åã„Çâ100%„Åæ„Åß„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                const currentPercent = userExp;
                const animationDuration = 800; // 0.8Áßí„Åß100%„Åæ„Åß
                const startTime = Date.now();
                
                // EXP„Éê„Éº„Çí100%„Åæ„Åß„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                await new Promise(resolve => {
                    const expBars = [
                        document.getElementById('expBar'),
                        document.getElementById('expBar2'),
                        document.getElementById('expBar3')
                    ];
                    const expTexts = [
                        document.getElementById('expText'),
                        document.getElementById('expText2'),
                        document.getElementById('expText3')
                    ];
                    
                    const animate = () => {
                        const elapsed = Date.now() - startTime;
                        const progress = Math.min(elapsed / animationDuration, 1);
                        
                        // „Ç§„Éº„Ç∏„É≥„Ç∞Èñ¢Êï∞Ôºàease-outÔºâ
                        const easeOut = 1 - Math.pow(1 - progress, 3);
                        const newPercent = currentPercent + (100 - currentPercent) * easeOut;
                        
                        // EXP„Éê„Éº„ÇíÊõ¥Êñ∞
                        expBars.forEach(bar => {
                            if (bar) bar.style.width = newPercent + '%';
                        });
                        expTexts.forEach(text => {
                            if (text) text.textContent = `EXP: ${Math.floor(newPercent)} / 100`;
                        });
                        
                        if (progress < 1) {
                            requestAnimationFrame(animate);
                        } else {
                            // 100%„Å´ÈÅî„Åó„Åü„Åì„Å®„ÇíÁ¢∫ÂÆü„Å´„Åô„Çã
                            expBars.forEach(bar => {
                                if (bar) bar.style.width = '100%';
                            });
                            expTexts.forEach(text => {
                                if (text) text.textContent = 'EXP: 100 / 100';
                            });
                            resolve();
                        }
                    };
                    animate();
                });
                
                // 100%„ÅßÂ∞ë„ÅóÂæÖÊ©üÔºàÊ∫Ä„Çø„É≥„ÇíË¶ã„Åõ„ÇãÔºâ
                await new Promise(resolve => setTimeout(resolve, 300));
                
                // „É¨„Éô„É´„Ç¢„ÉÉ„Éó
                userLevel++;
                userExp = 0;
                
                // „É¨„Éô„É´„Ç¢„ÉÉ„Éó„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
                showLevelUpAnimation();
                
                // EXP„Éê„Éº„Çí0„Å´„É™„Çª„ÉÉ„ÉàÔºà„Éá„Ç£„Çæ„É´„ÉñÊºîÂá∫Ôºâ
                await dissolveExpBar();
                
                // Ë°®Á§∫Êõ¥Êñ∞
                updateExpDisplay();
                saveGameData();
                
                // Ê¨°„ÅÆ„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥„Åæ„ÅßÂæÖÊ©ü
                await new Promise(resolve => setTimeout(resolve, 800));
            }
        }
        
        // === EXP„Éê„Éº„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥ ===
        async function animateExpBar() {
            const expBar = document.getElementById('expBar');
            const expBar2 = document.getElementById('expBar2');
            const expBar3 = document.getElementById('expBar3');
            
            // ÁèæÂú®„ÅÆÂπÖ„Åã„Çâ100%„Åæ„Åß„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            const currentWidth = (userExp / 100) * 100;
            const duration = 500; // 0.5Áßí„Åß„Ç¢„Éã„É°„Éº„Ç∑„Éß„É≥
            const steps = 20;
            const stepDuration = duration / steps;
            const widthIncrement = (100 - currentWidth) / steps;
            
            for (let i = 0; i < steps; i++) {
                const newWidth = currentWidth + (widthIncrement * (i + 1));
                expBar.style.width = newWidth + '%';
                expBar2.style.width = newWidth + '%';
                expBar3.style.width = newWidth + '%';
                await new Promise(resolve => setTimeout(resolve, stepDuration));
            }
            
            // ÊúÄÂæå„Å´Á¢∫ÂÆü„Å´100%„Å´„Åô„Çã
            expBar.style.width = '100%';
            expBar2.style.width = '100%';
            expBar3.style.width = '100%';
        }
        
        // === „Ç≤„Éº„É†„Éá„Éº„Çø‰øùÂ≠ò ===
        function saveGameData() {
            const gameData = {
                userLevel: userLevel,
                userExp: userExp,
                totalPosts: totalPosts,
                generatedReports: generatedReports,
                categoryPointsByDay: categoryPointsByDay
            };
            localStorage.setItem('multasGameData', JSON.stringify(gameData));
        }

        // === Èï∑ÊñáË¶ÅÁ¥†ÂàÜËß£AIÂàÜÈ°ûÈñ¢Êï∞ ===
        async function classifyWithMultipleElements(recordText) {
            // API„Ç≠„Éº„ÉÅ„Çß„ÉÉ„ÇØ
            checkApiKey();
            if (!OPENAI_API_KEY) {
                throw new Error('API„Ç≠„Éº„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
            }
            
            try {
                const prompt = `ÂåªÂ≠¶Áîü„ÅÆÂÆüÁøíË®òÈå≤„ÇíÊñáÁ´†Âçò‰Ωç„ÅßÂàÜËß£„Åó„ÄÅÂêÑË¶ÅÁ¥†„ÅÆÂ≠¶ÁøíÂÜÖÂÆπ„Çí12ÊôÇË®àÂàÜÈ°û„ÅßË©≥Á¥∞„Å´ÂàÜÈ°û„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

Ë®òÈå≤: "${recordText}"

„ÄêÂàÜÊûêÊñπÊ≥ï„Äë
1. ÊñáÁ´†„ÇíÊÑèÂë≥„ÅÆ„ÅÇ„ÇãÂçò‰ΩçÔºàÊñá„ÇÑÁØÄÔºâ„Å´ÂàÜËß£„Åô„Çã
2. ÂêÑÂçò‰Ωç„ÅßÂ≠¶„Çì„Å†ÂÜÖÂÆπ„ÇíÁâπÂÆö„Åô„Çã
3. Ë§áÊï∞„ÅÆ„Çπ„Ç≠„É´„ÅåÁµ±Âêà„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØ„ÄåÁµ±ÂêàÁöÑËá®Â∫ä„Äç„Å®„Åó„Å¶ÂàÜÈ°û
4. Âçò‰∏Ä„ÅÆ„Çπ„Ç≠„É´„ÅÆÂ†¥Âêà„ÅØË©≤ÂΩì„Åô„Çã„Ç´„ÉÜ„Ç¥„É™„Å´ÂàÜÈ°û

„Äê12ÊôÇË®à„Ç´„ÉÜ„Ç¥„É™„Äë
0ÊôÇ: ÂàÜÈ°û‰∏çËÉΩ
1ÊôÇ: ÂåªÁôÇÂÄ´ÁêÜÔºàÂÄ´ÁêÜ„ÄÅÊ≥ïÂæã„ÄÅË¶èÁØÑ„ÄÅ„Ç§„É≥„Éï„Ç©„Éº„É†„Éâ„Ç≥„É≥„Çª„É≥„ÉàÔºâ
2ÊôÇ: Âú∞ÂüüÂåªÁôÇÔºàË®™ÂïèË®∫ÁôÇ„ÄÅÂú®ÂÆÖÂåªÁôÇ„ÄÅÂú∞ÂüüÁâπÊÄßÔºâ
3ÊôÇ: ÂåªÂ≠¶Áü•Ë≠òÔºàÁñæÊÇ£„ÄÅÁóáÂÄô„ÄÅËñ¨ÁêÜ„ÄÅË©ï‰æ°Â∞∫Â∫¶„ÄÅÊ≤ªÁôÇÊ≥ï„ÅÆÁêÜË´ñÔºâ
4ÊôÇ: Ë®∫ÂØü„ÉªÊâãÊäÄÔºàÂïèË®∫„ÄÅË∫´‰ΩìË®∫ÂØü„ÄÅÊ§úÊüªÊâãÊäÄ„ÄÅÊÉÖÂ†±ÂèéÈõÜÔºâ
5ÊôÇ: ÊÇ£ËÄÖ„Å´ÂØæ„Åô„ÇãÂïèÈ°åËß£Ê±∫ËÉΩÂäõÔºà„Ç¢„Çª„Çπ„É°„É≥„Éà„ÄÅÊ≤ªÁôÇÊñπÈáùÊ±∫ÂÆö„ÄÅÁ≥ªÁµ±ÁöÑ„Ç¢„Éó„É≠„Éº„ÉÅÔºâ
6ÊôÇ: Áµ±ÂêàÁöÑËá®Â∫äÔºàËá®Â∫ä„Å´Èñ¢„Åô„ÇãË§áÊï∞„ÅÆ‰ªñÂàÜÈ°ûË¶ÅÁ¥†„ÇíÂê´„Åø„ÄÅÁµ±ÂêàÁöÑ„Å´ËÄÉÂØü„Åï„Çå„Å¶„ÅÑ„ÇãÂÜÖÂÆπÔºâ
7ÊôÇ: Â§öËÅ∑Á®ÆÈÄ£Êê∫Ôºà„ÉÅ„Éº„É†ÂåªÁôÇ„ÄÅÈô¢ÂÜÖÈÄ£Êê∫Ôºâ
8ÊôÇ: „Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥ÔºàÂÇæËÅ¥„ÄÅÂÖ±ÊÑü„ÄÅË™¨Êòé„ÄÅ‰ø°È†ºÈñ¢‰øÇÊßãÁØâÔºâ
9ÊôÇ: ‰∏ÄËà¨ÊïôÈ§äÔºàÂåªÂ≠¶‰ª•Â§ñ„ÅÆÁü•Ë≠òÔºâ
10ÊôÇ: ‰øùÂÅ•„ÉªÁ¶èÁ•âÔºàÁ§æ‰ºöÁöÑ„Çµ„Éù„Éº„Éà„ÄÅÁ¶èÁ•âÂà∂Â∫¶„ÄÅ‰ªãË≠∑Ôºâ
11ÊôÇ: Ë°åÊîøÔºàÁóÖÈô¢ÈñìÈÄ£Êê∫„ÄÅÁ¥π‰ªãÔºâ
12ÊôÇ: Á§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîüÔºàÁóÖÈô¢Â§ñ„ÅÆ‰∫ãÈ†Ö„Å´Èñ¢„Åô„ÇãË§áÊï∞„ÅÆ‰ªñÂàÜÈ°ûË¶ÅÁ¥†„ÇíÂê´„Åø„ÄÅÁµ±ÂêàÁöÑ„Å´ËÄÉÂØü„Åï„Çå„Å¶„ÅÑ„ÇãÂÜÖÂÆπÔºâ

„ÄêÂàÜÈ°û‰æã„Äë
- „ÄåÊÇ£ËÄÖ„Å∏„ÅÆË™¨Êòé„Äç„Å†„Åë ‚Üí „Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥Ôºà8ÊôÇÔºâ
- „ÄåHAM-D„ÅÆ‰ΩøÁî®„Äç‚Üí ÂåªÂ≠¶Áü•Ë≠òÔºà3ÊôÇÔºâ
- „ÄåÁ≥ªÁµ±ÁöÑ„Å™ÂïèË®∫ÊñπÊ≥ï„Äç‚Üí ÂïèÈ°åËß£Ê±∫ËÉΩÂäõÔºà5ÊôÇÔºâ
- „ÄåËñ¨„ÅÆÁü•Ë≠ò„ÇíÊÇ£ËÄÖ„Å´„Çè„Åã„Çä„ÇÑ„Åô„ÅèË™¨Êòé„Åó„ÄÅÂÇæËÅ¥„Åó„Å™„Åå„Çâ‰ø°È†ºÈñ¢‰øÇ„ÇíÊßãÁØâ„Äç‚Üí Áµ±ÂêàÁöÑËá®Â∫äÔºà6ÊôÇÔºâ
- „ÄåÂú∞Âüü„ÅÆÁ¶èÁ•âÂà∂Â∫¶„Å®ÂåªÁôÇÈÄ£Êê∫„ÇíË∏è„Åæ„Åà„ÅüÈÄÄÈô¢ÊîØÊè¥„Äç‚Üí Á§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîüÔºà12ÊôÇÔºâ

„ÄêÈáçË¶Å„Äë
- Áµ±ÂêàÁöÑËá®Â∫äÔºà6ÊôÇÔºâÔºöËá®Â∫äÂ†¥Èù¢„ÅßË§áÊï∞„Ç´„ÉÜ„Ç¥„É™„ÅÆË¶ÅÁ¥†„ÅåÁµ±Âêà„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„Åø
- Á§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîüÔºà12ÊôÇÔºâÔºöÁóÖÈô¢Â§ñ„ÉªÂú∞Âüü„Å´Èñ¢„Åô„ÇãË§áÊï∞Ë¶ÅÁ¥†„ÅåÁµ±Âêà„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅÆ„Åø
- Âçò‰∏ÄË¶ÅÁ¥†„ÅÆË®òËø∞„ÅØË©≤ÂΩì„Åô„ÇãÂÄãÂà•„Ç´„ÉÜ„Ç¥„É™„Å´ÂàÜÈ°û

‰ª•‰∏ã„ÅÆJSONÂΩ¢Âºè„ÅßÂõûÁ≠î„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÂøÖ„ÅöJSONÂΩ¢Âºè„ÅßËøîÁ≠î„Åô„Çã„Åì„Å®„ÅåÈáçË¶Å„Åß„Åô:
{
  "elements": [
    {
      "content": "Ë¶ÅÁ¥†„ÅÆÂÜÖÂÆπÔºà„Å©„ÅÆÈÉ®ÂàÜ„Åã„ÇâÊäΩÂá∫„Åó„Åü„ÅãÊòéË®òÔºâ",
      "category": Êï∞ÂÄ§(0-12),
      "weight": Êï∞ÂÄ§(0.1-1.0),
      "reason": "ÂàÜÈ°ûÁêÜÁî±"
    }
  ],
  "primary_category": Êï∞ÂÄ§(0-12),
  "total_elements": Ë¶ÅÁ¥†Êï∞
}`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [{ role: 'user', content: prompt }],
                        temperature: 0.3,
                        response_format: { type: "json_object" }
                    })
                });

                if (!response.ok) {
                    throw new Error('API request failed');
                }

                const data = await response.json();
                const result = JSON.parse(data.choices[0].message.content);
                
                return result;
            } catch (error) {
                console.error('Ë¶ÅÁ¥†ÂàÜËß£„Ç®„É©„Éº:', error);
                return null;
            }
        }
        
        // === ÂÄã‰∫∫ÊÉÖÂ†±„ÉÅ„Çß„ÉÉ„ÇØÊ©üËÉΩ ===
        const PERSONAL_INFO_CHECK_PROMPT = `‰ª•‰∏ã„ÅÆÂåªÂ≠¶ÂÆüÁøíË®òÈå≤„ÉÜ„Ç≠„Çπ„Éà„Å´„ÄÅÊÇ£ËÄÖ„ÇíÁâπÂÆö„Åß„Åç„ÇãÂÄã‰∫∫ÊÉÖÂ†±„ÅåÂê´„Åæ„Çå„Å¶„ÅÑ„Çã„Åã„ÉÅ„Çß„ÉÉ„ÇØ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

„ÄêÊ§úÂá∫ÂØæË±° - Ë≠¶Âëä„ÅåÂøÖË¶Å„Äë
- „Éï„É´„Éç„Éº„É†ÔºàÁî∞‰∏≠Â§™ÈÉé„ÄÅ‰ΩêËó§Ëä±Â≠ê„ÄÅÂ±±Áî∞‰∏ÄÈÉé„Å™„Å©Ôºâ
- ÁîüÂπ¥ÊúàÊó•Ôºà1980Âπ¥3Êúà15Êó•„ÄÅÊò≠Âíå55Âπ¥Áîü„Åæ„Çå„Å™„Å©Ôºâ
- ‰ΩèÊâÄ„ÅÆË©≥Á¥∞ÔºàÊù±‰∫¨ÈÉΩÊñ∞ÂÆøÂå∫‚óã‚óãÁî∫1-2-3„Å™„Å©Ôºâ
- ÈõªË©±Áï™Âè∑Ôºà090-1234-5678„Å™„Å©Ôºâ

„ÄêË®±ÂÆπÂØæË±° - Ë≠¶Âëä‰∏çË¶Å„Äë
- Âπ¥ÈΩ¢„ÉªÊÄßÂà•Ôºà75Ê≠≥Áî∑ÊÄß„ÄÅ60‰ª£Â•≥ÊÄß„Å™„Å©Ôºâ
- „Ç§„Éã„Ç∑„É£„É´ÔºàA.K„Åï„Çì„ÄÅT.SÊßò„Å™„Å©Ôºâ
- ÂåªÂ≠¶Áî®Ë™û„ÅÆÂõ∫ÊúâÂêçË©ûÔºàÂ∑ùÂ¥éÁóÖ„ÄÅËèäÊ±†ÁóÖ„ÄÅJohnsonÂàÜÈ°û„ÄÅCrohnÁóÖ„ÄÅParkinsonÁóÖ„Å™„Å©Ôºâ
- ÁóáÁä∂„ÇÑÊâÄË¶ã„ÅÆË®òËø∞
- ÁóÖÈô¢ÂÜÖ„ÅÆÂ†¥ÊâÄÔºà3ÈöéÁóÖÊ£ü„ÄÅÂ§ñÊù•„Å™„Å©Ôºâ

„ÉÜ„Ç≠„Çπ„Éà: "{{INPUT_TEXT}}"

‰ª•‰∏ã„ÅÆJSONÂΩ¢Âºè„ÅßÂõûÁ≠î„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
{
  "hasPersonalInfo": true/false,
  "detectedItems": ["Ê§úÂá∫„Åï„Çå„ÅüÈ†ÖÁõÆ1", "Ê§úÂá∫„Åï„Çå„ÅüÈ†ÖÁõÆ2"],
  "reason": "Ê§úÂá∫ÁêÜÁî±„ÅÆË™¨Êòé",
  "suggestion": "‰øÆÊ≠£ÊèêÊ°àÔºà„ÅÇ„Çå„Å∞Ôºâ"
}`;

        /**
         * ÂÄã‰∫∫ÊÉÖÂ†±„ÉÅ„Çß„ÉÉ„ÇØ
         */
        async function checkPersonalInformation(inputText) {
            try {
                // OpenAI API„Åß„ÉÅ„Çß„ÉÉ„ÇØ
                const prompt = PERSONAL_INFO_CHECK_PROMPT.replace('{{INPUT_TEXT}}', inputText);
                
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            {
                                role: 'system',
                                content: '„ÅÇ„Å™„Åü„ÅØÂåªÂ≠¶ÊïôËÇ≤„Å´„Åä„Åë„ÇãÂÄã‰∫∫ÊÉÖÂ†±‰øùË≠∑„ÅÆÂ∞ÇÈñÄÂÆ∂„Åß„Åô„ÄÇÂÆüÁøíË®òÈå≤„Åã„ÇâÊÇ£ËÄÖ„ÇíÁâπÂÆö„Åß„Åç„ÇãÊÉÖÂ†±„ÇíÊ≠£Á¢∫„Å´Ê§úÂá∫„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        temperature: 0.1,
                        max_tokens: 500
                    })
                });

                const data = await response.json();
                const result = JSON.parse(data.choices[0].message.content);
                
                return {
                    success: true,
                    ...result
                };
                
            } catch (error) {
                console.error('ÂÄã‰∫∫ÊÉÖÂ†±„ÉÅ„Çß„ÉÉ„ÇØ„Ç®„É©„Éº:', error);
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºöÂü∫Êú¨ÁöÑ„Å™„É´„Éº„É´„Éô„Éº„Çπ„ÉÅ„Çß„ÉÉ„ÇØ
                return performBasicPersonalInfoCheck(inputText);
            }
        }

        /**
         * „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºöÂü∫Êú¨ÁöÑ„Å™„É´„Éº„É´„Éô„Éº„Çπ„ÉÅ„Çß„ÉÉ„ÇØ
         */
        function performBasicPersonalInfoCheck(inputText) {
            const detectedItems = [];
            
            // ÁîüÂπ¥ÊúàÊó•„Éë„Çø„Éº„É≥
            const datePatterns = [
                /\d{4}Âπ¥\d{1,2}Êúà\d{1,2}Êó•/g,
                /Êò≠Âíå\d{1,2}Âπ¥/g,
                /Âπ≥Êàê\d{1,2}Âπ¥/g,
                /\d{4}\/\d{1,2}\/\d{1,2}/g
            ];
            
            datePatterns.forEach(pattern => {
                if (pattern.test(inputText)) {
                    detectedItems.push('ÁîüÂπ¥ÊúàÊó•„ÅÆÂèØËÉΩÊÄß');
                }
            });
            
            // „Éï„É´„Éç„Éº„É†„ÅÆÂèØËÉΩÊÄßÔºàËãóÂ≠ó+ÂêçÂâç„ÅÆÁµÑ„ÅøÂêà„Çè„ÅõÔºâ
            const namePattern = /[‰∏Ä-ÈæØ]{1,4}[‰∏Ä-ÈæØ]{1,4}[„Åï„Çì|Êßò|Ê∞è|Âêõ]/g;
            if (namePattern.test(inputText)) {
                detectedItems.push('„Éï„É´„Éç„Éº„É†„ÅÆÂèØËÉΩÊÄß');
            }
            
            return {
                success: true,
                hasPersonalInfo: detectedItems.length > 0,
                detectedItems: detectedItems,
                reason: detectedItems.length > 0 ? '„É´„Éº„É´„Éô„Éº„ÇπÊ§úÂá∫' : 'ÂïèÈ°å„Å™„Åó',
                suggestion: detectedItems.length > 0 ? 'Âπ¥ÈΩ¢„ÉªÊÄßÂà•„Åß„ÅÆË®òËø∞„Çí„ÅäÂãß„ÇÅ„Åó„Åæ„Åô' : ''
            };
        }

        /**
         * „Ç¢„É©„Éº„ÉàË°®Á§∫Ê©üËÉΩ
         */
        function showPersonalInfoAlert(checkResult) {
            return new Promise((resolve) => {
                // „Ç¢„É©„Éº„ÉàHTMLÁîüÊàê
                const alertHTML = `
                    <div id="personalInfoAlert" class="personal-info-alert">
                        <div class="alert-overlay"></div>
                        <div class="alert-modal">
                            <div class="alert-header">
                                <span class="alert-icon">üö®</span>
                                <h3>ÂÄã‰∫∫ÊÉÖÂ†±„ÉÅ„Çß„ÉÉ„ÇØ</h3>
                            </div>
                            <div class="alert-content">
                                <p><strong>‰ª•‰∏ã„ÅÆÂÜÖÂÆπ„ÅåÊ§úÂá∫„Åï„Çå„Åæ„Åó„ÅüÔºö</strong></p>
                                <ul>
                                    ${checkResult.detectedItems.map(item => `<li>${item}</li>`).join('')}
                                </ul>
                                <p class="alert-reason">${checkResult.reason}</p>
                                ${checkResult.suggestion ? `
                                    <div class="alert-suggestion">
                                        <strong>üìù ‰øÆÊ≠£ÊèêÊ°àÔºö</strong><br>
                                        ${checkResult.suggestion}
                                    </div>
                                ` : ''}
                            </div>
                            <div class="alert-actions">
                                <button id="editButton" class="alert-btn edit-btn">‚úèÔ∏è ‰øÆÊ≠£„Åô„Çã</button>
                                <button id="continueButton" class="alert-btn continue-btn">‚û°Ô∏è „Åì„ÅÆ„Åæ„ÅæÁ∂öË°å</button>
                            </div>
                        </div>
                    </div>
                `;
                
                // „Ç¢„É©„Éº„Éà„ÇíDOM„Å´ËøΩÂä†
                document.body.insertAdjacentHTML('beforeend', alertHTML);
                
                // „Ç§„Éô„É≥„Éà„É™„Çπ„Éä„ÉºË®≠ÂÆö
                document.getElementById('editButton').addEventListener('click', () => {
                    removeAlert();
                    resolve(false); // ‰øÆÊ≠£„ÇíÈÅ∏Êäû
                });
                
                document.getElementById('continueButton').addEventListener('click', () => {
                    removeAlert();
                    resolve(true); // Á∂öË°å„ÇíÈÅ∏Êäû
                });
                
                // „Ç™„Éº„Éê„Éº„É¨„Ç§„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
                document.querySelector('.alert-overlay').addEventListener('click', () => {
                    removeAlert();
                    resolve(false);
                });
            });
        }

        /**
         * „Ç¢„É©„Éº„ÉàÂâäÈô§
         */
        function removeAlert() {
            const alert = document.getElementById('personalInfoAlert');
            if (alert) {
                alert.remove();
            }
        }

        /**
         * „É≠„Éº„Éá„Ç£„É≥„Ç∞„Ç§„É≥„Ç∏„Ç±„Éº„Çø„ÉºË°®Á§∫
         */
        function showLoadingIndicator(message) {
            const indicator = document.createElement('div');
            indicator.id = 'loadingIndicator';
            indicator.className = 'loading-indicator';
            indicator.innerHTML = `
                <div class="loading-spinner"></div>
                <span>${message}</span>
            `;
            document.body.appendChild(indicator);
        }

        /**
         * „É≠„Éº„Éá„Ç£„É≥„Ç∞„Ç§„É≥„Ç∏„Ç±„Éº„Çø„ÉºÈùûË°®Á§∫
         */
        function hideLoadingIndicator() {
            const indicator = document.getElementById('loadingIndicator');
            if (indicator) {
                indicator.remove();
            }
        }

        // === 12ÊôÇË®àAIÂàÜÈ°ûÈñ¢Êï∞ÔºàÂçò‰∏ÄÂàÜÈ°ûÔºâ ===
        async function classifyWithAI(recordText) {
            // API„Ç≠„Éº„ÉÅ„Çß„ÉÉ„ÇØ
            checkApiKey();
            if (!OPENAI_API_KEY) {
                throw new Error('API„Ç≠„Éº„ÅåË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
            }
            
            try {
                const prompt = `ÂåªÂ≠¶Áîü„ÅÆÂÆüÁøíË®òÈå≤„Çí2„Å§„ÅÆÁã¨Á´ã„Åó„ÅüÊñπÊ≥ï„ÅßÂàÜÊûê„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

Ë®òÈå≤: "${recordText}"

„Äê„Çø„Çπ„ÇØ1: 12ÊôÇË®àÂàÜÈ°û„Äë
‰ª•‰∏ã„ÅÆ13„Ç´„ÉÜ„Ç¥„É™„Åã„ÇâÊúÄ„ÇÇÈÅ©Âàá„Å™„ÇÇ„ÅÆ„Çí1„Å§ÈÅ∏„Çì„Åß„Åè„Å†„Åï„ÅÑÔºö

0ÊôÇ: ÂàÜÈ°û‰∏çËÉΩÔºàÂåªÂ≠¶ÂÆüÁøí„Å®„ÅÆÈñ¢ÈÄ£„Åå‰∏çÊòéÁ¢∫„ÄÅÊÑèÂõ≥„ÅåË™≠„ÅøÂèñ„Çå„Å™„ÅÑÔºâ
1ÊôÇ: ÂåªÁôÇÂÄ´ÁêÜÔºàÂÄ´ÁêÜ„ÄÅÊ≥ïÂæã„ÄÅË¶èÁØÑÔºâ
2ÊôÇ: Âú∞ÂüüÂåªÁôÇÔºàË®™ÂïèË®∫ÁôÇ„ÄÅÂú®ÂÆÖÂåªÁôÇ„ÄÅÂú∞ÂüüÁâπÊÄßÔºâ
3ÊôÇ: ÂåªÂ≠¶Áü•Ë≠òÔºàÁñæÊÇ£„ÄÅÁóáÂÄô„ÄÅÂü∫Á§éÂåªÂ≠¶Ôºâ
4ÊôÇ: Ë®∫ÂØü„ÉªÊâãÊäÄÔºàË®∫ÂØü„Çπ„Ç≠„É´„ÄÅÊ§úÊüªÊâãÊäÄÔºâ
5ÊôÇ: ÊÇ£ËÄÖ„Å´ÂØæ„Åô„ÇãÂïèÈ°åËß£Ê±∫ËÉΩÂäõÔºàÂÄãÂà•ÂØæÂøú„ÄÅÊ≤ªÁôÇÊñπÈáùÊ±∫ÂÆöÔºâ
6ÊôÇ: Áµ±ÂêàÁöÑËá®Â∫äÔºàËá®Â∫äËÉΩÂäõ„ÅÆÁµ±ÂêàÔºâ
7ÊôÇ: Â§öËÅ∑Á®ÆÈÄ£Êê∫Ôºà„ÉÅ„Éº„É†ÂåªÁôÇ„ÄÅÈô¢ÂÜÖÈÄ£Êê∫Ôºâ
8ÊôÇ: „Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥ÔºàÂØæ‰∫∫ËÉΩÂäõÔºâ
9ÊôÇ: ‰∏ÄËà¨ÊïôÈ§äÔºàÂåªÂ≠¶‰ª•Â§ñ„ÅÆÁü•Ë≠òÔºâ
10ÊôÇ: ‰øùÂÅ•„ÉªÁ¶èÁ•âÔºà‰ªãË≠∑„ÄÅ‰øùÂÅ•‰∫ãÊ•≠Ôºâ
11ÊôÇ: Ë°åÊîøÔºàÁóÖÈô¢ÈñìÈÄ£Êê∫„ÄÅÁ¥π‰ªãÔºâ
12ÊôÇ: Á§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîüÔºàÁ§æ‰ºöÂåªÂ≠¶„ÅÆÁµ±ÂêàÔºâ

‚Äª„ÄåÁ©∫„ÅåÈùí„Åã„Å£„Åü„Äç„ÅÆ„Çà„ÅÜ„Å™Ë®òÈå≤„ÅßÂåªÂ≠¶ÂÆüÁøí„Å®„ÅÆÈñ¢ÈÄ£„Åå‰∏çÊòé„Å™Â†¥Âêà„ÅØ0ÊôÇ„ÇíÈÅ∏Êäû

„Äê„Çø„Çπ„ÇØ2: Ê∑±Â∫¶„Å®„Éô„ÇØ„Éà„É´Â∫ßÊ®ô„Äë
‰ª•‰∏ã„ÇíÁã¨Á´ã„Åó„Å¶Âà§ÂÆö„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö

Ê∑±Â∫¶Ôºà0-4Ôºâ:
0: Áü•„Çâ„Å™„ÅÑ
1: Áü•„Å£„Å¶„ÅÑ„ÇãÔºàÂêçÁß∞„É¨„Éô„É´Ôºâ
2: ÁêÜËß£„Åó„Å¶„ÅÑ„ÇãÔºàËÉåÊôØ„ÉªÂõ†ÊûúÈñ¢‰øÇÔºâ
3: Ë™¨Êòé„Åß„Åç„ÇãÔºàÂÜçÁèæÊÄß„ÅØ‰Ωé„ÅÑÔºâ
4: ÂÆöÁùÄ„Åó„Å¶„ÅÑ„ÇãÔºàÁµ±ÂêàÁöÑ„É¨„Éô„É´Ôºâ

Â∫ßÊ®ô:
xËª∏Ôºà-1.0„Äú1.0Ôºâ: -1=non-technical skill ‚Üê ‚Üí +1=technical skill
yËª∏Ôºà-1.0„Äú1.0Ôºâ: -1=Ëá®Â∫äÔºà„Éô„ÉÉ„Éâ„Çµ„Ç§„ÉâÔºâ ‚Üê ‚Üí +1=Âú∞Âüü„ÉªÁ§æ‰ºö

‰ª•‰∏ã„ÅÆJSONÂΩ¢Âºè„ÅßÂõûÁ≠î„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇJSON„Ç™„Éñ„Ç∏„Çß„ÇØ„Éà„Å®„Åó„Å¶Ê≠£Á¢∫„Å´ÂõûÁ≠î„Åô„Çã„Åì„Å®„ÅåÂøÖË¶Å„Åß„Åô:
{
  "clock_category": Êï∞ÂÄ§(0-12),
  "clock_reason": "ÂàÜÈ°ûÁêÜÁî±",
  "depth": Êï∞ÂÄ§(0-4),
  "depth_reason": "Ê∑±Â∫¶Âà§ÂÆöÁêÜÁî±",
  "vector": {
    "x": Êï∞ÂÄ§(-1.0„Äú1.0),
    "y": Êï∞ÂÄ§(-1.0„Äú1.0)
  },
  "vector_reason": "Â∫ßÊ®ôÂà§ÂÆöÁêÜÁî±"
}`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [{ role: 'user', content: prompt }],
                        temperature: 0.3,
                        response_format: { type: "json_object" }
                    })
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    console.error('APIË©≥Á¥∞„Ç®„É©„Éº:', errorData);
                    throw new Error(`API request failed: ${response.status} - ${errorData.error?.message || 'Unknown error'}`);
                }

                const data = await response.json();
                const result = JSON.parse(data.choices[0].message.content);
                
                // Êï¥ÂêàÊÄß„ÉÅ„Çß„ÉÉ„ÇØ
                let consistency_score = 100;
                if (result.clock_category === 0) {
                    // ÂàÜÈ°û‰∏çËÉΩ„ÅÆÂ†¥Âêà„ÅØÊï¥ÂêàÊÄß„ÉÅ„Çß„ÉÉ„ÇØ„Çí„Çπ„Ç≠„ÉÉ„Éó
                    consistency_score = 0; // Êï¥ÂêàÊÄß„ÅØË©ï‰æ°‰∏çËÉΩ
                } else {
                    const expectedVector = CLOCK_CATEGORIES[result.clock_category].vector;
                    const deviation = {
                        x: Math.abs(expectedVector.x - result.vector.x),
                        y: Math.abs(expectedVector.y - result.vector.y)
                    };
                    consistency_score = 100 - (deviation.x + deviation.y) * 50;
                }
                
                return {
                    category: result.clock_category,
                    confidence: Math.max(50, consistency_score),
                    reason: result.clock_reason,
                    depth: result.depth,
                    vector: result.vector,
                    consistency: consistency_score > 70
                };
            } catch (error) {
                console.error('AIÂàÜÈ°û„Ç®„É©„Éº:', error);
                alert('AIÂàÜÈ°û„Ç®„É©„Éº: ' + error.message);
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ
                return {
                    category: 7,
                    confidence: 50,
                    reason: 'AIÂàÜÈ°û„Å´Â§±Êïó„Åó„Åæ„Åó„Åü',
                    depth: 1,
                    vector: {x: 0, y: 0},
                    consistency: false
                };
            }
        }
        
        // === ÁµåÈ®ìÂÄ§Ë°®Á§∫Êõ¥Êñ∞ ===
        function updateExpDisplay() {
            // Ë®òÈå≤ÂõûÊï∞Êõ¥Êñ∞
            let recordCount;
            if (currentDay === 'practice') {
                // Á∑¥ÁøíÁî®„ÅÆÂ†¥Âêà„ÅØË®òÈå≤Êï∞„ÇíË°®Á§∫„Åó„Å™„ÅÑÔºà0Âõ∫ÂÆöÔºâ
                recordCount = 0;
            } else {
                recordCount = records.filter(r => r.day === currentDay).length;
            }
            DOM.recordCount.forEach(el => el.textContent = recordCount);
            
            // „É¨„Éô„É´Êõ¥Êñ∞
            DOM.userLevel.forEach(el => el.textContent = userLevel);
            
            // ÁµåÈ®ìÂÄ§„Éê„ÉºÊõ¥Êñ∞ÔºàÈö†„Åó„Éë„É©„É°„Éº„Çø„Å®„Åó„Å¶Âãï‰ΩúÔºâ
            const expPercent = (userExp / 100) * 100;
            DOM.expBar.forEach(el => el.style.width = expPercent + '%');
            
            // „Éá„Éê„ÉÉ„Ç∞Áî®Ôºà„Ç≥„É≥„ÇΩ„Éº„É´„ÅßÁ¢∫Ë™çÂèØËÉΩÔºâ
            console.log(`Level: ${userLevel}, EXP: ${userExp}/100, Posts: ${totalPosts}`);
        }

        function updateAllViews() {
            updateRecordsList();
            updateOrganizedView();
            updateStatistics();
            updateExpDisplay();
        }

        // === ÁèæÂú®„ÅÆÊó•‰ªò„ÅÆË®òÈå≤„ÇíÂèñÂæó ===
        function getCurrentDayRecords() {
            return records.filter(record => record.day === currentDay);
        }

        // === Ë®òÈå≤„É™„Çπ„ÉàÊõ¥Êñ∞Ôºà„É¢„Éã„Çø„Éº1Ôºâ ===
        function updateRecordsList() {
            const recordsList = document.getElementById('recordsList');
            const dayRecords = getCurrentDayRecords();
            
            if (dayRecords.length === 0) {
                recordsList.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">üìù</div>
                        <p>„Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì<br>‰∏ã„ÅÆ„Éï„Ç©„Éº„É†„Åã„ÇâÊúÄÂàù„ÅÆË®òÈå≤„ÇíËøΩÂä†„Åó„Å¶„Åè„Å†„Åï„ÅÑ</p>
                    </div>
                `;
                return;
            }

            const html = dayRecords.map(record => {
                const category = AI_CATEGORIES[record.category] || AI_CATEGORIES.other;
                const timeStr = record.timestamp.toLocaleString('ja-JP', {
                    month: 'short',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                // Ë§áÊï∞Ë¶ÅÁ¥†„ÅÆË°®Á§∫
                let categoryDisplay = category.name;
                if (record.multipleElements && record.multipleElements.length > 1) {
                    const uniqueCategories = [...new Set(record.multipleElements.map(e => e.category))];
                    categoryDisplay = `${category.name} +${uniqueCategories.length - 1}Ë¶ÅÁ¥†`;
                }

                return `
                    <div class="record-item" data-id="${record.id}">
                        <div class="record-header">
                            <div class="record-header-left">
                                <div class="record-timestamp">${timeStr}</div>
                                <span class="record-category">${categoryDisplay}</span>
                            </div>
                            <div class="record-actions">
                                <button class="record-btn edit-btn" onclick="editRecord(${record.id})" title="Á∑®ÈõÜ">
                                    ‚úíÔ∏è
                                </button>
                                <button class="record-btn delete-btn" onclick="deleteRecord(${record.id})" title="ÂâäÈô§">
                                    üóëÔ∏è
                                </button>
                            </div>
                        </div>
                        <div class="record-text">${record.originalText}</div>
                    </div>
                `;
            }).join('');

            recordsList.innerHTML = html;
        }

        // === Êï¥ÁêÜ„Éì„É•„ÉºÊõ¥Êñ∞Ôºà„É¢„Éã„Çø„Éº2Ôºâ ===
        function updateOrganizedView() {
            const organizedView = document.getElementById('organizedView');
            const dayRecords = getCurrentDayRecords();
            
            if (dayRecords.length === 0) {
                organizedView.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ü§ñ</div>
                        <p>Ë®òÈå≤„ÇíËøΩÂä†„Åô„Çã„Å®<br>AIÂàÜÊûê„Å´„Çà„Çã12ÊôÇË®àÂàÜÈ°û„ÅåË°®Á§∫„Åï„Çå„Åæ„Åô</p>
                    </div>
                `;
                return;
            }

            // 12ÊôÇË®à„Ç´„ÉÜ„Ç¥„É™Âà•„Å´Ë¶ÅÁ¥†„ÇíÈõÜË®à
            const categoryElements = {};
            for (let i = 0; i <= 12; i++) {
                categoryElements[i] = [];
            }
            
            // ÈáçË§á„ÉÅ„Çß„ÉÉ„ÇØÁî®„ÅÆ„Éû„ÉÉ„Éó
            const uniqueElements = new Map();
            
            dayRecords.forEach(record => {
                // Èï∑ÊñáË®òÈå≤„ÅßË§áÊï∞Ë¶ÅÁ¥†„Åå„ÅÇ„ÇãÂ†¥Âêà
                if (record.multipleElements && record.multipleElements.length > 0) {
                    record.multipleElements.forEach(elem => {
                        const key = `${elem.category}-${elem.content.toLowerCase().trim()}`;
                        if (!uniqueElements.has(key)) {
                            uniqueElements.set(key, true);
                            categoryElements[elem.category].push({
                                recordId: record.id,
                                originalText: record.originalText,
                                elementContent: elem.content,
                                elementReason: elem.reason,
                                weight: Math.max(1, Math.round(elem.weight)),
                                timestamp: record.timestamp
                            });
                        }
                    });
                } else {
                    // Áü≠ÊñáË®òÈå≤„ÅÆÂ†¥ÂêàÔºàÂæìÊù•ÈÄö„ÇäÔºâ
                    const category = record.category || 0;
                    const key = `${category}-${record.originalText.toLowerCase().trim()}`;
                    if (!uniqueElements.has(key)) {
                        uniqueElements.set(key, true);
                        categoryElements[category].push({
                            recordId: record.id,
                            originalText: record.originalText,
                            elementContent: record.originalText,
                            elementReason: record.aiReason,
                            weight: 1,
                            timestamp: record.timestamp
                        });
                    }
                }
            });
            
            // HTMLÁîüÊàê
            let html = '';
            for (let categoryId = 0; categoryId <= 12; categoryId++) {
                const elements = categoryElements[categoryId];
                if (elements.length === 0) continue;
                
                const category = AI_CATEGORIES[categoryId] || AI_CATEGORIES[0];
                const totalPoints = elements.reduce((sum, elem) => sum + elem.weight, 0);
                
                html += `
                    <div class="category-section">
                        <div class="category-header">
                            ${category.name} (${totalPoints}pt)
                        </div>
                        <div class="category-content">
                            ${elements.map((elem, index) => {
                                // ÂÖ±ÊúâÊ∏à„Åø„Åã„ÉÅ„Çß„ÉÉ„ÇØ
                                const isShared = sharedLearnings.some(learning => 
                                    learning.text === elem.elementContent && 
                                    learning.userId === (currentUser ? currentUser.id : 'anonymous')
                                );
                                
                                return `
                                    <div class="category-item">
                                        <div class="element-display">
                                            <div class="element-text">${elem.elementContent}</div>
                                            <div style="display: flex; gap: 8px; align-items: center;">
                                                ${isDeveloperMode ? (isShared ? `
                                                    <span style="color: rgba(76, 175, 80, 0.6); font-size: 0.9rem;">‚úÖ ÂÖ±ÊúâÊ∏à„Åø</span>
                                                ` : `
                                                    <span class="share-icon dev-only" onclick="quickShareLearning(${categoryId}, '${elem.elementContent.replace(/'/g, "\\'")}', '${elem.elementReason ? elem.elementReason.replace(/'/g, "\\'") : ''}')" title="ÈñãÁô∫„É¢„Éº„Éâ: „É≠„Éº„Ç´„É´ÂÖ±Êúâ„ÅÆ„Åø" style="cursor: pointer; font-size: 1.1rem; opacity: 0.5;">
                                                        üì§
                                                    </span>
                                                `) : ''}
                                            </div>
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
            }
            
            organizedView.innerHTML = html || '<div class="empty-state"><p>ÂàÜÈ°û„Åï„Çå„ÅüË¶ÅÁ¥†„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</p></div>';
            
            // „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥„Éú„Çø„É≥„ÇíÂÜçËøΩÂä†ÔºàÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„ÅÆ„ÅøÔºâ
            if (isDeveloperMode) {
                const btnArea = document.getElementById('sharedLearningBtnArea');
                if (!btnArea) {
                    organizedView.innerHTML += `
                        <div id="sharedLearningBtnArea" class="dev-only" style="text-align: center; margin-top: 30px; padding: 20px 0;">
                            <button class="shared-learning-btn" onclick="toggleSharedLearning()" style="background: linear-gradient(135deg, rgba(255, 107, 107, 0.3) 0%, rgba(254, 202, 87, 0.3) 100%); border: 2px dashed rgba(255, 107, 107, 0.5); padding: 15px 30px; border-radius: 30px; color: rgba(255, 255, 255, 0.8); font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transition: all 0.3s; display: inline-flex; align-items: center; gap: 10px; opacity: 0.7;" title="ÈñãÁô∫„É¢„Éº„Éâ: „É≠„Éº„Ç´„É´„Éá„É¢Ê©üËÉΩ">
                                <span style="font-size: 24px; position: relative; opacity: 0.6;">
                                    <span style="position: absolute; left: -8px; top: -5px; opacity: 0.5;">üí¨</span>
                                    <span style="position: absolute; left: 5px; top: -8px; opacity: 0.6;">üí¨</span>
                                    <span style="position: relative;">üí¨</span>
                                </span>
                                <span style="font-size: 16px;">„Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ <span style="font-size: 0.8em; opacity: 0.7;">(Demo)</span></span>
                            </button>
                        </div>
                    `;
                }
            }
        }

        // === Áµ±Ë®àÊõ¥Êñ∞ ===
        function updateStatistics() {
            // Âü∫Êú¨Áµ±Ë®à
            document.getElementById('totalRecords').textContent = records.length;
            
            // ‰ªäÊó•„ÅÆË®òÈå≤Êï∞
            const today = new Date().toDateString();
            const todayCount = records.filter(r => r.timestamp.toDateString() === today).length;
            document.getElementById('todayRecords').textContent = todayCount;
            
            // AIÂá¶ÁêÜÊ∏à„ÅøÊï∞
            const aiCount = records.filter(r => r.aiProcessed).length;
            document.getElementById('aiProcessed').textContent = aiCount;

            // „Ç´„ÉÜ„Ç¥„É™Êï∞
            const uniqueCategories = new Set(records.map(r => r.category)).size;
            document.getElementById('categoryCount').textContent = uniqueCategories;

            // Âπ≥Âùá‰ø°È†ºÂ∫¶
            if (records.length > 0) {
                const avgConfidence = Math.round(
                    records.reduce((sum, r) => sum + r.confidence, 0) / records.length
                );
                document.getElementById('avgConfidence').textContent = avgConfidence + '%';
            }
        }

        // === Ë®òÈå≤Á∑®ÈõÜ ===
        function editRecord(recordId) {
            const record = records.find(r => r.id === recordId);
            if (!record) return;

            const recordElement = document.querySelector(`[data-id="${recordId}"]`);
            const textElement = recordElement.querySelector('.record-text');
            
            // Á∑®ÈõÜ„É¢„Éº„Éâ„Å´Âàá„ÇäÊõø„Åà
            recordElement.classList.add('edit-mode');
            textElement.innerHTML = `
                <textarea class="edit-textarea">${record.originalText}</textarea>
                <div class="edit-actions">
                    <button class="record-btn save-btn" onclick="saveRecord(${recordId})" title="‰øùÂ≠ò">‚úì</button>
                    <button class="record-btn cancel-btn" onclick="cancelEdit(${recordId})" title="„Ç≠„É£„É≥„Çª„É´">√ó</button>
                </div>
            `;
        }

        // === Ë®òÈå≤‰øùÂ≠ò ===
        function saveRecord(recordId) {
            const record = records.find(r => r.id === recordId);
            if (!record) return;

            const recordElement = document.querySelector(`[data-id="${recordId}"]`);
            const textarea = recordElement.querySelector('.edit-textarea');
            const newText = textarea.value.trim();

            if (newText) {
                record.originalText = newText;
                updateAllViews();
                showStatus('‚úÖ Ë®òÈå≤„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü„ÄÇ', 'success');
            }
        }

        // === Á∑®ÈõÜ„Ç≠„É£„É≥„Çª„É´ ===
        function cancelEdit(recordId) {
            updateAllViews();
        }

        // === Ë®òÈå≤ÂâäÈô§ ===
        function deleteRecord(recordId) {
            if (confirm('„Åì„ÅÆË®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åô„ÅãÔºü')) {
                records = records.filter(r => r.id !== recordId);
                updateAllViews();
                showStatus('üóëÔ∏è Ë®òÈå≤„ÇíÂâäÈô§„Åó„Åæ„Åó„Åü„ÄÇ', 'warning');
            }
        }

        // === AI„Å´„Çà„Çã„É¨„Éù„Éº„Éà„Åæ„Å®„ÇÅÁîüÊàê ===
        async function generateAISummary(dayRecords, categoryGroups) {
            try {
                // Ë®òÈå≤ÂÜÖÂÆπ„ÇíÊï¥ÁêÜ
                const recordTexts = dayRecords.map(r => r.originalText).join('\n');
                
                // „Ç´„ÉÜ„Ç¥„É™Âà•„ÅÆË®òÈå≤Êï∞„ÇíÈõÜË®à
                const categoryStats = [];
                let totalPoints = 0;
                for (const [categoryId, records] of Object.entries(categoryGroups)) {
                    const category = AI_CATEGORIES[categoryId];
                    const points = records.reduce((sum, record) => {
                        if (record.multipleElements) {
                            return sum + record.multipleElements.reduce((elemSum, elem) => 
                                elemSum + Math.max(1, Math.round(elem.weight)), 0);
                        }
                        return sum + 1;
                    }, 0);
                    totalPoints += points;
                    if (categoryId !== '0') { // ÂàÜÈ°û‰∏çËÉΩ„ÇíÈô§Â§ñ
                        categoryStats.push(`${category.name}: ${points}„Éù„Ç§„É≥„Éà`);
                    }
                }
                
                const prompt = `ÂåªÂ≠¶Áîü„ÅÆÂÆüÁøíË®òÈå≤„ÇíË™≠„Çì„Åß„ÄÅÊåáÂ∞éÂåª„Å®„Åó„Å¶Ëá™ÁÑ∂„ÅßÊ∏©„Åã„ÅÑ„Ç≥„É°„É≥„Éà„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇÊßãÈÄ†ÁöÑ„Å™„ÉÜ„É≥„Éó„É¨„Éº„Éà„ÅØ‰Ωø„Çè„Åö„ÄÅÂÆüÈöõ„ÅÆÊåáÂ∞éÂåª„ÅåÊõ∏„Åè„Çà„ÅÜ„Å™Ëá™ÁÑ∂„Å™ÊñáÁ´†„Åß„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ

‰ªäÊó•„ÅÆÂÆüÁøíÂÜÖÂÆπ:
${recordTexts}

Â≠¶Áøí„Ç´„ÉÜ„Ç¥„É™Âà•„ÅÆË®òÈå≤:
${categoryStats.join(', ')}

${currentDay === '5' ? 
`ÊúÄÁµÇÊó•„ÅÆÂÆüÁøí„ÇíÁµÇ„Åà„ÅüÂåªÂ≠¶Áîü„Å´Âêë„Åë„Å¶„ÄÅ‰ª•‰∏ã„ÅÆË¶≥ÁÇπ„ÇíÂê´„ÇÅ„Åü2-3ÊÆµËêΩ„ÅÆÁ∞°ÊΩî„Å™„Ç≥„É°„É≥„Éà„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑÔºö
- ‰ªäÊó•„ÅÆÂÆüÁøí„Å®ÂÖ®‰Ωì„ÇíÈÄö„Åó„Å¶„ÅÆÊàêÈï∑„ÇíË™ç„ÇÅ„Çã
- ÂÆüÁøíÂÖ®‰Ωì„ÇíÁ∑†„ÇÅ„Åè„Åè„ÇãÊ∏©„Åã„ÅÑ„É°„ÉÉ„Çª„Éº„Ç∏
- ‰ªäÂæå„ÅÆÂåªÁôÇËÄÖ„Å®„Åó„Å¶„ÅÆÈÅì„Å∏„ÅÆÊúüÂæÖÔºà1ÊñáÁ®ãÂ∫¶Ôºâ` :
`‰ªäÊó•„ÅÆÂÆüÁøí„Å´„Å§„ÅÑ„Å¶„ÄÅ‰ª•‰∏ã„ÅÆË¶≥ÁÇπ„ÇíÂê´„ÇÅ„Åü2-3ÊÆµËêΩ„ÅÆÁ∞°ÊΩî„Å™„Ç≥„É°„É≥„Éà„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑÔºö
- ‰ªäÊó•„ÅÆÂÆüÁøí„Åß„ÅÆÈ†ëÂºµ„Çä„ÇíË™ç„ÇÅ„Çã
- Áâπ„Å´Âç∞Ë±°ÁöÑ„Å†„Å£„ÅüÂ≠¶ÁøíÂÜÖÂÆπ„Å´„Å§„ÅÑ„Å¶Ëß¶„Çå„Çã
- Ê¨°„ÅÆÂÆüÁøí„Å∏„ÅÆÂä±„Åæ„ÅóÔºà1ÊñáÁ®ãÂ∫¶Ôºâ`}

ÂÆüÈöõ„ÅÆÊåáÂ∞éÂåª„ÅåÂåªÂ≠¶Áîü„Å´Â£∞„Çí„Åã„Åë„Çã„Çà„ÅÜ„Å™„ÄÅË¶™„Åó„Åø„ÇÑ„Åô„ÅèËá™ÁÑ∂„Å™Âè£Ë™øÔºà„Åß„Åô„Éª„Åæ„ÅôË™øÔºâ„Åß„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            {
                                role: 'system',
                                content: '„ÅÇ„Å™„Åü„ÅØÁµåÈ®ìË±äÂØå„Å™Ëá®Â∫äÊåáÂ∞éÂåª„Åß„Åô„ÄÇÂåªÂ≠¶Áîü„ÅÆÂÆüÁøíË®òÈå≤„ÇíË™≠„Çì„Åß„ÄÅÂÆüÈöõ„ÅÆÊåáÂ∞éÁèæÂ†¥„ÅßÂ£∞„Çí„Åã„Åë„Çã„Çà„ÅÜ„Å™Ëá™ÁÑ∂„Å™„Ç≥„É°„É≥„Éà„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        temperature: 0.8,
                        max_tokens: 500
                    })
                });

                if (!response.ok) {
                    throw new Error('AI API request failed');
                }

                const data = await response.json();
                return data.choices[0].message.content;
                
            } catch (error) {
                console.error('AI summary generation error:', error);
                // „Ç®„É©„ÉºÊôÇ„ÅØ„Éá„Éï„Ç©„É´„Éà„ÅÆ„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ„ÇíËøî„Åô
                const topCategory = Object.keys(categoryGroups)[0];
                const categoryName = topCategory ? AI_CATEGORIES[topCategory].name : 'ÂÆüÁøí‰ΩìÈ®ì';
                // „Ç®„É©„ÉºÊôÇ„ÅÆ„Éá„Éï„Ç©„É´„Éà„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ
                const isFinalDay = currentDay === '5';
                if (isFinalDay) {
                    return `ÊúÄÁµÇÊó•„ÄÅÊú¨ÂΩì„Å´„ÅäÁñ≤„ÇåÊßò„Åß„Åó„ÅüÔºÅ${dayRecords.length}‰ª∂„ÇÇ„ÅÆË≤¥Èáç„Å™‰ΩìÈ®ì„ÇíË®òÈå≤„Åï„Çå„ÄÅÁâπ„Å´${categoryName}„Å´Èñ¢„Åô„ÇãÂ≠¶„Å≥„ÅåÊ∑±„Åã„Å£„Åü„Çà„ÅÜ„Åß„Åô„Å≠„ÄÇ

5Êó•Èñì„ÅÆÂÆüÁøí„ÇíÈÄö„Åó„Å¶„ÄÅ„ÅÇ„Å™„Åü„ÅØÁ¢∫ÂÆü„Å´ÊàêÈï∑„Åï„Çå„Åæ„Åó„Åü„ÄÇ„Åì„ÅÆÁµåÈ®ì„Åå„Åì„Çå„Åã„Çâ„ÅÆÂåªÁôÇËÄÖ„Å®„Åó„Å¶„ÅÆÈÅì„ÅÆ„Åã„Åë„Åå„Åà„ÅÆ„Å™„ÅÑË≤°Áî£„Å´„Å™„Çã„Åì„Å®„ÇíÁ¢∫‰ø°„Åó„Å¶„ÅÑ„Åæ„Åô„ÄÇ`;
                } else {
                    return `‰ªäÊó•„ÇÇ„ÅäÁñ≤„ÇåÊßò„Åß„Åó„ÅüÔºÅ${dayRecords.length}‰ª∂„ÇÇ„ÅÆ‰ΩìÈ®ì„ÇíË®òÈå≤„Åï„Çå„ÄÅÁâπ„Å´${categoryName}„Å´Èñ¢„Åô„ÇãÂ≠¶„Å≥„ÅåÂ§ö„Åã„Å£„Åü„Çà„ÅÜ„Åß„Åô„Å≠„ÄÇ

ÂÆüÁøí„Åß„ÅÆ‰ΩìÈ®ì„ÇíÊåØ„ÇäËøî„Çä„ÄÅË®ÄËëâ„Å´„Åó„Å¶ÊÆã„Åô„Åì„Å®„ÅØ„ÄÅÂ∞ÜÊù•ÂøÖ„ÅöÂ§ß„Åç„Å™Ë≤°Áî£„Å´„Å™„Çä„Åæ„Åô„ÄÇÊòéÊó•„ÇÇ„Åæ„ÅüÊñ∞„Åó„ÅÑÁô∫Ë¶ã„ÅåÂæÖ„Å£„Å¶„ÅÑ„Åæ„Åô„ÄÇ`;
                }
            }
        }
        
        // === „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà‰ΩúÊàê„ÉªÊõ¥Êñ∞ ===
        let radarChartInstance = null;
        
        function updateRadarChart() {
            // canvasË¶ÅÁ¥†„ÅÆÂ≠òÂú®Á¢∫Ë™ç
            const canvas = document.getElementById('radarChart');
            if (!canvas) {
                console.error('„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÅÆcanvasË¶ÅÁ¥†„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì');
                return;
            }
            
            // Chart.js„ÅÆÂ≠òÂú®Á¢∫Ë™ç
            if (typeof Chart === 'undefined') {
                console.error('Chart.js„ÅåË™≠„ÅøËæº„Åæ„Çå„Å¶„ÅÑ„Åæ„Åõ„Çì');
                return;
            }
            
            const ctx = canvas.getContext('2d');
            
            // „ÉÅ„É£„Éº„Éà„Éá„Éº„Çø„ÅÆÊ∫ñÂÇôÔºà„Ç´„ÉÜ„Ç¥„É™0„ÇíÈô§Â§ñÔºâ
            // 12ÊôÇ„Çí‰∏äÔºà0Â∫¶Ôºâ„Å´ÈÖçÁΩÆ„Åô„Çã„Åü„ÇÅ„ÄÅÈ†ÜÂ∫è„ÇíË™øÊï¥
            const labels = [];
            const data = [];
            
            // ÁèæÂú®„ÅÆÊó•‰ªò„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà„ÇíÂèñÂæó
            const dayKey = String(currentDay);
            const currentDayPoints = categoryPointsByDay[dayKey] || {};
            
            
            // 12ÊôÇ„Åã„ÇâÂßã„Åæ„Å£„Å¶ÊôÇË®àÂõû„Çä„Å´ÈÖçÁΩÆ
            const clockOrder = [12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];
            for (const i of clockOrder) {
                labels.push(CLOCK_CATEGORIES[i].name);
                data.push(currentDayPoints[i] || 0.5); // ÂàùÊúüÂÄ§0.5
            }
            
            // Êó¢Â≠ò„ÅÆ„ÉÅ„É£„Éº„Éà„Åå„ÅÇ„Çå„Å∞Á†¥Ê£Ñ
            if (radarChartInstance) {
                radarChartInstance.destroy();
            }
            
            // Êñ∞„Åó„ÅÑ„ÉÅ„É£„Éº„Éà„Çí‰ΩúÊàê
            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Á¥ØÁ©ç„Éù„Ç§„É≥„Éà',
                        data: data,
                        backgroundColor: 'rgba(179, 157, 219, 0.2)',
                        borderColor: 'rgba(179, 157, 219, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(179, 157, 219, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(179, 157, 219, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: false,
                            min: 0,
                            suggestedMax: 5,
                            ticks: {
                                stepSize: 1,
                                backdropColor: 'transparent',
                                display: false
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            pointLabels: {
                                font: {
                                    size: 9
                                },
                                padding: 20,
                                callback: function(value) {
                                    // Èï∑„ÅÑ„É©„Éô„É´„ÇíÊîπË°å
                                    if (value.includes('„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥')) {
                                        return ['„Ç≥„Éü„É•„Éã', '„Ç±„Éº„Ç∑„Éß„É≥'];
                                    }
                                    if (value.includes('ÊÇ£ËÄÖ„Å´ÂØæ„Åô„Çã')) {
                                        return ['ÊÇ£ËÄÖ„Å´ÂØæ„Åô„Çã', 'ÂïèÈ°åËß£Ê±∫ËÉΩÂäõ'];
                                    }
                                    if (value.includes('Á§æ‰ºöÂåªÂ≠¶')) {
                                        return ['Á§æ‰ºöÂåªÂ≠¶/', 'ÂÖ¨Ë°ÜË°õÁîü'];
                                    }
                                    return value;
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.raw + '„Éù„Ç§„É≥„Éà';
                                }
                            }
                        }
                    }
                }
            });
            
            // „É¨„Ç∏„Çß„É≥„Éâ„ÇíÊõ¥Êñ∞
            updateRadarLegend();
        }
        
        function updateRadarLegend() {
            const legendContainer = document.getElementById('radarLegend');
            let legendHtml = '<div style="font-weight: bold; margin-bottom: 10px;">„Ç´„ÉÜ„Ç¥„É™Âà•Á¥ØÁ©ç„Éù„Ç§„É≥„Éà</div>';
            
            // „Ç´„ÉÜ„Ç¥„É™0„ÇíÈô§Â§ñ„Åó„Å¶„Éù„Ç§„É≥„Éà„ÅåÂ§ö„ÅÑÈ†Ü„Å´„ÇΩ„Éº„Éà
            const dayKey = String(currentDay);
            const currentDayPoints = categoryPointsByDay[dayKey] || {};
            
            const sortedCategories = [];
            for (let i = 1; i <= 12; i++) {
                if (currentDayPoints[i] > 0) {
                    sortedCategories.push({
                        id: i,
                        name: CLOCK_CATEGORIES[i].name,
                        icon: CLOCK_CATEGORIES[i].icon,
                        points: currentDayPoints[i]
                    });
                }
            }
            sortedCategories.sort((a, b) => b.points - a.points);
            
            sortedCategories.forEach(cat => {
                legendHtml += `
                    <div class="radar-legend-item">
                        <span style="margin-right: 8px;">${cat.icon}</span>
                        <span style="flex: 1;">${cat.name}</span>
                        <span style="font-weight: bold; color: #7e57c2;">${cat.points}pt</span>
                    </div>
                `;
            });
            
            if (sortedCategories.length === 0) {
                legendHtml += '<div style="color: #999; text-align: center;">„Åæ„Å†Ë®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì</div>';
            }
            
            legendContainer.innerHTML = legendHtml;
        }
        
        // === Êó•Ê¨°„É¨„Éù„Éº„ÉàÁîüÊàê ===
        async function generateDailyReport() {
            const dailyReport = document.getElementById('dailyReport');
            const dayRecords = getCurrentDayRecords();
            
            if (dayRecords.length === 0) {
                showStatus(`${currentDay === 'practice' ? 'Á∑¥ÁøíÁî®' : `${currentDay}Êó•ÁõÆ`}„ÅÆË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì„ÄÇ`, 'warning');
                return;
            }
            
            // 10ÊäïÁ®ø‰ª•‰∏ä„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ
            if (dayRecords.length < 10) {
                showStatus(`üìù „É¨„Éù„Éº„ÉàÁîüÊàê„ÅÆ„Åü„ÇÅ„Å´„ÄÅ„Åï„Çâ„Å´ÊÉÖÂ†±„ÅåÂøÖË¶Å„Åß„Åô„ÄÇ10ÊäïÁ®ø‰ª•‰∏ä„ÇíÁõÆÊåá„Åó„Åæ„Åó„Çá„ÅÜ„ÄÇÔºàÁèæÂú®: ${dayRecords.length}‰ª∂Ôºâ`, 'warning');
                return;
            }

            // „Ç´„ÉÜ„Ç¥„É™Âà•„Å´ÂàÜÈ°û
            const categoryGroups = {};
            dayRecords.forEach(record => {
                const category = record.category || 'other';
                if (!categoryGroups[category]) {
                    categoryGroups[category] = [];
                }
                categoryGroups[category].push(record);
            });

            // „É¨„Éù„Éº„ÉàÁîüÊàê
            let reportHtml = `
                <div class="report-content">
                    <h4>üìã ${currentDay === 'practice' ? 'Á∑¥ÁøíÁî®' : `${currentDay}Êó•ÁõÆ`}„ÅÆÂÆüÁøí„É¨„Éù„Éº„Éà</h4>
                    
                    <div class="report-section">
                        <h4>üìä Ê¶ÇË¶Å</h4>
                        <p>${currentDay === 'practice' ? 'Á∑¥Áøí' : `${currentDay}Êó•ÁõÆ`}„ÅØ${dayRecords.length}‰ª∂„ÅÆÂ≠¶ÁøíË®òÈå≤„Çí‰ΩúÊàê„Åó„Åæ„Åó„Åü„ÄÇ</p>
                        <p>Ë®òÈå≤„Åï„Çå„Åü„Ç´„ÉÜ„Ç¥„É™: ${Object.keys(categoryGroups).length}È†ÖÁõÆ</p>
                    </div>
            `;

            // LISTÂΩ¢Âºè„Åß„Ç´„ÉÜ„Ç¥„É™Âà•„Å´Ë°®Á§∫ÔºàupdateOrganizedView„Å®Âêå„Åò„É≠„Ç∏„ÉÉ„ÇØ„Çí‰ΩøÁî®Ôºâ
            // 12ÊôÇË®à„Ç´„ÉÜ„Ç¥„É™Âà•„Å´Ë¶ÅÁ¥†„ÇíÈõÜË®à
            const categoryElements = {};
            for (let i = 0; i <= 12; i++) {
                categoryElements[i] = [];
            }
            
            // ÈáçË§á„ÉÅ„Çß„ÉÉ„ÇØÁî®„ÅÆ„Éû„ÉÉ„Éó
            const uniqueElements = new Map();
            
            dayRecords.forEach(record => {
                // Èï∑ÊñáË®òÈå≤„ÅßË§áÊï∞Ë¶ÅÁ¥†„Åå„ÅÇ„ÇãÂ†¥Âêà
                if (record.multipleElements && record.multipleElements.length > 0) {
                    record.multipleElements.forEach(elem => {
                        const key = `${elem.category}-${elem.content.toLowerCase().trim()}`;
                        if (!uniqueElements.has(key)) {
                            uniqueElements.set(key, true);
                            categoryElements[elem.category].push({
                                elementContent: elem.content,
                                elementReason: elem.reason,
                                weight: Math.max(1, Math.round(elem.weight))
                            });
                        }
                    });
                } else {
                    // Áü≠ÊñáË®òÈå≤„ÅÆÂ†¥Âêà
                    const category = record.category || 0;
                    const key = `${category}-${record.originalText.toLowerCase().trim()}`;
                    if (!uniqueElements.has(key)) {
                        uniqueElements.set(key, true);
                        categoryElements[category].push({
                            elementContent: record.originalText,
                            elementReason: record.aiReason,
                            weight: 1
                        });
                    }
                }
            });
            
            // „Ç´„ÉÜ„Ç¥„É™Âà•Ë©≥Á¥∞„ÇíLISTÂΩ¢Âºè„ÅßË°®Á§∫
            reportHtml += `
                <div class="report-section">
                    <h4>üìù Â≠¶ÁøíÂÜÖÂÆπÔºàLISTÂΩ¢ÂºèÔºâ</h4>
                    <div class="report-list-content">
            `;
            
            for (let categoryId = 0; categoryId <= 12; categoryId++) {
                const elements = categoryElements[categoryId];
                if (elements.length === 0) continue;
                
                const category = AI_CATEGORIES[categoryId] || AI_CATEGORIES[0];
                const totalPoints = elements.reduce((sum, elem) => sum + elem.weight, 0);
                
                reportHtml += `
                    <div class="report-category-section">
                        <div class="report-category-header">
                            ${category.name} (${totalPoints}pt)
                        </div>
                        <div class="report-category-content">
                            ${elements.map(elem => `
                                <div class="report-category-item">
                                    <div class="report-element-text">‚Ä¢ ${elem.elementContent}</div>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
            }
            
            reportHtml += `
                    </div>
                </div>
            `;

            // AI„Å´„Çà„Çã„Åæ„Å®„ÇÅÁîüÊàê
            showStatus('ü§ñ AI„Åå„É¨„Éù„Éº„Éà„Çí„Åæ„Å®„ÇÅ„Å¶„ÅÑ„Åæ„Åô...', 'info');
            const aiSummary = await generateAISummary(dayRecords, categoryGroups);
            
            reportHtml += `
                    <div class="report-section">
                        <h4>üí° AI„Å´„Çà„Çã„Éï„Ç£„Éº„Éâ„Éê„ÉÉ„ÇØ</h4>
                        <div class="ai-feedback">${aiSummary}</div>
                    </div>
                    <div style="text-align: center; margin-top: 20px;">
                        <button onclick="downloadDayReportPDF('${currentDay}')" style="background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%); color: white; border: none; padding: 10px 25px; border-radius: 20px; font-size: 14px; cursor: pointer; box-shadow: 0 3px 10px rgba(0,0,0,0.2);">
                            üì• „Åì„ÅÆ„É¨„Éù„Éº„Éà„ÇíPDF„Åß„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                        </button>
                    </div>
                </div>
            `;

            // „É¨„Éù„Éº„Éà„Çí‰øùÂ≠ò
            savedReports[currentDay] = reportHtml;
            
            // ‰øùÂ≠ò„Åï„Çå„Åü„É¨„Éù„Éº„Éà„Çí„Åô„Åπ„Å¶Ë°®Á§∫
            displayAllReports();
            
            // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíÊõ¥Êñ∞ÔºàË°®Á§∫Áä∂ÊÖã„ÅØÂ§â„Åà„Å™„ÅÑÔºâ
            updateRadarChart();
            
            showStatus('üìä Êú¨Êó•„ÅÆ„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
            
            // „É¨„Éù„Éº„ÉàÁîüÊàê„Éú„Éº„Éä„ÇπÔºöÁ∑¥ÁøíÁî®‰ª•Â§ñ„Åß10‰ª∂‰ª•‰∏ä„ÅÆË®òÈå≤„Åå„ÅÇ„ÇãÂ†¥Âêà„ÄÅÂàùÂõû„ÅÆ„Åø„É¨„Éô„É´„Çí3‰∏ä„Åí„Çã
            const reportKey = `day_${currentDay}`;
            if (currentDay !== 'practice' && !generatedReports[reportKey]) {
                generatedReports[reportKey] = true;
                saveGameData();
                showStatus('üéÅ 10‰ª∂‰ª•‰∏ä„ÅÆË®òÈå≤ÈÅîÊàêÔºÅ„Éú„Éº„Éä„ÇπÁç≤ÂæóÔºÅ', 'success');
                setTimeout(() => {
                    addBonusLevels(3, '„Éá„Ç§„É™„Éº„É¨„Éù„Éº„ÉàÁîüÊàê„Éú„Éº„Éä„ÇπÔºÅ');
                }, 1000);
            } else if (currentDay === 'practice') {
                showStatus('üìù Á∑¥ÁøíÁî®„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„ÅüÔºàÁµåÈ®ìÂÄ§„Å™„ÅóÔºâ', 'info');
            }
        }

        // === ‰øùÂ≠ò„Åï„Çå„Åü„É¨„Éù„Éº„Éà„Çí„Åô„Åπ„Å¶Ë°®Á§∫ ===
        function displayAllReports() {
            const dailyReport = document.getElementById('dailyReport');
            let allReportsHtml = '';
            
            // Êó•‰ªòÈ†Ü„Å´„É¨„Éù„Éº„Éà„ÇíË°®Á§∫ÔºàÁ∑¥ÁøíÁî®„ÄÅ1Êó•ÁõÆ„ÄÅ2Êó•ÁõÆ...Ôºâ
            const orderedDays = ['practice', '1', '2', '3', '4', '5'];
            
            orderedDays.forEach(day => {
                if (savedReports[day]) {
                    const dayLabel = day === 'practice' ? 'Á∑¥ÁøíÁî®' : `Á¨¨${day}Êó•ÁõÆ`;
                    const reportId = `report-${day}`;
                    
                    allReportsHtml += `
                        <div class="report-box">
                            <div class="report-box-header" onclick="toggleReport('${day}')">
                                <span class="report-box-title">üìã ${dayLabel}„ÅÆ„É¨„Éù„Éº„Éà</span>
                                <span class="report-toggle-icon" id="toggle-icon-${day}">‚ñº</span>
                            </div>
                            <div class="report-box-content" id="${reportId}" style="display: none;">
                                ${savedReports[day]}
                            </div>
                        </div>
                    `;
                }
            });
            
            // ÁîüÊàê„Åï„Çå„Åü„É¨„Éù„Éº„Éà„Åå„Å™„ÅÑÂ†¥Âêà„ÅÆ„É°„ÉÉ„Çª„Éº„Ç∏
            if (allReportsHtml === '' && !summaryReportHtml) {
                allReportsHtml = `
                    <div class="report-content">
                        <h4>üìã ÂÆüÁøí„É¨„Éù„Éº„Éà</h4>
                        <div class="empty-state">
                            <div class="icon">üìä</div>
                            <p>Ë®òÈå≤„ÇíËøΩÂä†„Åó„Å¶„Åã„Çâ<br>„Äå„É¨„Éù„Éº„ÉàÁîüÊàê„Äç„Éú„Çø„É≥„ÇíÊäº„Åô„Å®<br>„Åù„ÅÆÊó•„ÅÆ‰ΩìÈ®ì„Çí„Åæ„Å®„ÇÅ„Åü„É¨„Éù„Éº„Éà„ÅåËá™ÂãïÁîüÊàê„Åï„Çå„Åæ„Åô</p>
                        </div>
                    </div>
                `;
            }
            
            // Êó•‰ªòÈ†Ü„É¨„Éù„Éº„Éà„ÅÆÂæå„Å´Á∑èÂêà„É¨„Éù„Éº„Éà„ÇíËøΩÂä†
            dailyReport.innerHTML = allReportsHtml + (summaryReportHtml || '');
            
            // ÁèæÂú®„ÅÆÊó•‰ªò„ÅÆ„É¨„Éù„Éº„Éà„ÇíËá™ÂãïÁöÑ„Å´Èñã„Åè
            if (savedReports[currentDay]) {
                toggleReport(currentDay);
            }
        }
        
        // === „É¨„Éù„Éº„Éà„ÅÆÈñãÈñâ ===
        function toggleReport(day) {
            const reportContent = document.getElementById(`report-${day}`);
            const toggleIcon = document.getElementById(`toggle-icon-${day}`);
            
            if (reportContent.style.display === 'none') {
                // ‰ªñ„ÅÆ„É¨„Éù„Éº„Éà„ÇíÈñâ„Åò„Çã
                document.querySelectorAll('.report-box-content').forEach(content => {
                    content.style.display = 'none';
                });
                document.querySelectorAll('.report-toggle-icon').forEach(icon => {
                    icon.textContent = '‚ñº';
                });
                
                // ÈÅ∏Êäû„Åó„Åü„É¨„Éù„Éº„Éà„ÇíÈñã„Åè
                reportContent.style.display = 'block';
                toggleIcon.textContent = '‚ñ≤';
            } else {
                // „É¨„Éù„Éº„Éà„ÇíÈñâ„Åò„Çã
                reportContent.style.display = 'none';
                toggleIcon.textContent = '‚ñº';
            }
        }

        // === Á∑èÂêà„É¨„Éù„Éº„ÉàÁîüÊàê ===
        async function generateSummaryReport() {
            // ÂÖ®Êó•Á®ã„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà„ÇíÂêàÁÆó
            const totalPoints = {};
            for (let i = 0; i <= 12; i++) {
                totalPoints[i] = 0;
            }
            
            // ÂêÑÊó•„ÅÆ„Éù„Ç§„É≥„Éà„ÇíÂêàÁÆó
            const dayKeys = ['practice', '1', '2', '3', '4', '5'];
            dayKeys.forEach(day => {
                const dayPoints = categoryPointsByDay[day] || {};
                for (let i = 0; i <= 12; i++) {
                    totalPoints[i] += dayPoints[i] || 0;
                }
            });
            
            // Á∑èÂêà„É¨„Éù„Éº„Éà„ÇíÁîüÊàê
            const summaryHtml = await generateSummaryReportContent(totalPoints);
            
            // Á∑èÂêà„É¨„Éù„Éº„Éà„ÅÆHTML„Çí‰øùÂ≠ò
            summaryReportHtml = `
                <div class="report-box summary-report">
                    <div class="report-box-header" onclick="toggleReport('summary')" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                        <span class="report-box-title">üèÜ Á∑èÂêà„É¨„Éù„Éº„ÉàÔºàÂÖ®${dayKeys.length - 1}Êó•ÈñìÔºâ</span>
                        <span class="report-toggle-icon" id="toggle-icon-summary">‚ñº</span>
                    </div>
                    <div class="report-box-content" id="report-summary" style="display: none;">
                        <div class="summary-radar-container" style="text-align: center; margin-bottom: 20px;">
                            <canvas id="summaryRadarChart" width="200" height="200" style="max-width: 200px; height: auto;"></canvas>
                        </div>
                        ${summaryHtml}
                        <div style="text-align: center; margin-top: 30px;">
                            <button onclick="downloadSummaryReportPDF()" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; border: none; padding: 12px 30px; border-radius: 25px; font-size: 16px; font-weight: bold; cursor: pointer; box-shadow: 0 4px 15px rgba(0,0,0,0.2);">
                                üì• PDF„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ
                            </button>
                        </div>
                    </div>
                </div>
            `;
            
            // „É¨„Éù„Éº„Éà„Ç®„É™„Ç¢„ÇíÊõ¥Êñ∞ÔºàdisplayAllReports„ÅåÁ∑èÂêà„É¨„Éù„Éº„Éà„ÇÇÂê´„ÇÅ„Å¶ÈÅ©Âàá„Å™È†ÜÂ∫è„ÅßË°®Á§∫Ôºâ
            displayAllReports();
            
            // Á∑èÂêà„É¨„Éù„Éº„Éà„ÇíÈñã„Åè
            setTimeout(() => {
                toggleReport('summary');
                // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíÊèèÁîª
                drawSummaryRadarChart(totalPoints);
            }, 100);
            
            showStatus('üèÜ Á∑èÂêà„É¨„Éù„Éº„Éà„ÇíÁîüÊàê„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
        }
        
        // === Á∑èÂêà„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàÊèèÁîª ===
        function drawSummaryRadarChart(totalPoints) {
            const canvas = document.getElementById('summaryRadarChart');
            if (!canvas) return;
            
            const ctx = canvas.getContext('2d');
            
            // „Éá„Éº„ÇøÊ∫ñÂÇô
            const labels = [];
            const data = [];
            const clockOrder = [12, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11];
            
            for (const i of clockOrder) {
                labels.push(CLOCK_CATEGORIES[i].name);
                data.push(totalPoints[i] || 0.5);
            }
            
            // Êó¢Â≠ò„ÅÆ„ÉÅ„É£„Éº„Éà„Åå„ÅÇ„Çå„Å∞Á†¥Ê£Ñ
            if (window.summaryRadarChartInstance) {
                window.summaryRadarChartInstance.destroy();
            }
            
            // Êñ∞„Åó„ÅÑ„ÉÅ„É£„Éº„Éà„Çí‰ΩúÊàê
            window.summaryRadarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Á∑èÂêàÂÆüÁ∏æ',
                        data: data,
                        backgroundColor: 'rgba(147, 51, 234, 0.2)',
                        borderColor: 'rgba(147, 51, 234, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(147, 51, 234, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(147, 51, 234, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            angleLines: {
                                display: true
                            },
                            suggestedMin: 0,
                            suggestedMax: Math.max(...data) * 1.2,
                            ticks: {
                                stepSize: 5
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: false
                        }
                    }
                }
            });
        }
        
        // === Á∑èÂêà„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíË°®Á§∫ ===
        function showSummaryRadarChart(totalPoints) {
            // ‰∏ÄÊôÇÁöÑ„Å´Á∑èÂêà„Éù„Ç§„É≥„Éà„ÇíË°®Á§∫
            const originalPoints = categoryPointsByDay[currentDay];
            const dayKey = String(currentDay);
            
            // Á∑èÂêà„Éù„Ç§„É≥„Éà„Çí‰∏ÄÊôÇÁöÑ„Å´Ë®≠ÂÆö
            categoryPointsByDay['summary'] = totalPoints;
            const originalDay = currentDay;
            currentDay = 'summary';
            
            // „ÉÅ„É£„Éº„Éà„ÇíÊõ¥Êñ∞
            updateRadarChart();
            
            // 3ÁßíÂæå„Å´ÂÖÉ„Å´Êàª„Åô
            setTimeout(() => {
                currentDay = originalDay;
                delete categoryPointsByDay['summary'];
                updateRadarChart();
            }, 3000);
            
            showStatus('üìä Á∑èÂêà„ÉÅ„É£„Éº„Éà„Çí3ÁßíÈñìË°®Á§∫„Åó„Åæ„Åô', 'info');
        }
        
        // === Á∑èÂêà„É¨„Éù„Éº„Éà„Ç≥„É≥„ÉÜ„É≥„ÉÑÁîüÊàê ===
        async function generateSummaryReportContent(totalPoints) {
            // „Ç´„ÉÜ„Ç¥„É™Âà•„ÅÆ„Éù„Ç§„É≥„Éà„É©„É≥„Ç≠„É≥„Ç∞
            const ranking = [];
            for (let i = 1; i <= 12; i++) { // 0ÔºàÂàÜÈ°û‰∏çËÉΩÔºâ„ÇíÈô§Â§ñ
                if (totalPoints[i] > 0) {
                    ranking.push({
                        category: i,
                        name: AI_CATEGORIES[i].name,
                        points: totalPoints[i]
                    });
                }
            }
            ranking.sort((a, b) => b.points - a.points);
            
            // ÁèæÂú®„ÅÆÊó•‰ªò„Å®„É¶„Éº„Ç∂„ÉºÂêç„ÇíÂèñÂæó
            const today = new Date().toLocaleDateString('ja-JP', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
            const userName = currentUser ? currentUser.name : 'ÂåøÂêç„É¶„Éº„Ç∂„Éº';
            
            let html = `
                <div class="report-content">
                    <div class="report-header" style="text-align: center; margin-bottom: 30px; padding: 20px 0; border-bottom: 2px solid #e0e0e0;">
                        <h3 style="margin: 0 0 10px 0;">Âú∞ÂüüÂåªÁôÇÂÆüÁøí Á∑èÂêà„É¨„Éù„Éº„Éà</h3>
                        <p style="margin: 5px 0; color: #666;">‰ΩúÊàêÊó•: ${today}</p>
                        <p style="margin: 5px 0; color: #666;">Ê∞èÂêç: ${userName}</p>
                    </div>
                    
                    <h4>üèÜ ÂÆüÁøíÂÖ®‰Ωì„ÅÆÁ∑èÂêàË©ï‰æ°</h4>
                    
                    <div class="report-section">
                        <h4>üìä Áç≤Âæó„Éù„Ç§„É≥„Éà„É©„É≥„Ç≠„É≥„Ç∞</h4>
                        <ol>
                            ${ranking.map((item, index) => {
                                let medal = '';
                                let style = '';
                                if (index === 0) {
                                    medal = 'ü•á';
                                    style = 'font-size: 1.3em; font-weight: bold; color: #FFD700;';
                                } else if (index === 1) {
                                    medal = 'ü•à';
                                    style = 'font-size: 1.2em; font-weight: bold; color: #C0C0C0;';
                                } else if (index === 2) {
                                    medal = 'ü•â';
                                    style = 'font-size: 1.1em; font-weight: bold; color: #CD7F32;';
                                }
                                return `<li style="${style}">${medal} ${item.name}: ${item.points}„Éù„Ç§„É≥„Éà</li>`;
                            }).join('')}
                        </ol>
                    </div>
                    
                    <div class="report-section">
                        <h4>üéØ Â≠¶ÁøíÈÅîÊàêÂ∫¶</h4>
                        <p>Á∑èË®òÈå≤Êï∞: ${records.length}‰ª∂</p>
                        <p>ÊúÄÁµÇ„É¨„Éô„É´: Lv.${userLevel}</p>
                        <p>Á∑èÁç≤Âæó„Éù„Ç§„É≥„Éà: ${ranking.reduce((sum, item) => sum + item.points, 0)}„Éù„Ç§„É≥„Éà</p>
                    </div>
                `;
            
            // 4Ë±°Èôê„Éû„Éà„É™„ÇØ„Çπ„ÅÆÈõÜË®à
            const matrixData = calculateMatrixData(totalPoints);
            
            // AI„Å´„Çà„Çã4Ë±°Èôê„Çµ„Éû„É™„Éº
            if (records.length > 0) {
                const matrixSummary = await generateMatrixSummary(matrixData, records);
                html += `
                    <div class="report-section">
                        <h4>üó∫Ô∏è 4Ë±°Èôê„Éû„Éà„É™„ÇØ„ÇπÂàÜÊûê</h4>
                        ${matrixSummary}
                    </div>
                `;
                
                const aiFeedback = await generateSummaryAIFeedback(ranking, records.length, records);
                html += `
                    <div class="report-section">
                        <h4>üìÑ Á∑èÂêàÂ≠¶ÁøíË®òÈå≤</h4>
                        <div class="ai-feedback">${aiFeedback}</div>
                    </div>
                `;
            }
            
            html += `</div>`;
            return html;
        }
        
        // === 4Ë±°Èôê„Éû„Éà„É™„ÇØ„Çπ„ÅÆË®àÁÆó ===
        function calculateMatrixData(totalPoints) {
            // ÂêÑ„Ç´„ÉÜ„Ç¥„É™„Çí4Ë±°Èôê„Å´ÂàÜÈ°û
            const matrix = {
                'Clinical-Technical': {
                    categories: [3, 4, 5, 6], // ÂåªÂ≠¶Áü•Ë≠ò„ÄÅË®∫ÂØü„ÉªÊâãÊäÄ„ÄÅÂïèÈ°åËß£Ê±∫„ÄÅÁµ±ÂêàÁöÑËá®Â∫ä
                    points: 0,
                    name: 'Ëá®Â∫ä√ótechnical skill'
                },
                'Clinical-NonTechnical': {
                    categories: [7, 8], // Â§öËÅ∑Á®ÆÈÄ£Êê∫„ÄÅ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥
                    points: 0,
                    name: 'Ëá®Â∫ä√ónon-technical skill'
                },
                'Social-Technical': {
                    categories: [10, 12], // ‰øùÂÅ•„ÉªÁ¶èÁ•â„ÄÅÁ§æ‰ºöÂåªÂ≠¶/ÂÖ¨Ë°ÜË°õÁîü
                    points: 0,
                    name: 'Á§æ‰ºö√ótechnical skill'
                },
                'Social-NonTechnical': {
                    categories: [1, 2, 9, 11], // ÂåªÁôÇÂÄ´ÁêÜ„ÄÅÂú∞ÂüüÂåªÁôÇ„ÄÅ‰∏ÄËà¨ÊïôÈ§ä„ÄÅË°åÊîø
                    points: 0,
                    name: 'Á§æ‰ºö√ónon-technical skill'
                }
            };
            
            // ÂêÑË±°Èôê„ÅÆ„Éù„Ç§„É≥„Éà„ÇíÈõÜË®à
            for (const quadrant in matrix) {
                matrix[quadrant].categories.forEach(cat => {
                    matrix[quadrant].points += totalPoints[cat] || 0;
                });
            }
            
            return matrix;
        }
        
        // === 4Ë±°Èôê„Éû„Éà„É™„ÇØ„Çπ„Çµ„Éû„É™„ÉºÁîüÊàê ===
        async function generateMatrixSummary(matrixData, allRecords) {
            // API„Ç≠„Éº„ÉÅ„Çß„ÉÉ„ÇØ
            checkApiKey();
            if (!OPENAI_API_KEY) {
                return '<p>AI„Çµ„Éû„É™„Éº„ÇíÁîüÊàê„Åß„Åç„Åæ„Åõ„ÇìÔºàAPI„Ç≠„ÉºÊú™Ë®≠ÂÆöÔºâ</p>';
            }
            
            // ÂêÑË±°Èôê„ÅÆË®òÈå≤„ÇíÂèéÈõÜ
            const quadrantRecords = {
                'Clinical-Technical': [],
                'Clinical-NonTechnical': [],
                'Social-Technical': [],
                'Social-NonTechnical': []
            };
            
            // Ë®òÈå≤„ÇíË±°Èôê„Åî„Å®„Å´ÂàÜÈ°û
            allRecords.forEach(record => {
                if (record.category) {
                    for (const quadrant in matrixData) {
                        if (matrixData[quadrant].categories.includes(record.category)) {
                            quadrantRecords[quadrant].push(record.text);
                            break;
                        }
                    }
                }
            });
            
            try {
                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [{
                            role: 'system',
                            content: 'ÂåªÂ≠¶ÂÆüÁøí„ÅÆË®òÈå≤„ÇíÂàÜÊûê„Åó„ÄÅÂêÑÈ†òÂüü„Åß„ÅÆÂ≠¶ÁøíÂÜÖÂÆπ„ÇíÂÆ¢Ë¶≥ÁöÑ„Å´Ë®òËø∞„Åô„ÇãÂ†±ÂëäÊõ∏‰ΩúÊàêËÄÖ„Åß„Åô„ÄÇ‰∫ãÂÆü„Å´Âü∫„Å•„ÅÑ„ÅüÂÜ∑Èùô„Å™Ë¶≥ÂØü„Å®ÂàÜÊûê„ÇíÂøÉ„Åå„Åë„ÄÅÈÅéÂ∫¶„Å™ÊÑüÊÉÖË°®Áèæ„ÅØÈÅø„Åë„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                        }, {
                            role: 'user',
                            content: `‰ª•‰∏ã„ÅÆÂÆüÁøíË®òÈå≤„Çí4„Å§„ÅÆÈ†òÂüüÂà•„Å´Êï¥ÁêÜ„Åó„ÄÅ„Åù„Çå„Åû„Çå200Â≠óÁ®ãÂ∫¶„ÅßÂ≠¶ÁøíÂÜÖÂÆπ„Çí„Åæ„Å®„ÇÅ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ
ÂÆüÈöõ„Å´Ë°å„Å£„ÅüÊ¥ªÂãï„ÄÅË¶≥ÂØü„Åó„Åü‰∫ãË±°„ÄÅÂæó„Çâ„Çå„ÅüÁü•Ë¶ã„Çí‰∏≠ÂøÉ„Å´„ÄÅÂ†±ÂëäÊõ∏„Å®„Åó„Å¶ÈÅ©Âàá„Å™Êñá‰Ωì„ÅßË®òËø∞„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

„ÄêËá®Â∫ä√ótechnical skill „ÅÆË®òÈå≤„Äë
${quadrantRecords['Clinical-Technical'].join('\n')}

„ÄêËá®Â∫ä√ónon-technical skill „ÅÆË®òÈå≤„Äë
${quadrantRecords['Clinical-NonTechnical'].join('\n')}

„ÄêÁ§æ‰ºö√ótechnical skill „ÅÆË®òÈå≤„Äë
${quadrantRecords['Social-Technical'].join('\n')}

„ÄêÁ§æ‰ºö√ónon-technical skill „ÅÆË®òÈå≤„Äë
${quadrantRecords['Social-NonTechnical'].join('\n')}

‰ª•‰∏ã„ÅÆJSONÂΩ¢Âºè„Åß„ÄÅÂêÑÈ†òÂüü„ÅÆÂ≠¶ÁøíÂÜÖÂÆπ„ÇíÂÆ¢Ë¶≥ÁöÑ„Å´Ë®òËø∞„Åó„Å¶„Åè„Å†„Åï„ÅÑÔºö
{
  "clinical_technical": "Ë®∫ÂØü„ÉªÊâãÊäÄ„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíÂÜÖÂÆπ„ÅÆÂÆ¢Ë¶≥ÁöÑË®òËø∞",
  "clinical_nontechnical": "„ÉÅ„Éº„É†ÂåªÁôÇ„Éª„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíÂÜÖÂÆπ„ÅÆË®òËø∞",
  "social_technical": "Âú∞Âüü‰øùÂÅ•„ÉªÂÖ¨Ë°ÜË°õÁîüÊ¥ªÂãï„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíÂÜÖÂÆπ„ÅÆË®òËø∞",
  "social_nontechnical": "Âú∞ÂüüÂåªÁôÇ„ÉªÂÄ´ÁêÜÁöÑÂÅ¥Èù¢„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíÂÜÖÂÆπ„ÅÆË®òËø∞"
}`
                        }],
                        temperature: 0.3,
                        max_tokens: 800,
                        response_format: { type: "json_object" }
                    })
                });
                
                const data = await response.json();
                const summaryData = JSON.parse(data.choices[0].message.content);
                
                // HTMLÂΩ¢Âºè„ÅßÊï¥ÂΩ¢ÔºàÁ∏¶‰∏¶„Å≥Ôºâ
                return `
                    <div class="matrix-summary" style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #4285f4;">
                            <h5 style="margin: 0 0 10px 0; color: #4285f4;">üè• Ëá®Â∫ä√ótechnical skill</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ${summaryData.clinical_technical || '„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì'}
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #ea4335;">
                            <h5 style="margin: 0 0 10px 0; color: #ea4335;">ü§ù Ëá®Â∫ä√ónon-technical skill</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ${summaryData.clinical_nontechnical || '„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì'}
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #34a853;">
                            <h5 style="margin: 0 0 10px 0; color: #34a853;">üåç Á§æ‰ºö√ótechnical skill</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ${summaryData.social_technical || '„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì'}
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #fbbc04;">
                            <h5 style="margin: 0 0 10px 0; color: #fbbc04;">üèòÔ∏è Á§æ‰ºö√ónon-technical skill</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ${summaryData.social_nontechnical || '„Éá„Éº„Çø„Åå„ÅÇ„Çä„Åæ„Åõ„Çì'}
                            </p>
                        </div>
                    </div>
                `;
                
            } catch (error) {
                console.error('Matrix summary generation error:', error);
                // „Ç®„É©„ÉºÊôÇ„ÅØË®òÈå≤Êï∞„Å´Âü∫„Å•„ÅèÁ∞°Êòì„Çµ„Éû„É™„Éº„ÇíË°®Á§∫
                return `
                    <div class="matrix-summary" style="display: flex; flex-direction: column; gap: 15px;">
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #4285f4;">
                            <h5 style="margin: 0 0 10px 0; color: #4285f4;">üè• Ëá®Â∫ä√ótechnical skillÔºà${matrixData['Clinical-Technical'].points}„Éù„Ç§„É≥„ÉàÔºâ</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ÂåªÂ≠¶Áü•Ë≠ò„ÅÆÁøíÂæó„ÄÅË®∫ÂØüÊâãÊäÄ„ÅÆÂÆüË∑µ„ÄÅÊÇ£ËÄÖ„Åï„Çì„Å∏„ÅÆÂïèÈ°åËß£Ê±∫„ÄÅ„Åù„Åó„Å¶Áµ±ÂêàÁöÑ„Å™Ëá®Â∫äËÉΩÂäõ„ÅÆÂêë‰∏ä„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíË®òÈå≤„Åå${quadrantRecords['Clinical-Technical'].length}‰ª∂„ÅÇ„Çä„Åæ„Åó„Åü„ÄÇÂÆüÁøí„ÇíÈÄö„Åò„Å¶„ÄÅÂ∫ßÂ≠¶„ÅßÂ≠¶„Çì„Å†Áü•Ë≠ò„ÇíÂÆüÈöõ„ÅÆËá®Â∫äÁèæÂ†¥„ÅßÂøúÁî®„Åô„ÇãÊ©ü‰ºö„ÇíÂæó„Çâ„Çå„Åæ„Åó„Åü„ÄÇ
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #ea4335;">
                            <h5 style="margin: 0 0 10px 0; color: #ea4335;">ü§ù Ëá®Â∫ä√ónon-technical skillÔºà${matrixData['Clinical-NonTechnical'].points}„Éù„Ç§„É≥„ÉàÔºâ</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                Â§öËÅ∑Á®ÆÈÄ£Êê∫„ÇÑ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„Çπ„Ç≠„É´„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíË®òÈå≤„Åå${quadrantRecords['Clinical-NonTechnical'].length}‰ª∂„ÅÇ„Çä„Åæ„Åó„Åü„ÄÇÂåªÁôÇ„ÉÅ„Éº„É†„ÅÆ‰∏ÄÂì°„Å®„Åó„Å¶„ÄÅÁúãË≠∑Â∏´„ÄÅËñ¨Ââ§Â∏´„ÄÅ„É™„Éè„Éì„É™„Çπ„Çø„ÉÉ„Éï„Å™„Å©Êßò„ÄÖ„Å™ËÅ∑Á®Æ„Å®„ÅÆÂçîÂÉç„ÇíÁµåÈ®ì„Åó„ÄÅ„ÉÅ„Éº„É†ÂåªÁôÇ„ÅÆÈáçË¶ÅÊÄß„ÇíÂÆüÊÑü„Åó„Åæ„Åó„Åü„ÄÇ
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #34a853;">
                            <h5 style="margin: 0 0 10px 0; color: #34a853;">üåç Á§æ‰ºö√ótechnical skillÔºà${matrixData['Social-Technical'].points}„Éù„Ç§„É≥„ÉàÔºâ</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ‰øùÂÅ•„ÉªÁ¶èÁ•âÂà∂Â∫¶„ÇÑÂÖ¨Ë°ÜË°õÁîü„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíË®òÈå≤„Åå${quadrantRecords['Social-Technical'].length}‰ª∂„ÅÇ„Çä„Åæ„Åó„Åü„ÄÇÂú∞ÂüüÂåªÁôÇ„ÅÆÁèæÂ†¥„Åß„ÄÅÂåªÁôÇ„Å†„Åë„Åß„Å™„ÅèÁ¶èÁ•â„ÇÑË°åÊîø„Å®„ÅÆÈÄ£Êê∫„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Å≥„ÄÅÁ§æ‰ºöÂåªÂ≠¶ÁöÑ„Å™Ë¶ñÁÇπ„Åã„ÇâÊÇ£ËÄÖ„Åï„Çì„ÇíÊîØÊè¥„Åô„ÇãÊñπÊ≥ï„ÇíÁêÜËß£„Åó„Åæ„Åó„Åü„ÄÇ
                            </p>
                        </div>
                        <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; border-left: 4px solid #fbbc04;">
                            <h5 style="margin: 0 0 10px 0; color: #fbbc04;">üèòÔ∏è Á§æ‰ºö√ónon-technical skillÔºà${matrixData['Social-NonTechnical'].points}„Éù„Ç§„É≥„ÉàÔºâ</h5>
                            <p style="margin: 0; font-size: 0.9rem; line-height: 1.6; color: #333;">
                                ÂåªÁôÇÂÄ´ÁêÜ„ÄÅÂú∞ÂüüÂåªÁôÇ„ÅÆÁâπÊÄß„ÄÅ‰∏ÄËà¨ÊïôÈ§ä„ÄÅË°åÊîø„Å®„ÅÆÈñ¢„Çè„Çä„Å´Èñ¢„Åô„ÇãÂ≠¶ÁøíË®òÈå≤„Åå${quadrantRecords['Social-NonTechnical'].length}‰ª∂„ÅÇ„Çä„Åæ„Åó„Åü„ÄÇÂú∞Âüü„Å´Ê†π„Åñ„Åó„ÅüÂåªÁôÇ„ÅÆÂú®„ÇäÊñπ„ÇÑ„ÄÅÂåªÁôÇËÄÖ„Å®„Åó„Å¶„ÅÆÂÄ´ÁêÜË¶≥„ÄÅÂú∞ÂüüÁ§æ‰ºö„Å®„ÅÆÈñ¢„Çè„ÇäÊñπ„Å´„Å§„ÅÑ„Å¶Ê∑±„ÅÑÊ¥ûÂØü„ÇíÂæó„Åæ„Åó„Åü„ÄÇ
                            </p>
                        </div>
                    </div>
                `;
            }
        }
        
        // === AI„Å´„Çà„ÇãÁ∑èÂêàÂ≠¶ÁøíË®òÈå≤ÁîüÊàê ===
        async function generateSummaryAIFeedback(ranking, totalRecords, allRecords) {
            try {
                // „Ç´„ÉÜ„Ç¥„É™„ÉºÂà•„Å´Ë®òÈå≤„ÇíÊï¥ÁêÜ
                const categorizedRecords = {};
                allRecords.forEach(record => {
                    if (record.category) {
                        const categoryName = CATEGORY_MAP[record.category] || `„Ç´„ÉÜ„Ç¥„É™„Éº${record.category}`;
                        if (!categorizedRecords[categoryName]) {
                            categorizedRecords[categoryName] = [];
                        }
                        categorizedRecords[categoryName].push(record.text);
                    }
                });
                
                // ÂÖ®Ë®òÈå≤„ÇíÁµêÂêà„Åó„Å¶„Éä„É©„ÉÜ„Ç£„Éñ„Çí‰ΩúÊàê
                const allTexts = allRecords.map(r => r.text).join('\n');
                
                const prompt = `‰ª•‰∏ã„ÅØÂú∞ÂüüÂåªÁôÇÂÆüÁøí„Åß„ÅÆÂÖ®Ë®òÈå≤„Åß„Åô„ÄÇ„Åì„Çå„Çâ„ÅÆË®òÈå≤„Åã„Çâ„ÄÅÂÆüÁøíÊúüÈñì„ÇíÈÄö„Åò„Å¶„Å©„ÅÆ„Çà„ÅÜ„Å™‰ΩìÈ®ì„Çí„Åó„ÄÅ‰Ωï„ÇíÁô∫Ë¶ã„Åó„ÄÅ„Å©„ÅÜÊàêÈï∑„Åó„Åü„ÅÆ„Åã„Çí„ÄÅ400Â≠óÁ®ãÂ∫¶„ÅÆËá™ÁÑ∂„Å™ÊñáÁ´†„ÅßÊèèÂÜô„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ

„ÄêÂÆüÁøíË®òÈå≤„Äë
${allTexts}

ÂΩ¢ÂºèÁöÑ„Å™Â†±ÂëäÊõ∏„Åß„ÅØ„Å™„Åè„ÄÅÂÆüÁøí„ÅÆÊó•„ÄÖ„ÅßÂÆüÈöõ„Å´Ëµ∑„Åç„Åü„Åì„Å®„ÇÑÊÑü„Åò„Åü„Åì„Å®„Åå‰ºù„Çè„Çã„Çà„ÅÜ„Å™„ÄÅÁîü„ÅçÁîü„Åç„Å®„Åó„ÅüË®òËø∞„Çí„ÅäÈ°ò„ÅÑ„Åó„Åæ„Åô„ÄÇ
„Äå„Äú„ÇíÂ≠¶„Å≥„Åæ„Åó„Åü„Äç„Å®„ÅÑ„ÅÜÂÆöÂûãÁöÑ„Å™Ë°®Áèæ„ÇíÈÅø„Åë„ÄÅÂÖ∑‰ΩìÁöÑ„Å™„Ç®„Éî„ÇΩ„Éº„Éâ„ÇÑÊ∞ó„Å•„Åç„ÅÆÁû¨Èñì„Çí‰∏≠ÂøÉ„Å´„ÄÅÂÆüÁøí„ÅÆÁâ©Ë™û„ÇíÁ¥°„ÅÑ„Åß„Åè„Å†„Åï„ÅÑ„ÄÇ`;

                const response = await fetch('https://api.openai.com/v1/chat/completions', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${OPENAI_API_KEY}`
                    },
                    body: JSON.stringify({
                        model: 'gpt-4o-mini',
                        messages: [
                            {
                                role: 'system',
                                content: '„ÅÇ„Å™„Åü„ÅØÂåªÂ≠¶Áîü„ÅÆÂÆüÁøíË®òÈå≤„ÇíË™≠„ÅøËæº„Åø„ÄÅ„Åù„Åì„Åã„ÇâÊµÆ„Åã„Å≥‰∏ä„Åå„Çã‰ΩìÈ®ì„ÅÆÁâ©Ë™û„ÇíÊèè„ÅçÂá∫„Åô„É©„Ç§„Çø„Éº„Åß„Åô„ÄÇË®òÈå≤„ÅÆÊñ≠Áâá„Åã„Çâ„ÄÅÂÆüÁøíÊúüÈñì‰∏≠„ÅÆÁô∫Ë¶ã„ÄÅÈ©ö„Åç„ÄÅÊàêÈï∑„ÅÆÁû¨Èñì„ÇíË¶ã„Å§„ÅëÂá∫„Åó„ÄÅË™≠„ÇÄ‰∫∫„ÅåÂÆüÁøí„ÅÆÁèæÂ†¥„ÇíËøΩ‰ΩìÈ®ì„Åß„Åç„Çã„Çà„ÅÜ„Å™ÊñáÁ´†„ÇíÊõ∏„ÅÑ„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ'
                            },
                            {
                                role: 'user',
                                content: prompt
                            }
                        ],
                        temperature: 0.9,
                        max_tokens: 600
                    })
                });

                if (!response.ok) {
                    throw new Error('AI API request failed');
                }

                const data = await response.json();
                return data.choices[0].message.content;
                
            } catch (error) {
                console.error('Summary report generation error:', error);
                const topCategories = ranking.slice(0, 3).map(item => item.name).join('„ÄÅ');
                return `Êú¨ÂÆüÁøí„Åß„ÅØ${totalRecords}‰ª∂„ÅÆÂ≠¶Áøí‰ΩìÈ®ì„ÇíË®òÈå≤„Åó„Åæ„Åó„Åü„ÄÇ‰∏ª„Å™Â≠¶ÁøíÂàÜÈáé„ÅØ${topCategories}„Åß„ÅÇ„Çä„ÄÅÂú∞ÂüüÂåªÁôÇ„ÅÆÁèæÂ†¥„Å´„Åä„ÅÑ„Å¶ÂπÖÂ∫É„ÅÑÁµåÈ®ì„ÇíÁ©ç„ÇÄ„Åì„Å®„Åå„Åß„Åç„Åæ„Åó„Åü„ÄÇ

Ëá®Â∫äÈù¢„Åß„ÅØ„ÄÅË®∫ÂØüÊâãÊäÄ„ÅÆÂÆüË∑µ„ÇÑÊÇ£ËÄÖ„Å®„ÅÆ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„ÄÅÂ§öËÅ∑Á®ÆÈÄ£Êê∫„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Å≥„Åæ„Åó„Åü„ÄÇÁ§æ‰ºöÂåªÂ≠¶ÁöÑÂÅ¥Èù¢„Åß„ÅØ„ÄÅÂú∞Âüü„ÅÆ‰øùÂÅ•„ÉªÁ¶èÁ•âÂà∂Â∫¶„ÇÑÂÖ¨Ë°ÜË°õÁîüÊ¥ªÂãï„ÅÆÂÆüÈöõ„Çí‰ΩìÈ®ì„Åó„ÄÅÂåªÁôÇ„ÅÆÁ§æ‰ºöÁöÑÂΩπÂâ≤„Å´„Å§„ÅÑ„Å¶ÁêÜËß£„ÇíÊ∑±„ÇÅ„Åæ„Åó„Åü„ÄÇ

ÂÆüÁøíÂÖ®‰Ωì„ÇíÈÄö„Åò„Å¶„ÄÅÂåªÂ≠¶Áü•Ë≠ò„ÅÆËá®Â∫äÂøúÁî®„ÄÅ„ÉÅ„Éº„É†ÂåªÁôÇ„ÅÆÂÆüË∑µ„ÄÅÂú∞ÂüüÂåªÁôÇ„ÅÆÁâπÊÄßÁêÜËß£„Å™„Å©„ÄÅÂåªÂ∏´„Å®„Åó„Å¶ÂøÖË¶Å„Å™Âü∫Êú¨ÁöÑËÉΩÂäõ„ÅÆÂü∫Áõ§„ÇíÊßãÁØâ„Åô„Çã„Åì„Å®„Åå„Åß„Åç„Åæ„Åó„Åü„ÄÇ`;
            }
        }

        // === Ê¨°„ÅÆÊó•„Å∏ÈÄ≤„ÇÄ ===
        // === Ââç„ÅÆÊó•„Å∏Ê©üËÉΩ ===
        function previousDay() {
            const currentDayElement = document.getElementById('currentDay');
            if (currentDayElement) {
                const currentDay = parseInt(currentDayElement.textContent) || 1;
                if (currentDay > 1) {
                    currentDayElement.textContent = currentDay - 1;
                    showStatus(`Day ${currentDay - 1}„Å´Êàª„Çä„Åæ„Åó„Åü`, 'success');
                    // Ë°®Á§∫„ÇíÊõ¥Êñ∞
                    updateAllViews();
                } else {
                    showStatus('„Åì„Çå‰ª•‰∏äÂâç„ÅÆÊó•„Å´„ÅØÊàª„Çå„Åæ„Åõ„Çì', 'error');
                }
            }
        }

        async function advanceDay() {
            const studentName = document.getElementById('studentName').value.trim();
            
            if (!studentName) {
                showStatus('Â≠¶ÁîüÂêç„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ„ÄÇ', 'error');
                return;
            }

            try {
                // „É≠„Éº„Ç´„É´„ÅßÊó•Êï∞„ÇíÈÄ≤„ÇÅ„Çã
                const currentDayElement = document.getElementById('currentDay');
                const currentDayText = currentDayElement.textContent;
                const currentDayNum = parseInt(currentDayText.replace('Êó•ÁõÆ', '')) || 1;
                const nextDay = Math.min(currentDayNum + 1, 5);
                
                currentDayElement.textContent = nextDay + 'Êó•ÁõÆ';
                showStatus(`‚úÖ ${nextDay}Êó•ÁõÆ„Å´ÈÄ≤„Åø„Åæ„Åó„ÅüÔºÅ`, 'success');

                // GASÈÄ£Êê∫Ôºà„Éê„ÉÉ„ÇØ„Ç∞„É©„Ç¶„É≥„ÉâÔºâ
                try {
                    const response = await fetch(window.location.href, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({
                            action: 'advanceDay',
                            studentName: studentName
                        })
                    });

                    if (response.ok) {
                        const result = await response.json();
                        console.log('Êó•Ê¨°ÈÄ≤Ë°åÁµêÊûú:', result);
                    }
                } catch (gasError) {
                    console.log('GASÊó•Ê¨°ÈÄ≤Ë°å„Çπ„Ç≠„ÉÉ„Éó:', gasError);
                }

            } catch (error) {
                console.error('Êó•Ê¨°ÈÄ≤Ë°å„Ç®„É©„Éº:', error);
                showStatus('‚ùå Êó•Ê¨°ÈÄ≤Ë°å„Å´Â§±Êïó„Åó„Åæ„Åó„Åü„ÄÇ', 'error');
            }
        }


        // === „Çπ„ÉÜ„Éº„Çø„ÇπË°®Á§∫ ===
        // === AIÂàÜÊûêÁêÜÁî±„ÅÆË°®Á§∫/ÈùûË°®Á§∫ ===
        function toggleReason(categoryId, index) {
            const reasonElement = document.getElementById(`reason-${categoryId}-${index}`);
            if (reasonElement) {
                if (reasonElement.style.display === 'none') {
                    // ‰ªñ„ÅÆÈñã„ÅÑ„Å¶„ÅÑ„ÇãÁêÜÁî±„ÇíÈñâ„Åò„Çã
                    document.querySelectorAll('.element-reason').forEach(el => {
                        el.style.display = 'none';
                    });
                    reasonElement.style.display = 'block';
                } else {
                    reasonElement.style.display = 'none';
                }
            }
        }

        function showStatus(message, type = 'info') {
            const statusMessage = document.getElementById('statusMessage');
            statusMessage.innerHTML = `<div class="status-message status-${type}">${message}</div>`;
            
            // 5ÁßíÂæå„Å´Ê∂àÂéª
            setTimeout(() => {
                statusMessage.innerHTML = '';
            }, 5000);
        }

        // === „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥ÈñãÈñâ ===
        function toggleDayDropdown() {
            const dropdown = document.getElementById('dayDropdown');
            dropdown.classList.toggle('active');
        }

        // === Êó•‰ªòÈÅ∏ÊäûÊ©üËÉΩ ===
        function selectDay(day) {
            currentDay = day;
            
            // „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÅÆ„Ç¢„ÇØ„ÉÜ„Ç£„ÉñÁä∂ÊÖã„ÇíÊõ¥Êñ∞
            document.querySelectorAll('.day-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.target.classList.add('selected');
            
            // „É©„Éô„É´„ÇíÊõ¥Êñ∞
            const dayLabel = document.getElementById('currentDayLabel');
            dayLabel.textContent = day === 'practice' ? 'Á∑¥ÁøíÁî®' : `${day}Êó•ÁõÆ`;
            
            // „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÇíÈñâ„Åò„Çã
            document.getElementById('dayDropdown').classList.remove('active');
            
            // Ë°®Á§∫„ÇíÊõ¥Êñ∞
            updateAllViews();
            
            // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà„ÇíÂ∏∏„Å´Êõ¥Êñ∞
            updateRadarChart();
            
            // REPORT„É¢„Éã„Çø„Éº„Åå„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å™Â†¥Âêà„ÅØ„ÄÅ„É¨„Éù„Éº„ÉàË°®Á§∫„ÇÇÊõ¥Êñ∞
            if (currentMonitor === 'monitor3') {
                setTimeout(() => {
                    displayAllReports();
                }, 100);
            }
        }


        // === Èï∑Êñá„Çµ„É≥„Éó„É´Ë®òÈå≤ËøΩÂä†ÔºàÈñãÁô∫Áî®Ôºâ ===
        async function addLongSampleRecord() {
            const longSampleTexts = [
                // ÂÜÖÁßëÁ≥ª
                "Êú¨Êó•„ÅÆÂÜÖÁßëÂ§ñÊù•ÂÆüÁøí„Åß„ÅØ„ÄÅÈ´òË°ÄÂúß„Å®Á≥ñÂ∞øÁóÖ„ÇíÂêà‰Ωµ„Åó„Åü70Ê≠≥Áî∑ÊÄßÊÇ£ËÄÖ„ÅÆÂïèË®∫„Åã„ÇâË®∫ÂØü„ÄÅÊ§úÊüª„Ç™„Éº„ÉÄ„Éº„Åæ„Åß„ÅÆ‰∏ÄÈÄ£„ÅÆÊµÅ„Çå„ÇíÂ≠¶„Çì„Å†„ÄÇÁâπ„Å´Âç∞Ë±°ÁöÑ„Å†„Å£„Åü„ÅÆ„ÅØ„ÄÅÊåáÂ∞éÂåª„ÅåÊÇ£ËÄÖ„ÅÆÁîüÊ¥ªËÉåÊôØ„Çí‰∏ÅÂØß„Å´ËÅû„ÅçÂèñ„Çä„ÄÅÈ£ü‰∫ãÂÜÖÂÆπ„ÇÑÈÅãÂãïÁøíÊÖ£„ÄÅ„Çπ„Éà„É¨„ÇπË¶ÅÂõ†„Å™„Å©„ÇíÁ∑èÂêàÁöÑ„Å´Ë©ï‰æ°„Åó„Å¶„ÅÑ„Åü„Åì„Å®„Åß„ÅÇ„Çã„ÄÇ„Åæ„Åü„ÄÅË°ÄÂúßÊ∏¨ÂÆö„ÅÆÈöõ„Å´„ÅØÁôΩË°£È´òË°ÄÂúß„ÅÆÂèØËÉΩÊÄß„ÇÇËÄÉÊÖÆ„Åó„ÄÅÂÆ∂Â∫≠Ë°ÄÂúß„ÅÆË®òÈå≤„ÇíÁ¢∫Ë™ç„Åó„Å¶„ÅÑ„Åü„ÄÇË®∫ÂØüÂæå„ÅÆ„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„Åß„ÅØ„ÄÅËñ¨Áâ©Ê≤ªÁôÇ„ÅÆÈÅ∏Êäû„Å´„Å§„ÅÑ„Å¶„Éá„Ç£„Çπ„Ç´„ÉÉ„Ç∑„Éß„É≥„ÇíË°å„ÅÑ„ÄÅACEÈòªÂÆ≥Ëñ¨„Å®Âà©Â∞øËñ¨„ÅÆ‰ΩµÁî®„Å´„Çà„ÇãÊ≤ªÁôÇÊñπÈáù„ÇíÂ≠¶„Çì„Å†„ÄÇÊÇ£ËÄÖ„Åï„Çì„Å∏„ÅÆË™¨Êòé„Åß„ÅØ„ÄÅÂ∞ÇÈñÄÁî®Ë™û„ÇíÈÅø„Åë„Å¶„Çè„Åã„Çä„ÇÑ„Åô„Åè‰ºù„Åà„Çã„Åì„Å®„ÅÆÂ§ßÂàá„Åï„ÇíÂÆüÊÑü„Åó„Åü„ÄÇ",
                
                // ÊïëÊÄ•
                "ÊïëÊÄ•Â§ñÊù•„Åß„ÅÆÂÆüÁøí„Åß„ÄÅ‰∫§ÈÄöÂ§ñÂÇ∑„Å´„Çà„ÇãÂ§öÁô∫Â§ñÂÇ∑ÊÇ£ËÄÖ„ÅÆÂàùÊúüÂØæÂøú„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇPrimary Survey„ÅÆABCDE„Ç¢„Éó„É≠„Éº„ÉÅ„ÇíÂÆüÈöõ„Å´ÁõÆ„ÅÆÂΩì„Åü„Çä„Å´„Åó„ÄÅÊ∞óÈÅìÁ¢∫‰øù„ÄÅÂëºÂê∏Áä∂ÊÖã„ÅÆË©ï‰æ°„ÄÅÂæ™Áí∞ÂãïÊÖã„ÅÆ„ÉÅ„Çß„ÉÉ„ÇØ„ÅåËøÖÈÄü„Å´Ë°å„Çè„Çå„ÇãÊßòÂ≠ê„ÇíÂ≠¶„Çì„Å†„ÄÇÂêåÊôÇ„Å´ÁúãË≠∑Â∏´„Åå„Éê„Ç§„Çø„É´„Çµ„Ç§„É≥„ÅÆÊ∏¨ÂÆö„ÇíË°å„ÅÑ„ÄÅÊîæÂ∞ÑÁ∑öÊäÄÂ∏´„Åå„Éù„Éº„Çø„Éñ„É´XÁ∑öÊíÆÂΩ±„ÅÆÊ∫ñÂÇô„Çí„Åó„Å¶„Åä„Çä„ÄÅ„ÉÅ„Éº„É†ÂåªÁôÇ„ÅÆÈáçË¶ÅÊÄß„ÇíÁóõÊÑü„Åó„Åü„ÄÇFASTÊ§úÊüª„ÅßËÖπËÖîÂÜÖÂá∫Ë°Ä„ÅåÁñë„Çè„Çå„Åü„Åü„ÇÅ„ÄÅÁ∑äÊÄ•ÊâãË°ì„ÅÆÈÅ©Âøú„Å®„Å™„Çä„ÄÅÊÇ£ËÄÖ„Åï„Çì„ÅÆÂÆ∂Êóè„Å∏„ÅÆË™¨Êòé„ÇÇÂêåÊôÇ‰∏¶Ë°å„ÅßË°å„Çè„Çå„Åü„ÄÇÊïëÊÄ•Âåª„ÅÆÂÖàÁîü„Åã„Çâ„ÅØ„ÄÅ„ÄåÊïëÊÄ•„Åß„ÅØÂ∏∏„Å´ÊúÄÊÇ™„ÇíÊÉ≥ÂÆö„Åó„Å¶Âãï„Åè„Åì„Å®„Äç„Äå„Åß„Åç„Çã„Åì„Å®„Åã„ÇâÁ¢∫ÂÆü„Å´„ÇÑ„Å£„Å¶„ÅÑ„Åè„Åì„Å®„Äç„ÅÆÈáçË¶ÅÊÄß„ÇíÊïô„Çè„Å£„Åü„ÄÇ„Åæ„Åü„ÄÅ„Éà„É™„Ç¢„Éº„Ç∏„ÅÆËÄÉ„ÅàÊñπ„ÇÑ„ÄÅÈôê„Çâ„Çå„Åü„É™„ÇΩ„Éº„Çπ„ÇíÊúÄÂ§ßÈôê„Å´Ê¥ªÁî®„Åô„Çã„Åü„ÇÅ„ÅÆÂà§Êñ≠Âäõ„ÅÆÂøÖË¶ÅÊÄß„ÇÇÂ≠¶„Çì„Å†„ÄÇÊÇ£ËÄÖ„Åï„Çì„ÅÆÂëΩ„ÇíÂ∑¶Âè≥„Åô„ÇãÁèæÂ†¥„ÅÆÁ∑äÂºµÊÑü„Å®Ë≤¨‰ªª„ÅÆÈáç„Åï„ÇíË∫´„Çí„ÇÇ„Å£„Å¶ÊÑü„Åò„Åü‰∏ÄÊó•„Å†„Å£„Åü„ÄÇ",
                
                // Á≤æÁ•ûÁßë
                "Á≤æÁ•ûÁßë„ÅÆÂ§ñÊù•ÂÆüÁøí„Åß„ÄÅ„ÅÜ„Å§ÁóÖÊÇ£ËÄÖ„Åï„Çì„ÅÆË®∫ÂØü„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ„Åì„ÅÆÊñπ„ÅØ3„É∂ÊúàÂâç„Åã„Çâ‰∏çÁú†„ÄÅÈ£üÊ¨≤‰∏çÊåØ„ÄÅÊÑèÊ¨≤‰Ωé‰∏ã„ÅåÁ∂ö„ÅÑ„Å¶„Åä„Çä„ÄÅ‰ªï‰∫ã„Å´„ÇÇË°å„Åë„Å™„Åè„Å™„Å£„Å¶„ÅÑ„Çã„Å®„ÅÆ„Åì„Å®„Å†„Å£„Åü„ÄÇË®∫ÂØü„Åß„ÅØ„ÄÅÊÇ£ËÄÖ„Åï„Çì„ÅÆË©±„Çí„Åò„Å£„Åè„Çä„Å®ÂÇæËÅ¥„Åó„ÄÅÊÄ•„Åã„Åï„Åö„Å´ÂØæË©±„ÇíÈÄ≤„ÇÅ„ÇãÂÖàÁîü„ÅÆÂßøÂã¢„ÅåÂç∞Ë±°ÁöÑ„Å†„Å£„Åü„ÄÇHAM-D„ÇÑBDI„Å™„Å©„ÅÆË©ï‰æ°Â∞∫Â∫¶„ÇíÁî®„ÅÑ„ÅüÁóáÁä∂Ë©ï‰æ°„ÇÑ„ÄÅËá™ÊÆ∫ÂøµÊÖÆ„ÅÆÊúâÁÑ°„ÅÆÁ¢∫Ë™ç„Å™„Å©„ÄÅÁ≥ªÁµ±ÁöÑ„Å™ÂïèË®∫„ÅÆÊñπÊ≥ï„ÇíÂ≠¶„Çì„Å†„ÄÇËñ¨Áâ©ÁôÇÊ≥ï„Å´„Å§„ÅÑ„Å¶„ÅØSSRI„ÅÆ‰ΩúÁî®Ê©üÂ∫è„ÇÑÂâØ‰ΩúÁî®„ÄÅÂäπÊûú„ÅåÁèæ„Çå„Çã„Åæ„Åß„ÅÆÊôÇÈñì„Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„Åå„ÅÇ„Çä„ÄÅÊÇ£ËÄÖ„Åï„Çì„Å´„ÇÇ„Çè„Åã„Çä„ÇÑ„Åô„Åè‰ºù„Åà„Å¶„ÅÑ„Åü„ÄÇ„Åæ„Åü„ÄÅË™çÁü•Ë°åÂãïÁôÇÊ≥ï„ÅÆÂü∫Êú¨ÁöÑ„Å™ËÄÉ„ÅàÊñπ„ÇÑ„ÄÅÁ§æ‰ºöÁöÑ„Çµ„Éù„Éº„Éà„ÅÆÈáçË¶ÅÊÄß„Å´„Å§„ÅÑ„Å¶„ÇÇË™¨Êòé„ÇíÂèó„Åë„Åü„ÄÇÁ≤æÁ•ûÁßëÂåªÁôÇ„Å´„Åä„ÅÑ„Å¶„ÅØ„ÄÅÊÇ£ËÄÖ„Åï„Çì„Å®„ÅÆ‰ø°È†ºÈñ¢‰øÇ„ÅÆÊßãÁØâ„Åå‰Ωï„Çà„Çä„ÇÇÂ§ßÂàá„Åß„ÅÇ„Çä„ÄÅÂÖ±ÊÑüÁöÑ„Å™ÊÖãÂ∫¶„ÅßÊé•„Åô„Çã„Åì„Å®„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                
                // Â∞èÂÖêÁßë
                "Â∞èÂÖêÁßëÁóÖÊ£ü„Åß„ÅÆÂÆüÁøí„Åß„ÄÅÂñòÊÅØÁô∫‰Ωú„ÅßÂÖ•Èô¢„Åó„Åü5Ê≠≥„ÅÆÁî∑ÂÖê„ÅÆ„Ç±„Ç¢„Å´Èñ¢„Çè„Å£„Åü„ÄÇÂ≠ê„Å©„ÇÇ„Å∏„ÅÆÂïèË®∫„ÅØ‰øùË≠∑ËÄÖ„ÇíÈÄö„Åò„Å¶Ë°å„ÅÜ„Åì„Å®„ÅåÂ§ö„ÅÑ„Åå„ÄÅÂ≠ê„Å©„ÇÇÊú¨‰∫∫„Åã„Çâ„ÇÇÁóáÁä∂„ÇíËÅû„ÅçÂá∫„Åô„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„Çπ„Ç≠„É´„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Çì„Å†„ÄÇËÅ¥Ë®∫„Åß„ÅØÊàê‰∫∫„Å®„ÅØÁï∞„Å™„ÇãÂëºÂê∏Èü≥„ÅÆÁâπÂæ¥„Åå„ÅÇ„Çä„ÄÅwheezing„ÅÆËÅ¥ÂèñÊñπÊ≥ï„ÇíÊïô„Çè„Å£„Åü„ÄÇÂê∏ÂÖ•ÁôÇÊ≥ï„ÅÆÂÆüÊñΩ„Åß„ÅØ„ÄÅÂ≠ê„Å©„ÇÇ„ÅåÊÄñ„Åå„Çâ„Å™„ÅÑ„Çà„ÅÜ„Å´„Ç≠„É£„É©„ÇØ„Çø„Éº„ÅÆ„Éû„Çπ„ÇØ„Çí‰ΩøÁî®„Åó„Åü„Çä„ÄÅÈÅä„Å≥„ÅÆË¶ÅÁ¥†„ÇíÂèñ„ÇäÂÖ•„Çå„Åü„Çä„Åô„ÇãÂ∑•Â§´„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ„Åæ„Åü„ÄÅ‰øùË≠∑ËÄÖ„Å∏„ÅÆÁóÖÁä∂Ë™¨Êòé„Åß„ÅØ„ÄÅ‰∏çÂÆâ„ÇíÂíå„Çâ„Åí„Å™„Åå„ÇâÊ≠£Á¢∫„Å™ÊÉÖÂ†±„Çí‰ºù„Åà„Çã„Éê„É©„É≥„Çπ„ÅåÈáçË¶Å„Åß„ÅÇ„Çã„Åì„Å®„ÇíË™çË≠ò„Åó„Åü„ÄÇÂ∞èÂÖêÁßë„Åß„ÅØÂåªÁôÇÊäÄË°ì„Å†„Åë„Åß„Å™„Åè„ÄÅÂ≠ê„Å©„ÇÇ„ÅÆÁô∫ÈÅîÊÆµÈöé„Å´Âøú„Åò„ÅüÂØæÂøú„ÇÑ„ÄÅÂÆ∂ÊóèÂÖ®‰Ωì„Çí„Ç±„Ç¢„Åô„ÇãË¶ñÁÇπ„ÅåÂøÖË¶Å„Åß„ÅÇ„Çã„Åì„Å®„ÇíÂÆüÊÑü„Åó„Åü„ÄÇËñ¨Áâ©Êäï‰∏éÈáè„ÅÆË®àÁÆó„Åß„ÅØ‰ΩìÈáç„ÅÇ„Åü„Çä„ÅßË°å„ÅÜ„Åü„ÇÅ„ÄÅÊ≠£Á¢∫„Å™‰ΩìÈáçÊ∏¨ÂÆö„ÅÆÈáçË¶ÅÊÄß„ÇÇÂ≠¶„Çì„Å†„ÄÇ",
                
                // Â§ñÁßë
                "Â§ñÁßëÊâãË°ìÂÆ§„Åß„ÅÆÂÆüÁøí„Åß„ÄÅËÉÜÂö¢ÊëòÂá∫Ë°ì„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇÊâãË°ìÂâç„ÅÆ„Çø„Ç§„É†„Ç¢„Ç¶„Éà„Åß„ÅØ„ÄÅÊÇ£ËÄÖÁ¢∫Ë™ç„ÄÅÊâãË°ìÈÉ®‰Ωç„ÅÆÁ¢∫Ë™ç„ÄÅ„Ç¢„É¨„É´„ÇÆ„Éº„ÅÆÊúâÁÑ°„Å™„Å©„ÄÅÂåªÁôÇÂÆâÂÖ®„ÅÆË¶≥ÁÇπ„Åã„ÇâÈáçË¶Å„Å™Á¢∫Ë™ç‰∫ãÈ†Ö„ÇíÂÖ®Âì°„ÅßÂÖ±Êúâ„Åô„ÇãÊßòÂ≠ê„ÇíÂ≠¶„Çì„Å†„ÄÇÊâãÊ¥ó„ÅÑ„ÅÆÊñπÊ≥ï„ÇÑÊ∏ÖÊΩîÊìç‰Ωú„ÅÆÈáçË¶ÅÊÄß„Å´„Å§„ÅÑ„Å¶ÂÆüË∑µÁöÑ„Å´Êïô„Çè„Çä„ÄÅË°ìÈáé„ÅÆÊ∏ÖÊΩî„Çí‰øù„Å§„Åì„Å®„ÅÆÊÑèÂë≥„ÇíÁêÜËß£„Åó„Åü„ÄÇËÖπËÖîÈè°ÊâãË°ì„Åß„ÅØ„ÄÅ„É¢„Éã„Çø„Éº„ÇíË¶ã„Å™„Åå„Çâ„ÅÆÁπäÁ¥∞„Å™Êìç‰ΩúÊäÄË°ì„Å´ÊÑüÈäò„ÇíÂèó„Åë„Åü„ÄÇÂü∑ÂàÄÂåª„ÄÅÁ¨¨‰∏ÄÂä©Êâã„ÄÅÂô®Ê¢∞Âá∫„ÅóÁúãË≠∑Â∏´„ÄÅÂ§ñÂõû„ÇäÁúãË≠∑Â∏´„Åå„Åù„Çå„Åû„Çå„ÅÆÂΩπÂâ≤„ÇíÊûú„Åü„Åó„ÄÅÂÜÜÊªë„Å´ÊâãË°ì„ÅåÈÄ≤Ë°å„Åó„Å¶„ÅÑ„ÅèÊßòÂ≠ê„Åã„Çâ„ÉÅ„Éº„É†ÂåªÁôÇ„ÅÆÈáçË¶ÅÊÄß„ÇíÂÜçË™çË≠ò„Åó„Åü„ÄÇË°ì‰∏≠„ÅÆËß£ÂâñÂ≠¶ÁöÑ„É©„É≥„Éâ„Éû„Éº„ÇØ„ÅÆÁ¢∫Ë™çÊñπÊ≥ï„ÇÑ„ÄÅÂá∫Ë°Ä„Å∏„ÅÆÂØæÂá¶Ê≥ï„Å™„Å©„ÇÇÂ≠¶„Å∂„Åì„Å®„Åå„Åß„Åç„Åü„ÄÇË°ìÂæå„ÅÆÁî≥„ÅóÈÄÅ„Çä„Åß„ÅØ„ÄÅÊâãË°ìÊâÄË¶ã„ÇÑË°ìÂæåÁÆ°ÁêÜ„ÅÆÊ≥®ÊÑèÁÇπ„ÅåË©≥Á¥∞„Å´‰ºùÈÅî„Åï„Çå„Å¶„Åä„Çä„ÄÅÁ∂ôÁ∂öÁöÑ„Å™ÊÇ£ËÄÖ„Ç±„Ç¢„ÅÆÈáçË¶ÅÊÄß„ÇíÊÑü„Åò„Åü„ÄÇ",
                
                // Áî£Â©¶‰∫∫Áßë
                "Áî£Â©¶‰∫∫ÁßëÂ§ñÊù•„ÅßÂ¶äÂ©¶ÂÅ•Ë®∫„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇÂ¶äÂ®†20ÈÄ±„ÅÆÂàùÁî£Â©¶„Åï„Çì„ÅÆÂÅ•Ë®∫„Åß„ÅØ„ÄÅË∂ÖÈü≥Ê≥¢Ê§úÊüª„ÅßËÉéÂÖê„ÅÆÊàêÈï∑„ÇíÁ¢∫Ë™ç„Åó„ÄÅÊé®ÂÆö‰ΩìÈáç„ÅÆË®àÁÆóÊñπÊ≥ï„ÇíÂ≠¶„Çì„Å†„ÄÇËÉéÂÖê„ÅÆÂêÑÈÉ®‰Ωç„ÅÆË®àÊ∏¨„ÇÑ„ÄÅÁæäÊ∞¥Èáè„ÅÆË©ï‰æ°„ÄÅËÉéÁõ§„ÅÆ‰ΩçÁΩÆÁ¢∫Ë™ç„Å™„Å©„ÄÅÁ≥ªÁµ±ÁöÑ„Å™Ë¶≥ÂØüÊñπÊ≥ï„ÇíÊïô„Çè„Å£„Åü„ÄÇÊØç‰Ωì„ÅÆ‰ΩìÈáçÂ¢óÂä†„ÇÑË°ÄÂúßÁÆ°ÁêÜ„ÅÆÈáçË¶ÅÊÄß„Å´„Å§„ÅÑ„Å¶„ÇÇË™¨Êòé„ÇíÂèó„Åë„Åü„ÄÇÂ¶äÂ®†Á≥ñÂ∞øÁóÖ„ÅÆ„Çπ„ÇØ„É™„Éº„Éã„É≥„Ç∞Ê§úÊüª„ÅÆÊÑèÁæ©„ÇÑ„ÄÅÂ¶äÂ®†È´òË°ÄÂúßÁóáÂÄôÁæ§„ÅÆÊó©ÊúüÁô∫Ë¶ã„ÅÆ„Éù„Ç§„É≥„Éà„Å™„Å©„ÇÇÂ≠¶Áøí„Åó„Åü„ÄÇÊÇ£ËÄÖ„Åï„Çì„Å∏„ÅÆË™¨Êòé„Åß„ÅØ„ÄÅÂ∞ÇÈñÄÁî®Ë™û„Çí‰Ωø„Çè„Åö„Å´„ÄÅÊ®°Âûã„ÇÑÂõ≥„ÇíÁî®„ÅÑ„Å¶„Çè„Åã„Çä„ÇÑ„Åô„ÅèË™¨Êòé„Åô„ÇãÂ∑•Â§´„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ„Åæ„Åü„ÄÅÂ¶äÂ©¶„Åï„Çì„ÅÆ‰∏çÂÆâ„Å´ÂØÑ„ÇäÊ∑ª„ÅÑ„ÄÅË≥™Âïè„Åó„ÇÑ„Åô„ÅÑÈõ∞Âõ≤Ê∞ó‰Ωú„Çä„Çí„Åô„Çã„Åì„Å®„ÅÆÂ§ßÂàá„Åï„ÇíÂÆüÊÑü„Åó„Åü„ÄÇÂá∫ÁîüÂâçË®∫Êñ≠„Å´„Å§„ÅÑ„Å¶„ÅÆÁõ∏Ë´á„ÇÇ„ÅÇ„Çä„ÄÅÂÄ´ÁêÜÁöÑ„Å™ÈÖçÊÖÆ„ÇíÊåÅ„Å£„Å¶ÊÉÖÂ†±Êèê‰æõ„ÇíË°å„ÅÜÂøÖË¶ÅÊÄß„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                
                // Êï¥ÂΩ¢Â§ñÁßë
                "Êï¥ÂΩ¢Â§ñÁßë„ÅÆÊâãË°ì„Åß‰∫∫Â∑•ËÜùÈñ¢ÁØÄÁΩÆÊèõË°ì„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇË°ìÂâçË®àÁîª„Åß„ÅØ„ÄÅXÁ∑öÁîªÂÉè„Åã„ÇâÈ™®Âàá„Çä„ÅÆËßíÂ∫¶„ÇÑ‰∫∫Â∑•Èñ¢ÁØÄ„ÅÆ„Çµ„Ç§„Ç∫„ÇíÊ±∫ÂÆö„Åô„ÇãÈÅéÁ®ã„ÇíÂ≠¶„Çì„Å†„ÄÇÊâãË°ì„Åß„ÅØÂ§ßËÖøÈ™®„Å®ËÑõÈ™®„ÅÆÈ™®Âàá„Çä„ÇíÊ≠£Á¢∫„Å´Ë°å„ÅÑ„ÄÅ‰∫∫Â∑•Èñ¢ÁØÄ„ÇíË®≠ÁΩÆ„Åô„ÇãÊâãÊäÄ„ÇíË¶≥ÂØü„Åó„Åü„ÄÇÈ™®„Çª„É°„É≥„Éà„ÅÆ‰ΩøÁî®ÊñπÊ≥ï„ÇÑ„ÄÅËªüÈÉ®ÁµÑÁπî„ÅÆ„Éê„É©„É≥„ÇπË™øÊï¥„ÅÆÈáçË¶ÅÊÄß„Å´„Å§„ÅÑ„Å¶Ë™¨Êòé„ÇíÂèó„Åë„Åü„ÄÇË°ì‰∏≠„ÅÆÂá∫Ë°Ä„Ç≥„É≥„Éà„É≠„Éº„É´„ÇÑ„ÄÅÊÑüÊüì‰∫àÈò≤„ÅÆ„Åü„ÇÅ„ÅÆÁÑ°ËèåÊìç‰Ωú„ÅÆÂæπÂ∫ï„ÇÇÂç∞Ë±°ÁöÑ„Å†„Å£„Åü„ÄÇ„É™„Éè„Éì„É™„ÉÜ„Éº„Ç∑„Éß„É≥Áßë„Å®„ÅÆÈÄ£Êê∫„ÇÇÈáçË¶Å„Åß„ÄÅË°ìÁøåÊó•„Åã„ÇâÁêÜÂ≠¶ÁôÇÊ≥ïÂ£´„Å´„Çà„ÇãÂèØÂãïÂüüË®ìÁ∑¥„ÅåÈñãÂßã„Åï„Çå„Çã„Åì„Å®„ÇíÂ≠¶„Çì„Å†„ÄÇË°ìÂæå„ÅÆÁñºÁóõÁÆ°ÁêÜ„Åß„ÅØ„ÄÅÁ°¨ËÜúÂ§ñÈ∫ªÈÖî„ÇÑÁ•ûÁµå„Éñ„É≠„ÉÉ„ÇØ„Å™„Å©„ÄÅÊßò„ÄÖ„Å™ÈéÆÁóõÊ≥ï„ÅåÁµÑ„ÅøÂêà„Çè„Åï„Çå„Å¶„ÅÑ„Åü„ÄÇÊÇ£ËÄÖ„Åï„Çì„ÅÆQOLÂêë‰∏ä„ÅÆ„Åü„ÇÅ„Å´„ÄÅÊâãË°ìÈÅ©Âøú„ÅÆÂà§Êñ≠„Åã„ÇâË°ìÂæå„ÅÆ„É™„Éè„Éì„É™„Åæ„Åß„ÄÅÂåÖÊã¨ÁöÑ„Å™Ê≤ªÁôÇË®àÁîª„ÅåÂøÖË¶Å„Åß„ÅÇ„Çã„Åì„Å®„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                
                // Âú®ÂÆÖÂåªÁôÇ
                "Ë®™ÂïèË®∫ÁôÇ„Å´ÂêåË°å„Åó„ÄÅÂú®ÂÆÖÂåªÁôÇ„ÅÆÂÆüÈöõ„Çí‰ΩìÈ®ì„Åó„Åü„ÄÇÂØù„Åü„Åç„Çä„ÅÆÈ´òÈΩ¢ÊÇ£ËÄÖ„Åï„Çì„ÅÆËá™ÂÆÖ„ÇíË®™Âïè„Åó„ÄÅ„Éê„Ç§„Çø„É´„Çµ„Ç§„É≥„ÅÆÊ∏¨ÂÆö„ÄÅË§•Áò°„ÅÆÂá¶ÁΩÆ„ÄÅÁµåÁÆ°Ê†ÑÈ§ä„ÅÆÁÆ°ÁêÜ„Å™„Å©„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇÈôê„Çâ„Çå„ÅüÂåªÁôÇË≥áÊ∫ê„ÅÆ‰∏≠„Åß„ÄÅ„ÅÑ„Åã„Å´Ë≥™„ÅÆÈ´ò„ÅÑÂåªÁôÇ„ÇíÊèê‰æõ„Åô„Çã„Åã„Å®„ÅÑ„ÅÜÂ∑•Â§´„ÇíÂ≠¶„Çì„Å†„ÄÇÂÆ∂Êóè„ÅÆ‰ªãË≠∑Ë≤†ÊãÖ„Å´„Å§„ÅÑ„Å¶„ÇÇË©ï‰æ°„Åó„ÄÅ‰ªãË≠∑„Çµ„Éº„Éì„Çπ„ÅÆË™øÊï¥„ÇÑ„ÄÅ„É¨„Çπ„Éë„Ç§„Éà„Ç±„Ç¢„ÅÆÊèêÊ°à„Å™„Å©„ÇÇË°å„Å£„Å¶„ÅÑ„Åü„ÄÇË®™ÂïèÁúãË≠∑Â∏´„ÄÅ„Ç±„Ç¢„Éû„Éç„Ç∏„É£„Éº„ÄÅ„Éò„É´„Éë„Éº„Å™„Å©Â§öËÅ∑Á®Æ„Å®„ÅÆÊÉÖÂ†±ÂÖ±Êúâ„ÅÆÈáçË¶ÅÊÄß„ÇíÂÆüÊÑü„Åó„Åü„ÄÇÂú®ÂÆÖ„Åß„ÅÆÁúãÂèñ„Çä„Å´„Å§„ÅÑ„Å¶„ÇÇË©±„ÅóÂêà„ÅÑ„Åå„ÅÇ„Çä„ÄÅÊÇ£ËÄÖ„Åï„Çì„Å®ÂÆ∂Êóè„ÅÆÊÑèÂêë„ÇíÂ∞äÈáç„Åó„Å™„Åå„Çâ„ÄÅÊúÄÊúü„Åæ„ÅßÂ∞äÂé≥„ÇíÊåÅ„Å£„Å¶ÈÅé„Åî„Åõ„Çã„Çà„ÅÜ„Çµ„Éù„Éº„Éà„Åô„Çã„Åì„Å®„ÅÆÂ§ßÂàá„Åï„ÇíÂ≠¶„Çì„Å†„ÄÇÁóÖÈô¢„Å®„ÅØÁï∞„Å™„ÇãÁí∞Â¢É„Åß„ÅÆÂåªÁôÇÊèê‰æõ„Å´„ÅØÊßò„ÄÖ„Å™Âà∂Á¥Ñ„Åå„ÅÇ„Çã„Åå„ÄÅÊÇ£ËÄÖ„Åï„Çì„Åå‰Ωè„ÅøÊÖ£„Çå„ÅüÂ†¥ÊâÄ„ÅßÁôÇÈ§ä„Åß„Åç„Çã„Åì„Å®„ÅÆÊÑèÁæ©„ÇíÊ∑±„ÅèÁêÜËß£„Åß„Åç„Åü„ÄÇ",
                
                // Á∑©Âíå„Ç±„Ç¢
                "Á∑©Âíå„Ç±„Ç¢ÁóÖÊ£ü„ÅßÁµÇÊú´Êúü„ÅÆÁôåÊÇ£ËÄÖ„Åï„Çì„ÅÆ„Ç±„Ç¢„ÇíÂ≠¶„Çì„Å†„ÄÇÁñºÁóõË©ï‰æ°„Åß„ÅØÊï∞ÂÄ§Ë©ï‰æ°„Çπ„Ç±„Éº„É´„Å†„Åë„Åß„Å™„Åè„ÄÅË°®ÊÉÖ„ÇÑ‰ΩìÂãï„Åã„Çâ„ÇÇÁóõ„Åø„ÇíË©ï‰æ°„Åô„ÇãÊñπÊ≥ï„ÇíÊïô„Çè„Å£„Åü„ÄÇ„Ç™„Éî„Ç™„Ç§„Éâ„ÅÆ‰ΩøÁî®ÊñπÊ≥ï„ÄÅ„É¨„Çπ„Ç≠„É•„ÉºËñ¨„ÅÆË™øÊï¥„ÄÅÂâØ‰ΩúÁî®ÂØæÁ≠ñ„Å™„Å©„ÄÅÁñºÁóõ„Ç≥„É≥„Éà„É≠„Éº„É´„ÅÆÂÆüÈöõ„ÇíË©≥„Åó„ÅèÂ≠¶Áøí„Åó„Åü„ÄÇ„Åó„Åã„ÅóÁ∑©Âíå„Ç±„Ç¢„ÅØÁñºÁóõÁÆ°ÁêÜ„Å†„Åë„Åß„Å™„Åè„ÄÅÂëºÂê∏Âõ∞Èõ£„ÄÅÂòîÊ∞ó„ÄÅÂÄ¶ÊÄ†ÊÑü„Å™„Å©Êßò„ÄÖ„Å™ÁóáÁä∂„Å∏„ÅÆÂØæÂøú„ÅåÂøÖË¶Å„Åß„ÅÇ„Çã„Åì„Å®„ÇíÁü•„Å£„Åü„ÄÇ„Åæ„Åü„ÄÅÊÇ£ËÄÖ„Åï„Çì„ÅÆÁ≤æÁ•ûÁöÑËã¶Áóõ„ÇÑ„Çπ„Éî„É™„ÉÅ„É•„Ç¢„É´„Éö„Ç§„É≥„Å´„ÇÇÈÖçÊÖÆ„Åó„ÄÅÂÇæËÅ¥„ÇÑÂÖ±ÊÑüÁöÑ„Å™ÂØæÂøú„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Çì„Å†„ÄÇÂÆ∂Êóè„Å∏„ÅÆ„Ç±„Ç¢„ÇÇÈáçË¶Å„Åß„ÄÅÁóÖÁä∂Ë™¨Êòé„ÇÑÊÑèÊÄùÊ±∫ÂÆöÊîØÊè¥„ÄÅ„Ç∞„É™„Éº„Éï„Ç±„Ç¢„Å™„Å©„ÇÇÁ∑©Âíå„Ç±„Ç¢„ÉÅ„Éº„É†„ÅÆÂΩπÂâ≤„Åß„ÅÇ„Çã„Åì„Å®„ÇíÁêÜËß£„Åó„Åü„ÄÇÂ§öËÅ∑Á®Æ„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„Åß„ÅØ„ÄÅÂåªÂ∏´„ÄÅÁúãË≠∑Â∏´„ÄÅËñ¨Ââ§Â∏´„ÄÅËá®Â∫äÂøÉÁêÜÂ£´„ÄÅMSW„Å™„Å©„Åå„Åù„Çå„Åû„Çå„ÅÆË¶ñÁÇπ„Åã„ÇâÊÇ£ËÄÖ„Åï„Çì„Å®ÂÆ∂Êóè„ÇíÊîØ„Åà„ÇãÊñπÊ≥ï„ÇíË≠∞Ë´ñ„Åó„Å¶„ÅÑ„Åü„ÄÇ",
                
                // „É™„Éè„Éì„É™„ÉÜ„Éº„Ç∑„Éß„É≥
                "„É™„Éè„Éì„É™„ÉÜ„Éº„Ç∑„Éß„É≥Áßë„ÅßËÑ≥Ê¢óÂ°ûÂæå„ÅÆÊÇ£ËÄÖ„Åï„Çì„ÅÆÊ©üËÉΩÂõûÂæ©Ë®ìÁ∑¥„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇÁêÜÂ≠¶ÁôÇÊ≥ï„Åß„ÅØ„ÄÅÁâáÈ∫ªÁó∫„ÅÆË©ï‰æ°ÊñπÊ≥ï„Å®„Åó„Å¶Brunnstrom stage„ÇÑFugl-MeyerË©ï‰æ°„ÇíÂ≠¶„Çì„Å†„ÄÇÊ≠©Ë°åË®ìÁ∑¥„Åß„ÅØÂπ≥Ë°åÊ£í„Åã„ÇâÂßã„Åæ„Çä„ÄÅÊ≠©Ë°åÂô®„ÄÅÊùñÊ≠©Ë°å„Å∏„Å®ÊÆµÈöéÁöÑ„Å´ÈÄ≤„ÇÅ„ÇãÈÅéÁ®ã„ÇíË¶≥ÂØü„Åó„Åü„ÄÇ‰ΩúÊ•≠ÁôÇÊ≥ï„Åß„ÅØ„ÄÅ‰∏äËÇ¢Ê©üËÉΩ„ÅÆÊîπÂñÑ„Å†„Åë„Åß„Å™„Åè„ÄÅÊõ¥Ë°£„ÇÑÈ£ü‰∫ã„Å™„Å©„ÅÆADLË®ìÁ∑¥„ÇÇÈáçË¶Å„Åß„ÅÇ„Çã„Åì„Å®„ÇíÂ≠¶„Çì„Å†„ÄÇË®ÄË™ûËÅ¥Ë¶öÂ£´„Å´„Çà„ÇãÂ§±Ë™ûÁóá„ÇÑÂö•‰∏ãÈöúÂÆ≥„ÅÆË©ï‰æ°„Å®Ë®ìÁ∑¥„ÇÇË¶ãÂ≠¶„Åó„ÄÅ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥ËÉΩÂäõ„ÇÑÂÆâÂÖ®„Å™È£ü‰∫ãÊëÇÂèñ„ÅÆÈáçË¶ÅÊÄß„ÇíË™çË≠ò„Åó„Åü„ÄÇ„É™„Éè„Éì„É™„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„Åß„ÅØ„ÄÅÊÇ£ËÄÖ„Åï„Çì„ÅÆÁõÆÊ®ôË®≠ÂÆö„ÇíÂ§öËÅ∑Á®Æ„ÅßÂÖ±Êúâ„Åó„ÄÅÂú®ÂÆÖÂæ©Â∏∞„Å´Âêë„Åë„ÅüÂÖ∑‰ΩìÁöÑ„Å™Ë®àÁîª„ÇíÁ´ã„Å¶„Å¶„ÅÑ„Åü„ÄÇÂÆ∂ÊóèÊåáÂ∞é„ÇÇÈáçË¶Å„Åß„ÄÅËá™ÂÆÖ„Åß„ÅÆ‰ªãÂä©ÊñπÊ≥ï„ÇÑ‰ΩèÁí∞Â¢ÉÊï¥ÂÇô„ÅÆ„Ç¢„Éâ„Éê„Ç§„Çπ„ÇÇË°å„Çè„Çå„Å¶„ÅÑ„Åü„ÄÇ„É™„Éè„Éì„É™„ÉÜ„Éº„Ç∑„Éß„É≥„ÅØÂçò„Å™„ÇãÊ©üËÉΩË®ìÁ∑¥„Åß„ÅØ„Å™„Åè„ÄÅÊÇ£ËÄÖ„Åï„Çì„ÅÆQOLÂêë‰∏ä„Å®Á§æ‰ºöÂæ©Â∏∞„ÇíÁõÆÊåá„ÅôÂåÖÊã¨ÁöÑ„Å™„Ç¢„Éó„É≠„Éº„ÉÅ„Åß„ÅÇ„Çã„Åì„Å®„ÇíÊ∑±„ÅèÁêÜËß£„Åó„Åü„ÄÇ"
            ];
            
            const randomText = longSampleTexts[Math.floor(Math.random() * longSampleTexts.length)];
            document.getElementById('experienceText').value = randomText;
            
            // ÈÄÅ‰ø°Âá¶ÁêÜ„ÇíÂëº„Å≥Âá∫„Åó
            await submitExperience();
            
            showStatus('üìù Èï∑Êñá„Çµ„É≥„Éó„É´„ÇíËøΩÂä†„Åó„Åæ„Åó„Åü', 'info');
        }
        
        // === „Çµ„É≥„Éó„É´Ë®òÈå≤ËøΩÂä†ÔºàÈñãÁô∫Áî®Ôºâ ===
        async function addSampleRecords() {
            const sampleTexts = [
                // ÂåªÂ≠¶Áü•Ë≠òÔºà3ÊôÇÔºâ
                "Á≥ñÂ∞øÁóÖ„ÅÆ‰∏âÂ§ßÂêà‰ΩµÁóá„Å´„Å§„ÅÑ„Å¶Â≠¶„Çì„Å†„ÄÇ",
                "ÊäóÁîüÂâ§„ÅÆ‰Ωø„ÅÑÂàÜ„Åë„Å´„Å§„ÅÑ„Å¶ÁêÜËß£„Åó„Åü„ÄÇ",
                "ÂøÉ‰∏çÂÖ®„ÅÆNYHAÂàÜÈ°û„ÇíË¶ö„Åà„Åü„ÄÇ",
                "ËÇ∫ÁÇé„ÅÆÈáçÁóáÂ∫¶ÂàÜÈ°ûA-DROP„ÇíÂ≠¶Áøí„Åó„Åü„ÄÇ",
                "ËÑ≥Ê¢óÂ°û„ÅÆÁóÖÂûãÂàÜÈ°û„Å´„Å§„ÅÑ„Å¶Êï¥ÁêÜ„Åß„Åç„Åü„ÄÇ",
                "Áî≤Áä∂ËÖ∫Ê©üËÉΩÊ§úÊüª„ÅÆËß£ÈáàÊñπÊ≥ï„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "ÈõªËß£Ë≥™Áï∞Â∏∏„ÅÆÁóáÁä∂„Å®ÂØæÂá¶Ê≥ï„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                "Ë≤ßË°Ä„ÅÆÈëëÂà•Ë®∫Êñ≠„Å´„Å§„ÅÑ„Å¶ÂãâÂº∑„Åó„Åü„ÄÇ",
                "ËÖéÊ©üËÉΩÊ§úÊüª„ÅÆË¶ãÊñπ„ÇíÁøíÂæó„Åó„Åü„ÄÇ",
                "ËÇùÊ©üËÉΩÈöúÂÆ≥„ÅÆÂéüÂõ†„Å´„Å§„ÅÑ„Å¶Â≠¶„Çì„Å†„ÄÇ",
                
                // Ë®∫ÂØü„ÉªÊâãÊäÄÔºà4ÊôÇÔºâ
                "Âàù„ÇÅ„Å¶ÈùôËÑàÊé°Ë°Ä„ÇíÊàêÂäü„Åï„Åõ„Åü„ÄÇ",
                "ÂøÉÈü≥„ÅÆËÅ¥Ë®∫„ÅßÁï∞Â∏∏Èü≥„ÇíËÅ¥„ÅçÂàÜ„Åë„Åü„ÄÇ",
                "ËÖπÈÉ®Ëß¶Ë®∫„ÅÆÊâãÈ†Ü„ÇíÂÆüË∑µ„Åó„Åü„ÄÇ",
                "Ë°ÄÂúßÊ∏¨ÂÆö„ÇíÊ≠£Á¢∫„Å´Ë°å„Åà„Çã„Çà„ÅÜ„Å´„Å™„Å£„Åü„ÄÇ",
                "Á•ûÁµåÂ≠¶ÁöÑÊâÄË¶ã„ÅÆÂèñ„ÇäÊñπ„ÇíÁ∑¥Áøí„Åó„Åü„ÄÇ",
                "ÁúºÂ∫ïÈè°„ÅÆ‰Ωø„ÅÑÊñπ„ÇíÊïô„Çè„Å£„Åü„ÄÇ",
                "ËÄ≥Èè°„Åß„ÅÆÈºìËÜúË¶≥ÂØü„Çí‰ΩìÈ®ì„Åó„Åü„ÄÇ",
                "ÁöÆ‰∏ãÊ≥®Â∞Ñ„ÅÆÊâãÊäÄ„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "ÂøÉÈõªÂõ≥„ÅÆË£ÖÁùÄÊñπÊ≥ï„ÇíË¶ö„Åà„Åü„ÄÇ",
                "Â∞øÊ§úÊüª„ÅÆÊâãÈ†Ü„ÇíÂÆüÊñΩ„Åó„Åü„ÄÇ",
                
                // „Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥Ôºà8ÊôÇÔºâ
                "ÊÇ£ËÄÖ„Åï„Çì„ÅÆ‰∏çÂÆâ„Å´ÂØÑ„ÇäÊ∑ª„ÅÜÂØæË©±„Åå„Åß„Åç„Åü„ÄÇ",
                "ÁóÖÁä∂Ë™¨Êòé„ÅßÂàÜ„Åã„Çä„ÇÑ„Åô„ÅÑË®ÄËëâ„ÇíÂøÉ„Åå„Åë„Åü„ÄÇ",
                "ÊÇ£ËÄÖÂÆ∂Êóè„Å®„ÅÆÈù¢Ë´á„Å´ÂêåÂ∏≠„Åó„Åü„ÄÇ",
                "ÂÇæËÅ¥„ÅÆÂßøÂã¢„ÅßÊÇ£ËÄÖ„Åï„Çì„ÅÆË©±„ÇíËÅû„ÅÑ„Åü„ÄÇ",
                "Ê§úÊüª„ÅÆÂøÖË¶ÅÊÄß„Çí‰∏ÅÂØß„Å´Ë™¨Êòé„Åó„Åü„ÄÇ",
                "ÊÇ£ËÄÖ„Åï„Çì„ÅÆ‰æ°ÂÄ§Ë¶≥„ÇíÂ∞äÈáç„Åó„ÅüÂØæÂøú„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "bad news„ÅÆ‰ºù„ÅàÊñπ„Å´„Å§„ÅÑ„Å¶ËÄÉÂØü„Åó„Åü„ÄÇ",
                "ÂÖ±ÊÑüÁöÑ„Å™Â£∞„Åã„Åë„ÅÆÈáçË¶ÅÊÄß„ÇíÂÆüÊÑü„Åó„Åü„ÄÇ",
                "ÊÇ£ËÄÖ„Åï„Çì„Å®„ÅÆ‰ø°È†ºÈñ¢‰øÇÊßãÁØâ„ÇíÊÑèË≠ò„Åó„Åü„ÄÇ",
                "ÈùûË®ÄË™ûÁöÑ„Ç≥„Éü„É•„Éã„Ç±„Éº„Ç∑„Éß„É≥„ÅÆÂ§ßÂàá„Åï„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                
                // Â§öËÅ∑Á®ÆÈÄ£Êê∫Ôºà7ÊôÇÔºâ
                "ÁúãË≠∑Â∏´„Å®„ÅÆÊÉÖÂ†±ÂÖ±Êúâ„ÅÆÈáçË¶ÅÊÄß„ÇíË™çË≠ò„Åó„Åü„ÄÇ",
                "Ëñ¨Ââ§Â∏´„Å´„Çà„ÇãÊúçËñ¨ÊåáÂ∞é„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "ÁêÜÂ≠¶ÁôÇÊ≥ïÂ£´„ÅÆ„É™„Éè„Éì„É™Ë®àÁîª„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "Ê†ÑÈ§äÂ£´„Å®„ÅÆÊ†ÑÈ§ä„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„Å´ÂèÇÂä†„Åó„Åü„ÄÇ",
                "MSW„Å®ÈÄÄÈô¢Ë™øÊï¥„Å´„Å§„ÅÑ„Å¶Ë©±„ÅóÂêà„Å£„Åü„ÄÇ",
                "Ê§úÊüªÊäÄÂ∏´„Åã„ÇâÊ§úÊüª„ÅÆÊ≥®ÊÑèÁÇπ„ÇíÊïô„Çè„Å£„Åü„ÄÇ",
                "‰ΩúÊ•≠ÁôÇÊ≥ïÂ£´„ÅÆË©ï‰æ°ÊñπÊ≥ï„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "Ë®ÄË™ûËÅ¥Ë¶öÂ£´„Å´„Çà„ÇãÂö•‰∏ãË©ï‰æ°„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "Ëá®Â∫äÂøÉÁêÜÂ£´„ÅÆ„Ç´„Ç¶„É≥„Çª„É™„É≥„Ç∞„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "Â§öËÅ∑Á®Æ„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„ÅßÊÑèË¶ã‰∫§Êèõ„Åó„Åü„ÄÇ",
                
                // ÂïèÈ°åËß£Ê±∫ËÉΩÂäõÔºà5ÊôÇÔºâ
                "ÈëëÂà•Ë®∫Êñ≠„ÇíÁ≥ªÁµ±ÁöÑ„Å´ËÄÉ„Åà„ÇãË®ìÁ∑¥„Çí„Åó„Åü„ÄÇ",
                "Ê§úÊüªË®àÁîª„ÇíË´ñÁêÜÁöÑ„Å´Á´ãÊ°à„Åó„Åü„ÄÇ",
                "Ê≤ªÁôÇÊñπÈáù„ÅÆÂÑ™ÂÖàÈ†Ü‰Ωç„ÇíËÄÉÂØü„Åó„Åü„ÄÇ",
                "Áóá‰æã„ÅÆÂïèÈ°åÁÇπ„ÇíÊï¥ÁêÜ„Åó„Å¶ÊèêÁ§∫„Åó„Åü„ÄÇ",
                "„Ç®„Éì„Éá„É≥„Çπ„Å´Âü∫„Å•„ÅÑ„ÅüÂà§Êñ≠„ÇíÂøÉ„Åå„Åë„Åü„ÄÇ",
                "Ëá®Â∫äÊé®Ë´ñ„ÅÆ„Éó„É≠„Çª„Çπ„ÇíÂÆüË∑µ„Åó„Åü„ÄÇ",
                "ÊÇ£ËÄÖ„ÅÆÂÄãÂà•ÊÄß„ÇíËÄÉÊÖÆ„Åó„ÅüÂØæÂøú„ÇíÊ§úË®é„Åó„Åü„ÄÇ",
                "„É™„Çπ„ÇØ„Å®„Éô„Éç„Éï„Ç£„ÉÉ„Éà„ÇíÊØîËºÉÊ§úË®é„Åó„Åü„ÄÇ",
                "Ë®∫ÁôÇ„Ç¨„Ç§„Éâ„É©„Ç§„É≥„ÅÆÊ¥ªÁî®ÊñπÊ≥ï„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "critical thinking„ÅÆÈáçË¶ÅÊÄß„ÇíË™çË≠ò„Åó„Åü„ÄÇ",
                
                // ÂåªÁôÇÂÄ´ÁêÜÔºà1ÊôÇÔºâ
                "„Ç§„É≥„Éï„Ç©„Éº„É†„Éâ„Ç≥„É≥„Çª„É≥„Éà„ÅÆÂÆüÈöõ„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "ÊÇ£ËÄÖ„ÅÆËá™Â∑±Ê±∫ÂÆöÊ®©„Å´„Å§„ÅÑ„Å¶ËÄÉ„Åà„Åü„ÄÇ",
                "ÂåªÁôÇÂÄ´ÁêÜ„ÅÆ4ÂéüÂâá„ÇíÂÜçÁ¢∫Ë™ç„Åó„Åü„ÄÇ",
                "ÂÆàÁßòÁæ©Âãô„ÅÆÈáçË¶ÅÊÄß„ÇíË™çË≠ò„Åó„Åü„ÄÇ",
                "DNAR„ÅÆÊÑèÊÄùÁ¢∫Ë™çÂ†¥Èù¢„Å´Á´ã„Å°‰ºö„Å£„Åü„ÄÇ",
                "ÊÇ£ËÄÖ„ÅÆÂ∞äÂé≥„Å´„Å§„ÅÑ„Å¶Ê∑±„ÅèËÄÉÂØü„Åó„Åü„ÄÇ",
                "ÂåªÁôÇËÄÖ„ÅÆË≤¨‰ªª„Å´„Å§„ÅÑ„Å¶Â≠¶„Çì„Å†„ÄÇ",
                "ÂÄ´ÁêÜÁöÑ„Ç∏„É¨„É≥„Éû„Å∏„ÅÆÂØæÂá¶„ÇíË≠∞Ë´ñ„Åó„Åü„ÄÇ",
                "ÊÇ£ËÄÖ„ÅÆÊúÄÂñÑ„ÅÆÂà©Áõä„Å´„Å§„ÅÑ„Å¶Ê§úË®é„Åó„Åü„ÄÇ",
                "„Éó„É©„Ç§„Éê„Ç∑„Éº‰øùË≠∑„ÅÆÂÆüË∑µ„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                
                // Âú∞ÂüüÂåªÁôÇÔºà2ÊôÇÔºâ
                "Âú®ÂÆÖÂåªÁôÇ„ÅÆÁèæÂ†¥„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "Ë®™ÂïèÁúãË≠∑„ÅÆÂΩπÂâ≤„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                "Âú∞ÂüüÂåÖÊã¨„Ç±„Ç¢„Ç∑„Çπ„ÉÜ„É†„Å´„Å§„ÅÑ„Å¶Â≠¶„Çì„Å†„ÄÇ",
                "‰ªãË≠∑‰øùÈô∫Âà∂Â∫¶„ÅÆÊ¶ÇË¶Å„ÇíÂãâÂº∑„Åó„Åü„ÄÇ",
                "Âú∞Âüü„ÅÆÂåªÁôÇË≥áÊ∫ê„Å´„Å§„ÅÑ„Å¶Ë™øÊüª„Åó„Åü„ÄÇ",
                "„Åã„Åã„Çä„Å§„ÅëÂåª„ÅÆÂΩπÂâ≤„ÇíË™çË≠ò„Åó„Åü„ÄÇ",
                "ÁóÖË®∫ÈÄ£Êê∫„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "Âú∞Âüü‰ΩèÊ∞ë„ÅÆÂÅ•Â∫∑„Éã„Éº„Ç∫„ÇíËÄÉÂØü„Åó„Åü„ÄÇ",
                "Ë®™ÂïèË®∫ÁôÇ„ÅÆÂÆüÈöõ„Çí‰ΩìÈ®ì„Åó„Åü„ÄÇ",
                "Âú∞ÂüüÂåªÁôÇ„ÅÆË™≤È°å„Å´„Å§„ÅÑ„Å¶Ë≠∞Ë´ñ„Åó„Åü„ÄÇ",
                
                // ‰øùÂÅ•„ÉªÁ¶èÁ•âÔºà10ÊôÇÔºâ
                "‰ªãË≠∑Ë™çÂÆö„ÅÆ‰ªïÁµÑ„Åø„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "Á¶èÁ•âÂà∂Â∫¶„ÅÆÊ¥ªÁî®ÊñπÊ≥ï„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                "Á§æ‰ºöË≥áÊ∫ê„ÅÆÁ®ÆÈ°û„Å®Âà©Áî®Ê≥ï„ÇíÂãâÂº∑„Åó„Åü„ÄÇ",
                "ÈöúÂÆ≥ËÄÖÊîØÊè¥Âà∂Â∫¶„Å´„Å§„ÅÑ„Å¶Â≠¶Áøí„Åó„Åü„ÄÇ",
                "ÁîüÊ¥ª‰øùË≠∑Âà∂Â∫¶„ÅÆÊ¶ÇË¶Å„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                "‰ªãË≠∑„Çµ„Éº„Éì„Çπ„ÅÆÁ®ÆÈ°û„ÇíÊï¥ÁêÜ„Åó„Åü„ÄÇ",
                "Á¶èÁ•âÁî®ÂÖ∑„ÅÆÈÅ∏ÂÆö„Å´„Å§„ÅÑ„Å¶Â≠¶„Çì„Å†„ÄÇ",
                "„Ç±„Ç¢„Éû„Éç„Ç∏„É£„Éº„ÅÆÂΩπÂâ≤„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                "‰ªãË≠∑‰∫àÈò≤„ÅÆÈáçË¶ÅÊÄß„ÇíË™çË≠ò„Åó„Åü„ÄÇ",
                "Á¶èÁ•âÊñΩË®≠„ÅÆÊ©üËÉΩ„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                
                // Áµ±ÂêàÁöÑËá®Â∫äÔºà6ÊôÇÔºâ
                "Ë§áÊï∞„ÅÆÁñæÊÇ£„ÇíÊåÅ„Å§ÊÇ£ËÄÖ„ÅÆÁÆ°ÁêÜ„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "ÂÖ®‰∫∫ÁöÑÂåªÁôÇ„ÅÆÂÆüË∑µ„ÇíË¶ãÂ≠¶„Åó„Åü„ÄÇ",
                "bio-psycho-social„É¢„Éá„É´„ÇíÊÑèË≠ò„Åó„Åü„ÄÇ",
                "Á∂ôÁ∂öÁöÑ„Å™ÊÇ£ËÄÖ„Éï„Ç©„É≠„Éº„ÅÆÈáçË¶ÅÊÄß„ÇíË™çË≠ò„Åó„Åü„ÄÇ",
                "‰∫àÈò≤ÂåªÂ≠¶ÁöÑ„Ç¢„Éó„É≠„Éº„ÉÅ„ÇíÂÆüË∑µ„Åó„Åü„ÄÇ",
                "ÊÇ£ËÄÖ‰∏≠ÂøÉ„ÅÆÂåªÁôÇ„Å´„Å§„ÅÑ„Å¶ËÄÉÂØü„Åó„Åü„ÄÇ",
                "EBM„Å®NBM„ÅÆÁµ±Âêà„ÇíÂ≠¶„Çì„Å†„ÄÇ",
                "ÂåÖÊã¨ÁöÑ„Å™ÂÅ•Â∫∑Ë©ï‰æ°„ÇíÂÆüÊñΩ„Åó„Åü„ÄÇ",
                "ÊÖ¢ÊÄßÁñæÊÇ£ÁÆ°ÁêÜ„ÅÆË¶ÅÁÇπ„ÇíÁêÜËß£„Åó„Åü„ÄÇ",
                "Á∑èÂêàË®∫ÁôÇ„ÅÆË¶ñÁÇπ„ÇíÈ§ä„Å£„Åü„ÄÇ",
                
                // „Åù„ÅÆ‰ªñ„ÅÆ‰ΩìÈ®ì
                "ÂåªÂ≠¶Ëã±Ë™û„ÅÆË´ñÊñá„ÇíË™≠Ëß£„Åó„Åü„ÄÇ",
                "Áóá‰æãÁô∫Ë°®„ÅÆ„Çπ„É©„Ç§„Éâ„Çí‰ΩúÊàê„Åó„Åü„ÄÇ",
                "ÂåªÁôÇÂÆâÂÖ®„Å´„Å§„ÅÑ„Å¶Â≠¶Áøí„Åó„Åü„ÄÇ",
                "ÊÑüÊüìÂØæÁ≠ñ„ÅÆÂü∫Êú¨„ÇíÂÆüË∑µ„Åó„Åü„ÄÇ",
                "ÈõªÂ≠ê„Ç´„É´„ÉÜ„ÅÆ‰Ωø„ÅÑÊñπ„ÇíÁøíÂæó„Åó„Åü„ÄÇ",
                "ÂåªÁôÇÁµåÊ∏à„Å´„Å§„ÅÑ„Å¶ËÄÉÂØü„Åó„Åü„ÄÇ",
                "Á†îÁ©∂ÂÄ´ÁêÜ„Å´„Å§„ÅÑ„Å¶Â≠¶„Çì„Å†„ÄÇ",
                "Áµ±Ë®àËß£Êûê„ÅÆÂü∫Á§é„ÇíÂãâÂº∑„Åó„Åü„ÄÇ",
                "ÊñáÁåÆÊ§úÁ¥¢„ÅÆÊñπÊ≥ï„ÇíÁøíÂæó„Åó„Åü„ÄÇ",
                "„Éó„É¨„Çº„É≥„ÉÜ„Éº„Ç∑„Éß„É≥ÊäÄË°ì„ÇíÂêë‰∏ä„Åï„Åõ„Åü„ÄÇ"
            ];
            
            showStatus('üîß „Çµ„É≥„Éó„É´Ë®òÈå≤„ÇíËøΩÂä†‰∏≠...', 'info');
            
            // „É©„É≥„ÉÄ„É†„Å´10‰ª∂ÈÅ∏Êäû
            const shuffled = sampleTexts.sort(() => 0.5 - Math.random());
            const selected = shuffled.slice(0, 10);
            
            for (let i = 0; i < selected.length; i++) {
                document.getElementById('experienceText').value = selected[i];
                await submitExperience();
                await new Promise(resolve => setTimeout(resolve, 300));
            }
            
            showStatus('‚úÖ 10‰ª∂„ÅÆ„Çµ„É≥„Éó„É´Ë®òÈå≤„ÇíËøΩÂä†„Åó„Åæ„Åó„ÅüÔºàÈñãÁô∫Áî®Ôºâ', 'success');
        }
        
        // === „É≠„Ç∞„Ç§„É≥Âá¶ÁêÜ ===
        function handleLogin(event) {
            event.preventDefault();
            
            const id = document.getElementById('loginId').value;
            const password = document.getElementById('loginPassword').value;
            
            // Á∞°ÊòìÁöÑ„Å™Ë™çË®ºÔºàÂÆüÈöõ„ÅÆÂÆüË£Ö„Åß„ÅØÈÅ©Âàá„Å™Ë™çË®º„ÇíË°å„ÅÜÔºâ
            if (id && password) {
                // ÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„ÉÅ„Çß„ÉÉ„ÇØ
                isDeveloperMode = (id === 'dev' || id === 'developer' || id === 'admin');
                
                // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„Çí‰øùÂ≠ò
                currentUser = {
                    id: id,
                    loginTime: new Date(),
                    isDeveloper: isDeveloperMode
                };
                localStorage.setItem('multasUser', JSON.stringify(currentUser));
                
                // „É≠„Ç∞„Ç§„É≥„É¢„Éº„ÉÄ„É´„ÇíÈñâ„Åò„Çã
                document.getElementById('loginModal').style.display = 'none';
                
                // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„ÇíË°®Á§∫
                showUserInfo();
                
                // ÈñãÁô∫ËÄÖ„É¢„Éº„ÉâUIÊõ¥Êñ∞
                updateDeveloperUI();
                
                // ÂàùÊúüÂåñÂá¶ÁêÜ„ÇíÁ∂öË°å
                initializeApp();
            } else {
                document.getElementById('loginError').textContent = 'ID„Å®„Éë„Çπ„ÉØ„Éº„Éâ„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ';
            }
        }
        
        // === ÈñãÁô∫ËÄÖ„É¢„Éº„ÉâUIÊõ¥Êñ∞ ===
        function updateDeveloperUI() {
            const devElements = document.querySelectorAll('.dev-only');
            devElements.forEach(el => {
                // „Éú„Çø„É≥„Å®„Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„Ç™„Éó„Ç∑„Éß„É≥„ÅßË°®Á§∫ÊñπÊ≥ï„ÇíÂ§â„Åà„Çã
                if (el.classList.contains('btn-secondary')) {
                    el.style.display = isDeveloperMode ? 'block' : 'none';
                } else if (el.classList.contains('day-option')) {
                    el.style.display = isDeveloperMode ? 'block' : 'none';
                } else {
                    el.style.display = isDeveloperMode ? 'block' : 'none';
                }
            });
            
            // ÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„ÅÆÂ†¥Âêà„ÄÅ„Ç≥„É≥„ÇΩ„Éº„É´„Å´„É°„ÉÉ„Çª„Éº„Ç∏Ë°®Á§∫
            if (isDeveloperMode) {
                console.log('üîß ÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„ÅåÊúâÂäπ„Åß„Åô');
                console.log('Âà©Áî®ÂèØËÉΩ„Å™„Ç∑„Éß„Éº„Éà„Ç´„ÉÉ„Éà:');
                console.log('- Ctrl+Shift+S: „Çµ„É≥„Éó„É´10ÊäïÁ®ø„ÇíËøΩÂä†');
                console.log('- Ctrl+Shift+L: Èï∑Êñá„Çµ„É≥„Éó„É´ÊäïÁ®ø„ÇíËøΩÂä†');
                console.log('- Ctrl+Shift+X: „É≠„Ç∞„Ç¢„Ç¶„Éà');
                console.log('Âà©Áî®ÂèØËÉΩ„Å™Ê©üËÉΩ:');
                console.log('- Á∑¥ÁøíÁî®Êó•‰ªòÈÅ∏Êäû');
                console.log('- „Çµ„É≥„Éó„É´ÊäïÁ®ø„Éú„Çø„É≥');
            }
        }
        
        // === „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±Ë°®Á§∫ ===
        function showUserInfo() {
            if (currentUser) {
                const userInfo = document.getElementById('userInfo');
                const devBadge = isDeveloperMode ? ' <span style="color: #ff6b6b;">[DEV]</span>' : '';
                userInfo.innerHTML = `
                    <span style="margin-right: 10px;">${currentUser.id}${devBadge}</span>
                    <button onclick="confirmLogout()" style="background: #666; color: white; border: none; padding: 4px 10px; border-radius: 4px; font-size: 12px; cursor: pointer; transition: all 0.3s;" onmouseover="this.style.background='#555'" onmouseout="this.style.background='#666'">
                        „É≠„Ç∞„Ç¢„Ç¶„Éà
                    </button>
                `;
                userInfo.style.display = 'block';
            }
        }
        
        // === „É≠„Ç∞„Ç¢„Ç¶„ÉàÁ¢∫Ë™ç ===
        function confirmLogout() {
            const message = `„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü\n\n„ÄêÁèæÂú®„ÅÆÁä∂ÊÖã„Äë\n„É¶„Éº„Ç∂„Éº: ${currentUser.id}\n„É¨„Éô„É´: ${userLevel}\nÁ∑èË®òÈå≤Êï∞: ${records.length}\n\n„É≠„Ç∞„Ç¢„Ç¶„Éà„Åô„Çã„Å®ÂÜçÂ∫¶„É≠„Ç∞„Ç§„É≥„ÅåÂøÖË¶Å„Å´„Å™„Çä„Åæ„Åô„ÄÇ\nË®òÈå≤„Éá„Éº„Çø„ÅØ‰øùÂ≠ò„Åï„Çå„Åæ„Åô„ÄÇ`;
            
            if (confirm(message)) {
                // „Éá„Éº„Çø„Çí‰øùÂ≠ò
                saveGameData();
                // ÊàêÂäü„É°„ÉÉ„Çª„Éº„Ç∏
                showStatus('„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åó„Åü', 'info');
                // „É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„ÇíÂâäÈô§
                localStorage.removeItem('multasUser');
                // Â∞ë„ÅóÂæÖ„Å£„Å¶„Åã„Çâ„É™„É≠„Éº„Éâ
                setTimeout(() => {
                    location.reload();
                }, 500);
            }
        }
        
        // === API„Ç≠„Éº„É™„Çª„ÉÉ„Éà ===
        function resetApiKey() {
            const newKey = prompt('Êñ∞„Åó„ÅÑOpenAI API„Ç≠„Éº„ÇíÂÖ•Âäõ„Åó„Å¶„Åè„Å†„Åï„ÅÑ:', OPENAI_API_KEY);
            if (newKey !== null) {
                OPENAI_API_KEY = newKey;
                localStorage.setItem('multasApiKey', newKey);
                showStatus('API„Ç≠„Éº„ÇíÊõ¥Êñ∞„Åó„Åæ„Åó„Åü', 'success');
            }
        }
        
        
        // === „Ç¢„Éó„É™„Ç±„Éº„Ç∑„Éß„É≥ÂàùÊúüÂåñ ===
        function initializeApp() {
            // DOMË¶ÅÁ¥†„ÅÆ„Ç≠„É£„ÉÉ„Ç∑„É•„ÇíÂàùÊúüÂåñ
            initDOMCache();
            
            // ÂàùÊúüË°®Á§∫Ë®≠ÂÆö
            document.getElementById('stats-monitor1').style.display = 'block';
            
            // ÂàùÊúüÁµåÈ®ìÂÄ§Ë°®Á§∫
            updateExpDisplay();
            updateAllViews();
            
            // Enter „Ç≠„Éº„Åß„ÅÆÈÄÅ‰ø°
            document.getElementById('experienceText').addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'Enter') {
                    submitExperience();
                }
            });

            // „ÉÜ„Ç≠„Çπ„Éà„Ç®„É™„Ç¢„ÅÆÂãïÁöÑ„É™„Çµ„Ç§„Ç∫
            const textarea = document.getElementById('experienceText');
            textarea.addEventListener('input', function() {
                this.style.height = 'auto';
                this.style.height = Math.min(this.scrollHeight, 120) + 'px';
            });

            // „Éâ„É≠„ÉÉ„Éó„ÉÄ„Ç¶„É≥„ÅÆÂ§ñÂÅ¥„ÇØ„É™„ÉÉ„ÇØ„ÅßÈñâ„Åò„Çã
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.day-display')) {
                    document.getElementById('dayDropdown').classList.remove('active');
                }
                
                // ÁêÜÁî±Âêπ„ÅçÂá∫„Åó„ÅÆÂ§ñÂÅ¥„Çí„ÇØ„É™„ÉÉ„ÇØ„Åó„Åü„ÇâÈñâ„Åò„Çã
                if (!e.target.closest('.element-reason') && !e.target.classList.contains('reason-icon')) {
                    document.querySelectorAll('.element-reason').forEach(el => {
                        el.style.display = 'none';
                    });
                }
            });
        }
        
        // === ÂàùÊúüÂåñ ===
        document.addEventListener('DOMContentLoaded', function() {
            console.log('MULTAs „Ç∑„Çπ„ÉÜ„É†ÂàùÊúüÂåñ');
            
            // „Éá„Éê„ÉÉ„Ç∞Áî®ÔºöÂêÑÁ®Æ„É™„Çª„ÉÉ„Éà„Ç≥„Éû„É≥„Éâ
            document.addEventListener('keydown', function(e) {
                // Shift+Ctrl+R: ÂÆåÂÖ®„É™„Çª„ÉÉ„Éà
                if (e.shiftKey && e.ctrlKey && e.key === 'R') {
                    if (confirm('„Ç≤„Éº„É†„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åô„ÅãÔºüÔºà„É¨„Éô„É´„ÄÅÁµåÈ®ìÂÄ§„ÄÅ„É¨„Éù„Éº„ÉàË®òÈå≤Ôºâ')) {
                        localStorage.removeItem('multasGameData');
                        userLevel = 1;
                        userExp = 0;
                        totalPosts = 0;
                        generatedReports = {};
                        updateExpDisplay();
                        showStatus('üîÑ „Ç≤„Éº„É†„Éá„Éº„Çø„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„Åü', 'success');
                    }
                }
                
                // Ctrl+Shift+0: „É¨„Éô„É´„Å®„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà„Çí„É™„Çª„ÉÉ„ÉàÔºà„Éá„Éê„ÉÉ„Ç∞Áî®Ôºâ
                if (e.ctrlKey && e.shiftKey && e.key === '0') {
                    userLevel = 1;
                    userExp = 0;
                    // ÂÖ®Êó•‰ªò„ÅÆ„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà„Çí„É™„Çª„ÉÉ„Éà
                    const dayKeys = ['practice', '1', '2', '3', '4', '5'];
                    dayKeys.forEach(day => {
                        categoryPointsByDay[day] = {};
                        for (let i = 0; i <= 12; i++) {
                            categoryPointsByDay[day][i] = 0;
                        }
                    });
                    saveGameData();
                    updateExpDisplay();
                    updateRadarChart();
                    showStatus('üîß „É¨„Éô„É´„Å®„Ç´„ÉÜ„Ç¥„É™„Éù„Ç§„É≥„Éà„Çí„É™„Çª„ÉÉ„Éà„Åó„Åæ„Åó„ÅüÔºà„Éá„Éê„ÉÉ„Ç∞Ôºâ', 'warning');
                }
                
                // Ctrl+Shift+Êï∞Â≠ó: ÁâπÂÆö„É¨„Éô„É´„Å´Ë®≠ÂÆöÔºà„Éá„Éê„ÉÉ„Ç∞Áî®Ôºâ
                if (e.ctrlKey && e.shiftKey && e.key >= '1' && e.key <= '9') {
                    const targetLevel = parseInt(e.key);
                    userLevel = targetLevel;
                    userExp = 0;
                    saveGameData();
                    updateExpDisplay();
                    showStatus(`üîß „É¨„Éô„É´„Çí${targetLevel}„Å´Ë®≠ÂÆö„Åó„Åæ„Åó„ÅüÔºà„Éá„Éê„ÉÉ„Ç∞Ôºâ`, 'warning');
                }
                
                // Ctrl+Shift+X: „É≠„Ç∞„Ç¢„Ç¶„ÉàÔºà„Éá„Éê„ÉÉ„Ç∞Áî®Ôºâ
                if (e.ctrlKey && e.shiftKey && e.key === 'X') {
                    if (confirm('„É≠„Ç∞„Ç¢„Ç¶„Éà„Åó„Åæ„Åô„ÅãÔºü')) {
                        localStorage.removeItem('multasUser');
                        location.reload();
                    }
                }
                
                // Ctrl+Shift+S: „Çµ„É≥„Éó„É´10ÊäïÁ®ø„ÇíËøΩÂä†ÔºàÈñãÁô∫Áî®Ôºâ
                if (e.ctrlKey && e.shiftKey && e.key === 'S' && isDeveloperMode) {
                    addSampleRecords();
                }
                
                // Ctrl+Shift+L: Èï∑Êñá„Çµ„É≥„Éó„É´ÊäïÁ®ø„ÇíËøΩÂä†ÔºàÈñãÁô∫Áî®Ôºâ
                if (e.ctrlKey && e.shiftKey && e.key === 'L' && isDeveloperMode) {
                    addLongSampleRecord();
                }
            });
            
            // ‰øùÂ≠ò„Åï„Çå„Åü„É¶„Éº„Ç∂„ÉºÊÉÖÂ†±„Çí„ÉÅ„Çß„ÉÉ„ÇØ
            const savedUser = localStorage.getItem('multasUser');
            if (savedUser) {
                currentUser = JSON.parse(savedUser);
                // ÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„Éï„É©„Ç∞„ÇíÂæ©ÂÖÉ
                isDeveloperMode = currentUser.isDeveloper || false;
                showUserInfo();
                updateDeveloperUI();
                initializeApp();
            } else {
                // ÂàùÂõû„É≠„Ç∞„Ç§„É≥„ÅÆÂ†¥Âêà„ÄÅ„É≠„Ç∞„Ç§„É≥„É¢„Éº„ÉÄ„É´„ÇíË°®Á§∫
                document.getElementById('loginModal').style.display = 'flex';
            }
            
            // „É¶„Éº„Ç∂„Éº„ÅÆ„ÅÑ„ÅÑ„Å≠ÊÉÖÂ†±„ÇíË™≠„ÅøËæº„Åø
            const savedLikes = localStorage.getItem('userLikes');
            if (savedLikes) {
                userLikes = JSON.parse(savedLikes);
            }
        });
        
        // === „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥Ê©üËÉΩ ===
        let sharedLearnings = [];
        let userLikes = {};
        
        function loadSharedLearnings() {
            // „Éá„É¢Áî®„ÅÆ„Çµ„É≥„Éó„É´„Éá„Éº„Çø
            const sampleLearnings = [
                {
                    id: 'learn_001',
                    text: 'Ë®™ÂïèË®∫ÁôÇ„ÅßÊÇ£ËÄÖ„Åï„Çì„ÅÆÁîüÊ¥ªÁí∞Â¢É„ÇíË¶ã„Çã„Åì„Å®„Åß„ÄÅÁóÖÈô¢„Åß„ÅØÊ∞ó„Å•„Åë„Å™„ÅÑÂïèÈ°å„Å´Ê∞ó„Å•„Åë„Åæ„Åó„Åü',
                    category: 2, // Âú∞ÂüüÂåªÁôÇ
                    categoryName: 'Âú∞ÂüüÂåªÁôÇ',
                    timestamp: new Date().getTime() - 1000 * 60 * 30,
                    likes: 12,
                    isTeacher: false,
                    anonymous: true
                },
                {
                    id: 'learn_002',
                    text: 'Â§öËÅ∑Á®Æ„Ç´„É≥„Éï„Ç°„É¨„É≥„Çπ„Åß„ÄÅ„Åù„Çå„Åû„Çå„ÅÆÂ∞ÇÈñÄËÅ∑„ÅÆË¶ñÁÇπ„ÅÆÈÅï„ÅÑ„ÇíÂÆüÊÑü„ÄÇ„ÉÅ„Éº„É†ÂåªÁôÇ„ÅÆÈáçË¶ÅÊÄß„ÇíÂ≠¶„Å≥„Åæ„Åó„Åü',
                    category: 7, // Â§öËÅ∑Á®ÆÈÄ£Êê∫
                    categoryName: 'Â§öËÅ∑Á®ÆÈÄ£Êê∫',
                    timestamp: new Date().getTime() - 1000 * 60 * 60,
                    likes: 18,
                    isTeacher: true,
                    teacherComment: '„Å®„Å¶„ÇÇËâØ„ÅÑÊ∞ó„Å•„Åç„Åß„Åô„Å≠ÔºÅ',
                    anonymous: true
                },
                {
                    id: 'learn_003',
                    text: 'Ë°ÄÂúßÊ∏¨ÂÆö„ÅÆÊâãÊäÄ„ÇíÁ∑¥Áøí„ÄÇÊÇ£ËÄÖ„Åï„Çì„Å∏„ÅÆÂ£∞„Åã„Åë„ÅÆÂ§ßÂàá„Åï„ÇÇÂêåÊôÇ„Å´Â≠¶„Åπ„Åæ„Åó„Åü',
                    category: 4, // Ë®∫ÂØü„ÉªÊâãÊäÄ
                    categoryName: 'Ë®∫ÂØü„ÉªÊâãÊäÄ',
                    timestamp: new Date().getTime() - 1000 * 60 * 120,
                    likes: 8,
                    isTeacher: false,
                    anonymous: true
                }
            ];
            
            // LocalStorage„Åã„ÇâË™≠„ÅøËæº„ÅøÔºàÂÆüË£ÖÊôÇÔºâ
            const savedLearnings = localStorage.getItem('sharedLearnings');
            if (savedLearnings) {
                sharedLearnings = JSON.parse(savedLearnings);
            } else {
                sharedLearnings = sampleLearnings;
            }
            
            displaySharedLearnings();
        }
        
        function displaySharedLearnings() {
            const container = document.getElementById('sharedLearningContent');
            
            if (sharedLearnings.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <div class="icon">ü§ù</div>
                        <p>‰ªñ„ÅÆÂÆüÁøíÁîü„ÅÆÂ≠¶„Å≥„Åå„Åì„Åì„Å´Ë°®Á§∫„Åï„Çå„Åæ„Åô<br>„ÅÇ„Å™„Åü„ÅÆË®òÈå≤„ÇÇÂåøÂêç„ÅßÂÖ±Êúâ„Åß„Åç„Åæ„Åô</p>
                    </div>
                `;
                return;
            }
            
            let html = '<div class="shared-learnings-list">';
            
            sharedLearnings.forEach(learning => {
                const timeAgo = getTimeAgo(learning.timestamp);
                const liked = userLikes[learning.id] || false;
                const isMyPost = learning.userId === (currentUser ? currentUser.id : 'anonymous');
                
                html += `
                    <div class="shared-learning-item" style="background: ${isMyPost ? '#f3e5ff' : 'white'}; padding: 15px; margin: 10px 0; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); ${isMyPost ? 'border: 2px solid #e1bee7;' : ''}">
                        <div style="display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap;">
                            <div style="flex: 1; min-width: 0;">
                                <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; margin-bottom: 5px;">
                                    <div style="color: #666; font-size: 0.8rem;">
                                        <span style="background: #e3f2fd; color: #1976d2; padding: 2px 8px; border-radius: 12px; font-size: 0.7rem;">${learning.categoryName}</span>
                                        <span style="margin-left: 10px;">${timeAgo}</span>
                                        ${isMyPost ? '<span style="margin-left: 10px; color: #9c27b0; font-weight: bold;">‚ú® „ÅÇ„Å™„Åü„ÅÆÊäïÁ®ø</span>' : ''}
                                    </div>
                                    <!-- „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Éú„Çø„É≥ -->
                                    <div style="display: flex; gap: 5px; align-items: center; margin-left: auto;">
                                        ${isDeveloperMode ? `
                                        <button onclick="toggleLike('${learning.id}')" style="background: ${liked ? 'rgba(255, 64, 129, 0.3)' : 'rgba(245, 245, 245, 0.5)'}; color: ${liked ? 'rgba(255, 255, 255, 0.7)' : 'rgba(102, 102, 102, 0.5)'}; border: 1px dashed rgba(200, 200, 200, 0.5); padding: 4px 10px; border-radius: 15px; cursor: pointer; transition: all 0.3s; font-size: 13px; white-space: nowrap; opacity: 0.6;" title="ÈñãÁô∫„É¢„Éº„Éâ: „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„ÅÆ„Åø">
                                            ‚ù§Ô∏è „ÅÑ„ÅÑ„Å≠ ${learning.likes > 0 ? `(${learning.likes})` : ''}
                                        </button>
                                        <button onclick="addReaction('${learning.id}', 'üôã')" style="background: ${learning.reactions && learning.reactions[currentUser?.id || 'anonymous']?.includes('üôã') ? 'rgba(76, 175, 80, 0.3)' : 'rgba(240, 240, 240, 0.5)'}; color: ${learning.reactions && learning.reactions[currentUser?.id || 'anonymous']?.includes('üôã') ? 'rgba(255, 255, 255, 0.7)' : 'rgba(51, 51, 51, 0.5)'}; border: 1px dashed rgba(200, 200, 200, 0.5); padding: 4px 10px; border-radius: 15px; cursor: pointer; font-size: 13px; white-space: nowrap; opacity: 0.6;" title="ÈñãÁô∫„É¢„Éº„Éâ: „É≠„Éº„Ç´„É´„Çπ„Éà„É¨„Éº„Ç∏„ÅÆ„Åø">
                                            üôã ÁßÅ„ÇÇÁµåÈ®ì„Åó„Åü! ${learning.reactions ? `(${Object.keys(learning.reactions).length})` : ''}
                                        </button>
                                        ` : ''}
                                    </div>
                                </div>
                                <div style="font-size: 0.95rem; line-height: 1.5; margin: 10px 0;">
                                    ${learning.text}
                                </div>
                                ${learning.isTeacher && learning.teacherComment ? `
                                    <div style="background: #fff3e0; padding: 8px 12px; border-radius: 8px; margin-top: 10px;">
                                        <span style="color: #ff6f00; font-weight: bold;">üë®‚Äçüè´ ÊåáÂ∞éÂåª„Çà„ÇäÔºö</span>
                                        <span style="color: #666;">${learning.teacherComment}</span>
                                    </div>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            
            // Ëá™ÂàÜ„ÅÆË®òÈå≤„ÇíÂÖ±Êúâ„Åô„Çã„Éú„Çø„É≥
            // ÈñãÁô∫ËÄÖ„É¢„Éº„Éâ„ÅÆÂ†¥Âêà„ÅÆ„ÅøÂÖ±Êúâ„Éú„Çø„É≥„ÇíË°®Á§∫
            if (isDeveloperMode) {
                html += `
                    <div style="text-align: center; margin-top: 30px;">
                        <button onclick="shareMyLearning()" class="btn-secondary" style="background: rgba(126, 87, 194, 0.3); border: 2px dashed rgba(126, 87, 194, 0.5); color: rgba(255, 255, 255, 0.8); opacity: 0.7;" title="ÈñãÁô∫„É¢„Éº„Éâ: „É≠„Éº„Ç´„É´ÂÖ±Êúâ„ÅÆ„Åø">
                            üì§ Ëá™ÂàÜ„ÅÆÂ≠¶„Å≥„ÇíÂÖ±Êúâ„Åô„Çã
                        </button>
                    </div>
                `;
            }
            
            container.innerHTML = html;
            updateSharedStats();
        }
        
        function toggleLike(learningId) {
            const learning = sharedLearnings.find(l => l.id === learningId);
            if (!learning) return;
            
            if (userLikes[learningId]) {
                // „ÅÑ„ÅÑ„Å≠„ÇíÂèñ„ÇäÊ∂à„Åó
                userLikes[learningId] = false;
                learning.likes--;
            } else {
                // „ÅÑ„ÅÑ„Å≠„ÇíËøΩÂä†
                userLikes[learningId] = true;
                learning.likes++;
                showStatus('üëç „ÅÑ„ÅÑ„Å≠„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
            }
            
            // ‰øùÂ≠ò„Å®ÂÜçË°®Á§∫
            localStorage.setItem('sharedLearnings', JSON.stringify(sharedLearnings));
            localStorage.setItem('userLikes', JSON.stringify(userLikes));
            displaySharedLearnings();
        }
        
        function shareMyLearning() {
            if (records.length === 0) {
                showStatus('ÂÖ±Êúâ„Åô„ÇãË®òÈå≤„Åå„ÅÇ„Çä„Åæ„Åõ„Çì', 'info');
                return;
            }
            
            // ÊúÄÊñ∞„ÅÆË®òÈå≤„Åã„ÇâÈÅ∏ÊäûÔºàÂÆüË£ÖÁ∞°Áï•Âåñ„ÅÆ„Åü„ÇÅÊúÄÊñ∞„ÅÆ„ÇÇ„ÅÆ„ÇíËá™ÂãïÈÅ∏ÊäûÔºâ
            const latestRecord = records[records.length - 1];
            
            if (confirm(`‰ª•‰∏ã„ÅÆË®òÈå≤„ÇíÂåøÂêç„ÅßÂÖ±Êúâ„Åó„Åæ„Åô„ÅãÔºü\n\n„Äå${latestRecord.text}„Äç\n\n„Ç´„ÉÜ„Ç¥„É™: ${AI_CATEGORIES[latestRecord.category].name}`)) {
                const newLearning = {
                    id: 'learn_' + Date.now(),
                    text: latestRecord.text,
                    category: latestRecord.category,
                    categoryName: AI_CATEGORIES[latestRecord.category].name,
                    timestamp: new Date().getTime(),
                    likes: 0,
                    isTeacher: false,
                    anonymous: true,
                    userId: currentUser ? currentUser.id : 'anonymous'
                };
                
                sharedLearnings.unshift(newLearning);
                localStorage.setItem('sharedLearnings', JSON.stringify(sharedLearnings));
                
                showStatus('üì§ Â≠¶„Å≥„ÇíÂÖ±Êúâ„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
                displaySharedLearnings();
            }
        }
        
        // === LIST„Åã„ÇâÁõ¥Êé•ÂÖ±Êúâ„Åô„ÇãÊ©üËÉΩ ===
        function quickShareLearning(categoryId, elementContent, elementReason) {
            const category = AI_CATEGORIES[categoryId];
            
            // Êó¢„Å´ÂÖ±ÊúâÊ∏à„Åø„Åã„ÉÅ„Çß„ÉÉ„ÇØ
            const alreadyShared = sharedLearnings.some(learning => 
                learning.text === elementContent && 
                learning.userId === (currentUser ? currentUser.id : 'anonymous')
            );
            
            if (alreadyShared) {
                showStatus('‚úÖ „Åì„ÅÆÂ≠¶„Å≥„ÅØÊó¢„Å´ÂÖ±ÊúâÊ∏à„Åø„Åß„Åô', 'info');
                return;
            }
            
            // Á¢∫Ë™ç„ÉÄ„Ç§„Ç¢„É≠„Ç∞Ôºà„Ç∑„É≥„Éó„É´„Å´Ôºâ
            if (confirm(`„Åì„ÅÆÂ≠¶„Å≥„ÇíÂÖ±Êúâ„Åó„Åæ„Åô„ÅãÔºü\n\n„Äå${elementContent}„Äç`)) {
                const newLearning = {
                    id: 'learn_' + Date.now(),
                    text: elementContent,
                    category: categoryId,
                    categoryName: category.name,
                    timestamp: new Date().getTime(),
                    likes: 0,
                    isTeacher: false,
                    anonymous: true,
                    userId: currentUser ? currentUser.id : 'anonymous',
                    aiReason: elementReason
                };
                
                sharedLearnings.unshift(newLearning);
                localStorage.setItem('sharedLearnings', JSON.stringify(sharedLearnings));
                
                showStatus('üì§ Â≠¶„Å≥„ÇíÂÖ±Êúâ„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
                
                // „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ÁîªÈù¢„ÅåÈñã„ÅÑ„Å¶„ÅÑ„ÇãÂ†¥Âêà„ÅØÊõ¥Êñ∞
                if (currentMonitor === 'monitor4') {
                    displaySharedLearnings();
                }
                
                // LISTÁîªÈù¢„ÇÇÊõ¥Êñ∞„Åó„Å¶ÂÖ±ÊúâÊ∏à„Åø„Éû„Éº„ÇØ„ÇíË°®Á§∫
                if (currentMonitor === 'monitor2') {
                    displayOrganizedView();
                }
            }
        }
        
        function getTimeAgo(timestamp) {
            const diff = Date.now() - timestamp;
            const minutes = Math.floor(diff / 60000);
            const hours = Math.floor(diff / 3600000);
            const days = Math.floor(diff / 86400000);
            
            if (days > 0) return `${days}Êó•Ââç`;
            if (hours > 0) return `${hours}ÊôÇÈñìÂâç`;
            if (minutes > 0) return `${minutes}ÂàÜÂâç`;
            return '„Åü„Å£„Åü‰ªä';
        }
        
        function updateSharedStats() {
            // ÂÖ±ÊúâÊï∞„Å®„ÅÑ„ÅÑ„Å≠Êï∞„ÇíÊõ¥Êñ∞
            const sharedCountEl = document.getElementById('sharedCount');
            const likeCountEl = document.getElementById('likeCount');
            
            if (sharedCountEl) {
                sharedCountEl.textContent = sharedLearnings.length;
            }
            
            if (likeCountEl) {
                const totalLikes = Object.values(userLikes).filter(liked => liked).length;
                likeCountEl.textContent = totalLikes;
            }
        }
        
        // === „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥„É¢„Éº„ÉÄ„É´Âàá„ÇäÊõø„Åà ===
        function toggleSharedLearning() {
            if (currentMonitor === 'monitor4') {
                // ÁèæÂú®„Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ÁîªÈù¢„Å™„Çâ„ÄÅÂâç„ÅÆÁîªÈù¢„Å´Êàª„Çã
                switchMonitor('monitor2');
            } else {
                // „Åø„Çì„Å™„ÅÆÂ≠¶„Å≥ÁîªÈù¢„ÇíÈñã„Åè
                switchMonitor('monitor4');
                // „Çø„Éñ„Éú„Çø„É≥„ÇÇÊõ¥Êñ∞
                document.querySelectorAll('.monitor-tab').forEach(tab => {
                    tab.classList.remove('active');
                });
            }
        }
        
        // === LIST„Å´Êàª„Çã ===
        function backToList() {
            switchMonitor('monitor2');
            // LIST„Çø„Éñ„Çí„Ç¢„ÇØ„ÉÜ„Ç£„Éñ„Å´
            document.querySelectorAll('.monitor-tab').forEach((tab, index) => {
                tab.classList.remove('active');
                if (index === 1) tab.classList.add('active'); // LIST„ÅØ2Áï™ÁõÆ„ÅÆ„Çø„Éñ
            });
        }
        
        // === „É™„Ç¢„ÇØ„Ç∑„Éß„É≥ËøΩÂä† ===
        function addReaction(learningId, reaction) {
            const learning = sharedLearnings.find(l => l.id === learningId);
            if (!learning) return;
            
            // „É™„Ç¢„ÇØ„Ç∑„Éß„É≥„ÇíÂàùÊúüÂåñ
            if (!learning.reactions) {
                learning.reactions = {};
            }
            
            // „É¶„Éº„Ç∂„Éº„ÅÆ„É™„Ç¢„ÇØ„Ç∑„Éß„É≥„ÇíË®òÈå≤
            const userId = currentUser ? currentUser.id : 'anonymous';
            if (!learning.reactions[userId]) {
                learning.reactions[userId] = [];
            }
            
            // Âêå„Åò„É™„Ç¢„ÇØ„Ç∑„Éß„É≥„Åå„ÅÇ„Çå„Å∞ÂâäÈô§„ÄÅ„Å™„Åë„Çå„Å∞ËøΩÂä†
            const reactionIndex = learning.reactions[userId].indexOf(reaction);
            if (reactionIndex > -1) {
                learning.reactions[userId].splice(reactionIndex, 1);
                showStatus('„É™„Ç¢„ÇØ„Ç∑„Éß„É≥„ÇíÂèñ„ÇäÊ∂à„Åó„Åæ„Åó„Åü', 'info');
            } else {
                learning.reactions[userId].push(reaction);
                showStatus('üôã ÁßÅ„ÇÇÁµåÈ®ì„Åó„Åæ„Åó„ÅüÔºÅ', 'success');
            }
            
            // Á©∫„ÅÆÈÖçÂàó„ÅØÂâäÈô§
            if (learning.reactions[userId].length === 0) {
                delete learning.reactions[userId];
            }
            
            // ‰øùÂ≠ò„Å®ÂÜçË°®Á§∫
            localStorage.setItem('sharedLearnings', JSON.stringify(sharedLearnings));
            displaySharedLearnings();
        }
        
        // === PDFÂá∫ÂäõÊ©üËÉΩ ===
        async function downloadSummaryReportPDF() {
            showStatus('üìÑ PDFÁîüÊàê‰∏≠...', 'info');
            showLoadingIndicator('PDF„ÇíÁîüÊàê„Åó„Å¶„ÅÑ„Åæ„Åô...');
            
            try {
                // jsPDF„Ç§„É≥„Çπ„Çø„É≥„Çπ„Çí‰ΩúÊàêÔºàA4„Çµ„Ç§„Ç∫Ôºâ
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                // Êó•Êú¨Ë™û„Éï„Ç©„É≥„Éà„ÅÆË®≠ÂÆöÔºà„Éñ„É©„Ç¶„Ç∂Ê®ôÊ∫ñ„Éï„Ç©„É≥„Éà„Çí‰ΩøÁî®Ôºâ
                pdf.setFont('helvetica');
                
                // „Éö„Éº„Ç∏Ë®≠ÂÆö
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 20;
                let yPosition = margin;
                
                // === Ë°®Á¥ô„Éö„Éº„Ç∏ ===
                pdf.setFontSize(24);
                pdf.text('MULTAs ÂÆüÁøí„É¨„Éù„Éº„Éà', pageWidth / 2, yPosition, { align: 'center' });
                
                yPosition += 15;
                pdf.setFontSize(16);
                pdf.text('Medical University Learning and Training Assessment system', pageWidth / 2, yPosition, { align: 'center' });
                
                yPosition += 30;
                pdf.setFontSize(14);
                pdf.text(`Â≠¶ÁîüID: ${currentUser.id}`, margin, yPosition);
                yPosition += 10;
                pdf.text(`„É¨„Éô„É´: ${userLevel}`, margin, yPosition);
                yPosition += 10;
                pdf.text(`Á∑èË®òÈå≤Êï∞: ${records.length}‰ª∂`, margin, yPosition);
                yPosition += 10;
                pdf.text(`‰ΩúÊàêÊó•: ${new Date().toLocaleDateString('ja-JP')}`, margin, yPosition);
                
                // === Á∑èÂêàÁµ±Ë®à„Éö„Éº„Ç∏ ===
                pdf.addPage();
                yPosition = margin;
                pdf.setFontSize(18);
                pdf.text('Á∑èÂêàÁµ±Ë®à', margin, yPosition);
                yPosition += 15;
                
                // „Ç´„ÉÜ„Ç¥„É™Âà•ÈõÜË®à
                const categoryStats = {};
                records.forEach(record => {
                    const cat = record.category || 0;
                    categoryStats[cat] = (categoryStats[cat] || 0) + 1;
                });
                
                pdf.setFontSize(12);
                Object.entries(categoryStats).forEach(([catId, count]) => {
                    const category = AI_CATEGORIES[catId];
                    if (category && count > 0) {
                        pdf.text(`${category.name}: ${count}‰ª∂`, margin, yPosition);
                        yPosition += 8;
                        if (yPosition > pageHeight - margin) {
                            pdf.addPage();
                            yPosition = margin;
                        }
                    }
                });
                
                // === „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„Éà ===
                const radarCanvas = document.getElementById('summaryRadarChart');
                if (radarCanvas) {
                    try {
                        const imgData = await html2canvas(radarCanvas).then(canvas => canvas.toDataURL('image/png'));
                        pdf.addPage();
                        pdf.setFontSize(18);
                        pdf.text('Â≠¶Áøí„Éê„É©„É≥„ÇπÔºà„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàÔºâ', pageWidth / 2, margin, { align: 'center' });
                        pdf.addImage(imgData, 'PNG', (pageWidth - 120) / 2, margin + 10, 120, 120);
                    } catch (error) {
                        console.error('„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàÁîªÂÉèÂåñ„Ç®„É©„Éº:', error);
                    }
                }
                
                // === Êó•Âà•Ë©≥Á¥∞„É¨„Éù„Éº„Éà ===
                const days = ['1', '2', '3', '4', '5'];
                for (const day of days) {
                    const dayRecords = records.filter(r => String(r.day) === day);
                    if (dayRecords.length > 0) {
                        pdf.addPage();
                        yPosition = margin;
                        pdf.setFontSize(18);
                        pdf.text(`${day}Êó•ÁõÆ„ÅÆ„É¨„Éù„Éº„ÉàÔºà${dayRecords.length}‰ª∂Ôºâ`, margin, yPosition);
                        yPosition += 15;
                        
                        pdf.setFontSize(10);
                        dayRecords.forEach((record, index) => {
                            if (yPosition > pageHeight - margin * 2) {
                                pdf.addPage();
                                yPosition = margin;
                            }
                            
                            const category = AI_CATEGORIES[record.category] || AI_CATEGORIES[0];
                            const time = new Date(record.timestamp).toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                            
                            pdf.text(`${index + 1}. [${time}] ${category.name}`, margin, yPosition);
                            yPosition += 6;
                            
                            // „ÉÜ„Ç≠„Çπ„Éà„ÇíÊäò„ÇäËøî„Åó
                            const lines = pdf.splitTextToSize(record.originalText, pageWidth - margin * 2);
                            lines.forEach(line => {
                                if (yPosition > pageHeight - margin) {
                                    pdf.addPage();
                                    yPosition = margin;
                                }
                                pdf.text(line, margin + 5, yPosition);
                                yPosition += 5;
                            });
                            yPosition += 5;
                        });
                    }
                }
                
                // === ËÄÉÂØü„ÉªÊåØ„ÇäËøî„ÇäÊ¨Ñ ===
                pdf.addPage();
                yPosition = margin;
                pdf.setFontSize(18);
                pdf.text('ËÄÉÂØü„ÉªÊåØ„ÇäËøî„Çä', margin, yPosition);
                yPosition += 15;
                
                pdf.setFontSize(12);
                pdf.text('ÂÆüÁøí„ÇíÈÄö„Åó„Å¶„ÅÆÂ≠¶„Å≥Ôºö', margin, yPosition);
                yPosition += 40;
                
                pdf.text('‰ªäÂæå„ÅÆË™≤È°åÔºö', margin, yPosition);
                yPosition += 40;
                
                pdf.text('ÊåáÂ∞éÂåª„Å∏„ÅÆ„Ç≥„É°„É≥„ÉàÔºö', margin, yPosition);
                
                // === ÁΩ≤ÂêçÊ¨Ñ ===
                yPosition = pageHeight - margin * 3;
                pdf.line(margin, yPosition, margin + 60, yPosition);
                pdf.text('Â≠¶ÁîüÁΩ≤Âêç', margin, yPosition + 5);
                
                pdf.line(pageWidth - margin - 60, yPosition, pageWidth - margin, yPosition);
                pdf.text('Êó•‰ªò', pageWidth - margin - 60, yPosition + 5);
                
                // PDF„Çí‰øùÂ≠ò
                const fileName = `MULTAs_Report_${currentUser.id}_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                hideLoadingIndicator();
                showStatus('‚úÖ PDF„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü', 'success');
                
            } catch (error) {
                console.error('PDFÁîüÊàê„Ç®„É©„Éº:', error);
                hideLoadingIndicator();
                showStatus('‚ùå PDFÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü', 'error');
                
                // „Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØÔºö„Éñ„É©„Ç¶„Ç∂„ÅÆÂç∞Âà∑Ê©üËÉΩ„Çí‰ΩøÁî®
                fallbackPrintReport();
            }
        }
        
        // === Êó•Âà•„É¨„Éù„Éº„ÉàPDF„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ ===
        async function downloadDayReportPDF(day) {
            showStatus('üìÑ PDFÁîüÊàê‰∏≠...', 'info');
            showLoadingIndicator('PDF„ÇíÁîüÊàê„Åó„Å¶„ÅÑ„Åæ„Åô...');
            
            try {
                const { jsPDF } = window.jspdf;
                const pdf = new jsPDF('p', 'mm', 'a4');
                
                pdf.setFont('helvetica');
                
                const pageWidth = pdf.internal.pageSize.getWidth();
                const pageHeight = pdf.internal.pageSize.getHeight();
                const margin = 20;
                let yPosition = margin;
                
                // „Çø„Ç§„Éà„É´
                pdf.setFontSize(20);
                pdf.text(`MULTAs ${day === 'practice' ? 'Á∑¥ÁøíÁî®' : `${day}Êó•ÁõÆ`}ÂÆüÁøí„É¨„Éù„Éº„Éà`, pageWidth / 2, yPosition, { align: 'center' });
                
                yPosition += 20;
                pdf.setFontSize(12);
                pdf.text(`Â≠¶ÁîüID: ${currentUser.id}`, margin, yPosition);
                yPosition += 8;
                pdf.text(`‰ΩúÊàêÊó•: ${new Date().toLocaleDateString('ja-JP')}`, margin, yPosition);
                yPosition += 15;
                
                // Ë®òÈå≤Ë©≥Á¥∞
                const dayRecords = records.filter(r => String(r.day) === String(day));
                pdf.setFontSize(14);
                pdf.text(`Ë®òÈå≤Êï∞: ${dayRecords.length}‰ª∂`, margin, yPosition);
                yPosition += 15;
                
                // „Ç´„ÉÜ„Ç¥„É™Âà•Ë®òÈå≤
                pdf.setFontSize(10);
                dayRecords.forEach((record, index) => {
                    if (yPosition > pageHeight - margin * 2) {
                        pdf.addPage();
                        yPosition = margin;
                    }
                    
                    const category = AI_CATEGORIES[record.category] || AI_CATEGORIES[0];
                    const time = new Date(record.timestamp).toLocaleTimeString('ja-JP', { hour: '2-digit', minute: '2-digit' });
                    
                    pdf.text(`${index + 1}. [${time}] ${category.name}`, margin, yPosition);
                    yPosition += 6;
                    
                    const lines = pdf.splitTextToSize(record.originalText, pageWidth - margin * 2);
                    lines.forEach(line => {
                        if (yPosition > pageHeight - margin) {
                            pdf.addPage();
                            yPosition = margin;
                        }
                        pdf.text(line, margin + 5, yPosition);
                        yPosition += 5;
                    });
                    yPosition += 5;
                });
                
                // „É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàÔºàÂèØËÉΩ„Å™Â†¥ÂêàÔºâ
                const radarCanvas = document.getElementById('radarChart');
                if (radarCanvas && radarCanvas.style.display !== 'none') {
                    try {
                        pdf.addPage();
                        pdf.setFontSize(16);
                        pdf.text('Â≠¶Áøí„Éê„É©„É≥„Çπ', pageWidth / 2, margin, { align: 'center' });
                        
                        const imgData = await html2canvas(radarCanvas).then(canvas => canvas.toDataURL('image/png'));
                        pdf.addImage(imgData, 'PNG', (pageWidth - 100) / 2, margin + 10, 100, 100);
                    } catch (error) {
                        console.error('„É¨„Éº„ÉÄ„Éº„ÉÅ„É£„Éº„ÉàÁîªÂÉèÂåñ„Ç®„É©„Éº:', error);
                    }
                }
                
                // PDF„Çí‰øùÂ≠ò
                const fileName = `MULTAs_DayReport_${currentUser.id}_Day${day}_${new Date().toISOString().split('T')[0]}.pdf`;
                pdf.save(fileName);
                
                hideLoadingIndicator();
                showStatus('‚úÖ PDF„ÅÆ„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ„ÅåÂÆå‰∫Ü„Åó„Åæ„Åó„Åü', 'success');
                
            } catch (error) {
                console.error('PDFÁîüÊàê„Ç®„É©„Éº:', error);
                hideLoadingIndicator();
                showStatus('‚ùå PDFÁîüÊàê‰∏≠„Å´„Ç®„É©„Éº„ÅåÁô∫Áîü„Åó„Åæ„Åó„Åü', 'error');
            }
        }
        
        // === Âç∞Âà∑Áî®„Éï„Ç©„Éº„É´„Éê„ÉÉ„ÇØ ===
        function fallbackPrintReport() {
            const printWindow = window.open('', '_blank');
            
            // Á∑èÂêà„É¨„Éù„Éº„Éà„ÅÆÂÜÖÂÆπ„ÇíÂèñÂæó
            const reportContent = document.getElementById('report-summary');
            if (!reportContent) {
                showStatus('‚ùå „É¨„Éù„Éº„Éà„ÅåË¶ã„Å§„Åã„Çä„Åæ„Åõ„Çì', 'error');
                return;
            }
            
            // Âç∞Âà∑Áî®HTML„ÇíÊßãÁØâ
            const printHTML = `
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>Âú∞ÂüüÂåªÁôÇÂÆüÁøí Á∑èÂêà„É¨„Éù„Éº„Éà</title>
    <style>
        @media print {
            body {
                margin: 0;
                padding: 20mm;
                font-family: 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
                line-height: 1.8;
                color: #333;
            }
            
            .no-print {
                display: none !important;
            }
            
            .report-header {
                text-align: center;
                margin-bottom: 30px;
                padding-bottom: 20px;
                border-bottom: 2px solid #333;
            }
            
            .report-header h3 {
                font-size: 24px;
                margin: 0 0 15px 0;
            }
            
            .report-header p {
                margin: 5px 0;
                font-size: 14px;
            }
            
            .report-section {
                margin: 25px 0;
                page-break-inside: avoid;
            }
            
            .report-section h4 {
                font-size: 18px;
                margin: 15px 0 10px 0;
                padding-bottom: 5px;
                border-bottom: 1px solid #ddd;
            }
            
            .matrix-summary {
                margin: 20px 0;
            }
            
            .matrix-summary > div {
                margin: 15px 0;
                padding: 15px;
                border-left: 3px solid #666;
                background: #f8f9fa;
            }
            
            .matrix-summary h5 {
                font-size: 16px;
                margin: 0 0 10px 0;
            }
            
            .ai-feedback {
                background: #f0f8ff;
                padding: 15px;
                border-radius: 5px;
                margin: 15px 0;
            }
            
            ol {
                padding-left: 30px;
            }
            
            .summary-radar-container {
                display: none !important;
            }
            
            @page {
                size: A4;
                margin: 20mm;
            }
        }
        
        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'Yu Gothic', sans-serif;
            line-height: 1.8;
            color: #333;
            padding: 20px;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .report-section {
            margin: 20px 0;
        }
        
        .report-section h4 {
            font-size: 18px;
            margin: 15px 0 10px 0;
            color: #444;
        }
        
        button {
            display: none;
        }
        
        /* ÈñãÁô∫ËÄÖ„É¢„Éº„ÉâÁî®„Ç¥„Éº„Çπ„Éà„Éú„Çø„É≥„Çπ„Çø„Ç§„É´ */
        .ghost-reaction {
            position: relative;
            background-image: repeating-linear-gradient(
                45deg,
                transparent,
                transparent 5px,
                rgba(255, 255, 255, 0.1) 5px,
                rgba(255, 255, 255, 0.1) 10px
            );
        }
    </style>
</head>
<body>
    ${reportContent.innerHTML}
    <script>
        // ‰∏çË¶Å„Å™Ë¶ÅÁ¥†„ÇíÂâäÈô§
        document.querySelectorAll('button').forEach(el => el.remove());
        document.querySelector('.summary-radar-container')?.remove();
        
        // Âç∞Âà∑„ÉÄ„Ç§„Ç¢„É≠„Ç∞„ÇíËá™ÂãïÁöÑ„Å´Èñã„Åè
        setTimeout(() => {
            window.print();
            // Âç∞Âà∑ÂÆå‰∫ÜÂæå„Å´„Ç¶„Ç£„É≥„Éâ„Ç¶„ÇíÈñâ„Åò„Çã
            window.onafterprint = () => {
                window.close();
            };
        }, 500);
    &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
            `;
            
            printWindow.document.write(printHTML);
            printWindow.document.close();
            
            showStatus('üìÑ PDF„ÉÄ„Ç¶„É≥„É≠„Éº„ÉâÁîªÈù¢„ÇíÈñã„Åç„Åæ„Åó„Åü', 'success');
        }
    </script>
</body>
</html>