# MULTAs v3 Step by Step 実装計画

## 基本方針
- **機能優先**: UIの装飾は最小限、動作を重視
- **モバイルファースト**: スマホでの動作を前提
- **段階的実装**: 1つずつ確実に動作確認
- **将来性**: Vercel移行を考慮した設計

## Phase 0: 基盤構築（Day 1 - 2時間）

### 目標
最小限のHTML構造とデータ永続化の確認

### 実装内容
```
multas-v3/
├── index.html    # 最小限のHTML
├── app.js        # メインロジック
└── style.css     # 最小限のスタイル
```

### 成果物
1. LocalStorageへの読み書きテスト
2. 基本的なHTML構造
3. スマホでの表示確認

### 検証項目
- [ ] LocalStorageが使える
- [ ] スマホで表示される
- [ ] JavaScriptが動作する

---

## Phase 1: データモデル実装（Day 1 - 3時間）

### 目標
記録（Record）の保存と読み込みが確実に動作

### 実装内容
```javascript
// データ構造の定義
const DataStore = {
  records: [],
  save() { /* LocalStorage保存 */ },
  load() { /* LocalStorage読込 */ },
  add(text) { /* 記録追加 */ }
};
```

### 成果物
1. データの追加機能
2. データの永続化
3. ページリロード後の復元

### 検証項目
- [ ] テキストデータを追加できる
- [ ] リロード後もデータが残る
- [ ] 複数データを管理できる

---

## Phase 2: LOG画面の基本実装（Day 2 - 4時間）

### 目標
投稿の入力と表示が動作する最小限のLOG機能

### 実装内容
```html
<!-- 最小限の構造 -->
<div id="log-screen">
  <div id="records-list"></div>
  <input type="text" id="input">
  <button onclick="submit()">送信</button>
</div>
```

### 成果物
1. テキスト入力フォーム
2. 送信機能
3. 投稿履歴の表示

### 検証項目
- [ ] 入力→送信→表示のフロー
- [ ] 空入力の防止
- [ ] 時系列での表示（新→古）

---

## Phase 3: 画面切り替え機構（Day 2 - 2時間）

### 目標
3画面（LOG/LIST/REPORT）の切り替えが確実に動作

### 実装内容
```javascript
const ScreenManager = {
  current: 'log',
  show(screenName) {
    // 全画面を非表示
    // 指定画面のみ表示
  }
};
```

### 成果物
1. タブボタン
2. 画面切り替え機能
3. 現在画面の状態保持

### 検証項目
- [ ] タブクリックで画面切替
- [ ] 他画面の要素が混入しない
- [ ] リロード後も最後の画面を記憶

---

## Phase 4: AI分類の統合（Day 3 - 4時間）

### 目標
OpenAI APIによる12時計分類の実装

### 実装内容
```javascript
const AIService = {
  async classify(text) {
    // OpenAI API呼び出し
    // カテゴリ番号を返す
  }
};
```

### 成果物
1. API連携機能
2. 分類結果の保存
3. エラーハンドリング

### 検証項目
- [ ] APIキーの設定機能
- [ ] 分類が正しく動作
- [ ] オフライン時のフォールバック

---

## Phase 5: LIST画面実装（Day 4 - 3時間）

### 目標
AI分類された投稿をカテゴリ別に表示

### 実装内容
```javascript
const ListView = {
  render() {
    // カテゴリ別にグループ化
    // HTMLを生成
  }
};
```

### 成果物
1. カテゴリ別表示
2. AI分類理由の表示
3. カテゴリ色分け（最小限）

### 検証項目
- [ ] 全投稿が表示される
- [ ] カテゴリ別にグループ化
- [ ] 分類理由が見える

---

## Phase 6: データ集計機能（Day 5 - 2時間）

### 目標
カテゴリ別の投稿数集計

### 実装内容
```javascript
const Analytics = {
  getCategoryCounts() {
    // カテゴリ別投稿数
  },
  getChartData() {
    // Chart.js用データ
  }
};
```

### 成果物
1. カテゴリ別集計
2. 日付別集計
3. チャート用データ生成

### 検証項目
- [ ] 正確な集計
- [ ] 0件カテゴリも含む
- [ ] 日付フィルタ機能

---

## Phase 7: REPORT画面とチャート（Day 6 - 4時間）

### 目標
レーダーチャートの表示（装飾なし）

### 実装内容
```javascript
const ChartManager = {
  draw(data) {
    // Chart.jsでレーダーチャート
  }
};
```

### 成果物
1. レーダーチャート表示
2. カテゴリラベル
3. 基本的な色分け

### 検証項目
- [ ] チャートが表示される
- [ ] データが正しく反映
- [ ] スマホで見やすいサイズ

---

## Phase 8: レポート生成（Day 7 - 3時間）

### 目標
AIによるレポート生成機能

### 実装内容
```javascript
const ReportGenerator = {
  async generate(records) {
    // OpenAI APIでレポート生成
  }
};
```

### 成果物
1. デイリーレポート
2. 10投稿以上の条件
3. レポート表示エリア

### 検証項目
- [ ] レポートが生成される
- [ ] 内容が適切
- [ ] エラー処理

---

## Phase 9: 日付管理（Day 8 - 2時間）

### 目標
1-5日目と練習用の切り替え

### 実装内容
```javascript
const DayManager = {
  current: 1,
  change(day) {
    // 日付切り替え
    // データフィルタ
  }
};
```

### 成果物
1. 日付選択UI
2. データフィルタリング
3. 日付別の永続化

### 検証項目
- [ ] 日付切り替え動作
- [ ] データが正しくフィルタ
- [ ] 各日付でデータ保持

---

## Phase 10: 最適化と安定化（Day 9-10）

### 目標
実用レベルの安定性確保

### 実装内容
1. エラーハンドリング強化
2. パフォーマンス改善
3. 基本的なスタイリング

### 成果物
1. エラー時の復旧機能
2. ローディング表示
3. 最小限の見た目改善

### 検証項目
- [ ] 長時間使用で安定
- [ ] データ破損なし
- [ ] 基本的な使いやすさ

---

## 実装の優先順位

### 必須機能（Must Have）
1. データの永続化
2. LOG画面での投稿
3. 画面切り替え
4. AI分類

### 重要機能（Should Have）
5. LIST表示
6. レーダーチャート
7. 日付管理

### あれば良い機能（Nice to Have）
8. レポート生成
9. レベルシステム
10. アニメーション

---

## 技術スタック

### コア技術
- **HTML5**: セマンティック構造
- **Vanilla JavaScript**: ES6+
- **CSS3**: Flexbox/Grid（最小限）
- **LocalStorage**: データ永続化
- **OpenAI API**: AI機能

### ライブラリ（最小限）
- **Chart.js**: レーダーチャート
- 他は使わない（依存を減らす）

---

## 成功基準

### Phase 1-3完了時点
- [ ] 投稿ができる
- [ ] データが保存される
- [ ] 画面が切り替わる

### Phase 4-6完了時点
- [ ] AI分類が動作
- [ ] LIST表示が機能
- [ ] データ集計が正確

### Phase 7-10完了時点
- [ ] 全機能が動作
- [ ] スマホで快適
- [ ] データ消失なし

---

## リスクと対策

### リスク1: AI API の不安定性
**対策**: オフラインモード実装

### リスク2: LocalStorage容量
**対策**: 古いデータの自動削除

### リスク3: スマホでの入力
**対策**: 大きめの入力エリア

---

## 次のアクション

1. **新ディレクトリ作成**
   ```
   multas-v3/
   ```

2. **Phase 0 開始**
   - 最小限のindex.html
   - LocalStorageテスト

3. **動作確認**
   - スマホ実機でテスト
   - 問題なければPhase 1へ